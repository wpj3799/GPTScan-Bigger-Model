

  .oooooo.    ooooooooo.   ooooooooooooo  .oooooo..o                                 
 d8P'  `Y8b   `888   `Y88. 8'   888   `8 d8P'    `Y8                                 
888            888   .d88'      888      Y88bo.       .ooooo.   .oooo.   ooo. .oo.   
888            888ooo88P'       888       `"Y8888o.  d88' `"Y8 `P  )88b  `888P"Y88b  
888     ooooo  888              888           `"Y88b 888        .oP"888   888   888  
`88.    .88'   888              888      oo     .d8P 888   .o8 d8(  888   888   888  
 `Y8bood8P'   o888o            o888o     8""88888P'  `Y8bod8P' `Y888""8o o888o o888o                                                        


                                                                   

[19:29:25] Loaded 10 rules                                                                                                                                                                             tasks.py:119
[12/08/24 19:29:25] INFO     CryticCompile: 'npx hardhat clean' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main)                subprocess.py:41
[12/08/24 19:29:26] ERROR    CryticCompile: 'npx' returned non-zero exit code 1                                                                                                                    subprocess.py:60
                    ERROR    CryticCompile: An unexpected error occurred:                                                                                                                          subprocess.py:68
                             stderr: Error: Cannot find module '@nomicfoundation/hardhat-toolbox'                                                                                                                  
                             stderr: Require stack:                                                                                                                                                                
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js                                                     
                             stderr: -                                                                                                                                                                             
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js                     
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js                              
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js                        
                             stderr:     at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)                                                                                                   
                             stderr:     at Function._load (node:internal/modules/cjs/loader:1075:27)                                                                                                              
                             stderr:     at TracingChannel.traceSync (node:diagnostics_channel:322:14)                                                                                                             
                             stderr:     at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)                                                                                                               
                             stderr:     at Module.require (node:internal/modules/cjs/loader:1340:12)                                                                                                              
                             stderr:     at require (node:internal/modules/helpers:138:16)                                                                                                                         
                             stderr:     at Object.<anonymous> (/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js:1:1)                       
                             stderr:     at Module._compile (node:internal/modules/cjs/loader:1565:14)                                                                                                             
                             stderr:     at Object..js (node:internal/modules/cjs/loader:1708:10)                                                                                                                  
                             stderr:     at Module.load (node:internal/modules/cjs/loader:1318:32) {                                                                                                               
                             stderr:   code: 'MODULE_NOT_FOUND',                                                                                                                                                   
                             stderr:   requireStack: [                                                                                                                                                             
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js',                                                
                             stderr:                                                                                                                                                                               
                             '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js',                  
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js',                         
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js'                    
                             stderr:   ]                                                                                                                                                                           
                             stderr: }                                                                                                                                                                             
                    INFO     CryticCompile: 'npx hardhat clean --global' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main)       subprocess.py:41
[12/08/24 19:29:27] ERROR    CryticCompile: 'npx' returned non-zero exit code 1                                                                                                                    subprocess.py:60
                    ERROR    CryticCompile: An unexpected error occurred:                                                                                                                          subprocess.py:68
                             stderr: Error: Cannot find module '@nomicfoundation/hardhat-toolbox'                                                                                                                  
                             stderr: Require stack:                                                                                                                                                                
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js                                                     
                             stderr: -                                                                                                                                                                             
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js                     
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js                              
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js                        
                             stderr:     at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)                                                                                                   
                             stderr:     at Function._load (node:internal/modules/cjs/loader:1075:27)                                                                                                              
                             stderr:     at TracingChannel.traceSync (node:diagnostics_channel:322:14)                                                                                                             
                             stderr:     at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)                                                                                                               
                             stderr:     at Module.require (node:internal/modules/cjs/loader:1340:12)                                                                                                              
                             stderr:     at require (node:internal/modules/helpers:138:16)                                                                                                                         
                             stderr:     at Object.<anonymous> (/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js:1:1)                       
                             stderr:     at Module._compile (node:internal/modules/cjs/loader:1565:14)                                                                                                             
                             stderr:     at Object..js (node:internal/modules/cjs/loader:1708:10)                                                                                                                  
                             stderr:     at Module.load (node:internal/modules/cjs/loader:1318:32) {                                                                                                               
                             stderr:   code: 'MODULE_NOT_FOUND',                                                                                                                                                   
                             stderr:   requireStack: [                                                                                                                                                             
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js',                                                
                             stderr:                                                                                                                                                                               
                             '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js',                  
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js',                         
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js'                    
                             stderr:   ]                                                                                                                                                                           
                             stderr: }                                                                                                                                                                             
[12/08/24 19:29:28] INFO     CryticCompile: Problem executing hardhat: An unexpected error occurred:                                                                                                 hardhat.py:327
                             Error: Cannot find module '@nomicfoundation/hardhat-toolbox'                                                                                                                          
                             Require stack:                                                                                                                                                                        
                             - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js                                                             
                             - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js                   
                             - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js                                      
                             - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js                                
                                 at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)                                                                                                           
                                 at Function._load (node:internal/modules/cjs/loader:1075:27)                                                                                                                      
                                 at TracingChannel.traceSync (node:diagnostics_channel:322:14)                                                                                                                     
                                 at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)                                                                                                                       
                                 at Module.require (node:internal/modules/cjs/loader:1340:12)                                                                                                                      
                                 at require (node:internal/modules/helpers:138:16)                                                                                                                                 
                                 at Object.<anonymous> (/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js:1:1)                               
                                 at Module._compile (node:internal/modules/cjs/loader:1565:14)                                                                                                                     
                                 at Object..js (node:internal/modules/cjs/loader:1708:10)                                                                                                                          
                                 at Module.load (node:internal/modules/cjs/loader:1318:32) {                                                                                                                       
                               code: 'MODULE_NOT_FOUND',                                                                                                                                                           
                               requireStack: [                                                                                                                                                                     
                                 '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js',                                                        
                                 '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js'               
                             ,                                                                                                                                                                                     
                                 '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js',                                 
                                 '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js'                            
                               ]                                                                                                                                                                                   
                             }                                                                                                                                                                                     
                                                                                                                                                                                                                   
                    INFO     CryticCompile: 'npx hardhat compile --force' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main)      subprocess.py:41
                    ERROR    CryticCompile: 'npx' returned non-zero exit code 1                                                                                                                    subprocess.py:60
                    ERROR    CryticCompile: An unexpected error occurred:                                                                                                                          subprocess.py:68
                             stderr: Error: Cannot find module '@nomicfoundation/hardhat-toolbox'                                                                                                                  
                             stderr: Require stack:                                                                                                                                                                
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js                                                     
                             stderr: -                                                                                                                                                                             
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js                     
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js                              
                             stderr: - /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js                        
                             stderr:     at Function._resolveFilename (node:internal/modules/cjs/loader:1249:15)                                                                                                   
                             stderr:     at Function._load (node:internal/modules/cjs/loader:1075:27)                                                                                                              
                             stderr:     at TracingChannel.traceSync (node:diagnostics_channel:322:14)                                                                                                             
                             stderr:     at wrapModuleLoad (node:internal/modules/cjs/loader:219:24)                                                                                                               
                             stderr:     at Module.require (node:internal/modules/cjs/loader:1340:12)                                                                                                              
                             stderr:     at require (node:internal/modules/helpers:138:16)                                                                                                                         
                             stderr:     at Object.<anonymous> (/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js:1:1)                       
                             stderr:     at Module._compile (node:internal/modules/cjs/loader:1565:14)                                                                                                             
                             stderr:     at Object..js (node:internal/modules/cjs/loader:1708:10)                                                                                                                  
                             stderr:     at Module.load (node:internal/modules/cjs/loader:1318:32) {                                                                                                               
                             stderr:   code: 'MODULE_NOT_FOUND',                                                                                                                                                   
                             stderr:   requireStack: [                                                                                                                                                             
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/hardhat.config.js',                                                
                             stderr:                                                                                                                                                                               
                             '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/core/config/config-loading.js',                  
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/cli.js',                         
                             stderr:     '/home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/node_modules/hardhat/internal/cli/bootstrap.js'                    
                             stderr:   ]                                                                                                                                                                           
                             stderr: }                                                                                                                                                                             
[19:29:28] Traceback (most recent call last):                                                                                                                                                          tasks.py:126
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/falcon/falcon.py", line 90, in __init__                                                                     
               crytic_compile = CryticCompile(target, **kwargs)                                                                                                                                                    
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/crytic_compile/crytic_compile.py", line 131, in __init__                                                    
               self._compile(**kwargs)                                                                                                                                                                             
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/crytic_compile/crytic_compile.py", line 553, in _compile                                                    
               self._platform.compile(self, **kwargs)                                                                                                                                                              
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/crytic_compile/platform/hardhat.py", line 183, in compile                                                   
               hardhat_like_parsing(crytic_compile, self._target, build_directory, hardhat_working_dir)                                                                                                            
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/crytic_compile/platform/hardhat.py", line 52, in hardhat_like_parsing                                       
               raise InvalidCompilation(txt)                                                                                                                                                                       
           crytic_compile.platform.exceptions.InvalidCompilation: Compilation failed. Can you run build command?                                                                                                   
           /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/artifacts/build-info is not a directory.                                                          
                                                                                                                                                                                                                   
           During handling of the above exception, another exception occurred:                                                                                                                                     
                                                                                                                                                                                                                   
           Traceback (most recent call last):                                                                                                                                                                      
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 124, in simple_cli                                                                                                         
               falcon_instance = compile_project(source_dir)                                                                                                                                                       
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 103, in compile_project                                                                                                    
               return falcon.Falcon(abs_path)                                                                                                                                                                      
             File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/.venv/lib/python3.10/site-packages/falcon/falcon.py", line 94, in __init__                                                                     
               raise FalconError(f"Invalid compilation: \n{str(e)}")                                                                                                                                               
           falcon.exceptions.FalconError: Invalid compilation:                                                                                                                                                     
           Compilation failed. Can you run build command?                                                                                                                                                          
           /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/artifacts/build-info is not a directory.                                                          
                                                                                                                                                                                                                   
           Compile failed.                                                                                                                                                                             tasks.py:127
           Since the compilation is failed, some static analysis tool may not be enabled, which may cause lower precision and recall.                                                                  tasks.py:128
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateSwapReverse(                                                                                                                                                                              │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 reserveIn,                                                                                                                                                                                      │
│         uint256 reserveOut                                                                                                                                                                                      │
│     ) internal pure returns (uint256 amountIn) {                                                                                                                                                                │
│         // X * Y                                                                                                                                                                                                │
│         uint256 XY = reserveIn * reserveOut;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         // 2y                                                                                                                                                                                                   │
│         uint256 y2 = amountOut * 2;                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // 4y                                                                                                                                                                                                   │
│         uint256 y4 = y2 * 2;                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             y4 < reserveOut,                                                                                                                                                                                    │
│             "VaderMath::calculateSwapReverse: Desired Output Exceeds Maximum Output Possible (1/4 of Liquidity Pool)"                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // root(-X^2 * Y * (4y - Y))    =>    root(X^2 * Y * (Y - 4y)) as Y - 4y >= 0    =>    Y >= 4y holds true                                                                                               │
│         uint256 numeratorA = root(XY) * root(reserveIn * (reserveOut - y4));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         // X * (2y - Y)    =>    2yX - XY                                                                                                                                                                       │
│         uint256 numeratorB = y2 * reserveIn;                                                                                                                                                                    │
│         uint256 numeratorC = XY;                                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         // -1 * (root(-X^2 * Y * (4y - Y)) + (X * (2y - Y)))    =>    -1 * (root(X^2 * Y * (Y - 4y)) + 2yX - XY)    =>    XY - root(X^2 * Y * (Y - 4y) - 2yX                                                    │
│         uint256 numerator = numeratorC - numeratorA - numeratorB;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // 2y                                                                                                                                                                                                   │
│         uint256 denominator = y2;                                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         amountIn = numerator / denominator;                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateSwapReverse(                                                                                                                                                                              │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 reserveIn,                                                                                                                                                                                      │
│         uint256 reserveOut                                                                                                                                                                                      │
│     ) internal pure returns (uint256 amountIn) {                                                                                                                                                                │
│         // X * Y                                                                                                                                                                                                │
│         uint256 XY = reserveIn * reserveOut;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         // 2y                                                                                                                                                                                                   │
│         uint256 y2 = amountOut * 2;                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // 4y                                                                                                                                                                                                   │
│         uint256 y4 = y2 * 2;                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             y4 < reserveOut,                                                                                                                                                                                    │
│             "VaderMath::calculateSwapReverse: Desired Output Exceeds Maximum Output Possible (1/4 of Liquidity Pool)"                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // root(-X^2 * Y * (4y - Y))    =>    root(X^2 * Y * (Y - 4y)) as Y - 4y >= 0    =>    Y >= 4y holds true                                                                                               │
│         uint256 numeratorA = root(XY) * root(reserveIn * (reserveOut - y4));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         // X * (2y - Y)    =>    2yX - XY                                                                                                                                                                       │
│         uint256 numeratorB = y2 * reserveIn;                                                                                                                                                                    │
│         uint256 numeratorC = XY;                                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         // -1 * (root(-X^2 * Y * (4y - Y)) + (X * (2y - Y)))    =>    -1 * (root(X^2 * Y * (Y - 4y)) + 2yX - XY)    =>    XY - root(X^2 * Y * (Y - 4y) - 2yX                                                    │
│         uint256 numerator = numeratorC - numeratorA - numeratorB;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // 2y                                                                                                                                                                                                   │
│         uint256 denominator = y2;                                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         amountIn = numerator / denominator;                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         IVaderPool pool;                                                                                                                                                                                        │
│         (pool, amountA, amountB) = _addLiquidity(                                                                                                                                                               │
│             address(tokenA),                                                                                                                                                                                    │
│             address(tokenB),                                                                                                                                                                                    │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         tokenA.safeTransferFrom(msg.sender, address(pool), amountA);                                                                                                                                            │
│         tokenB.safeTransferFrom(msg.sender, address(pool), amountB);                                                                                                                                            │
│         liquidity = pool.mint(to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         IVaderPool pool;                                                                                                                                                                                        │
│         (pool, amountA, amountB) = _addLiquidity(                                                                                                                                                               │
│             address(tokenA),                                                                                                                                                                                    │
│             address(tokenB),                                                                                                                                                                                    │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         tokenA.safeTransferFrom(msg.sender, address(pool), amountA);                                                                                                                                            │
│         tokenB.safeTransferFrom(msg.sender, address(pool), amountB);                                                                                                                                            │
│         liquidity = pool.mint(to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired                                                                                                                                                                                  │
│     )                                                                                                                                                                                                           │
│         private                                                                                                                                                                                                 │
│         returns (                                                                                                                                                                                               │
│             IVaderPool pool,                                                                                                                                                                                    │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB                                                                                                                                                                                     │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         pool = factory.getPool(tokenA, tokenB);                                                                                                                                                                 │
│         if (pool == IVaderPool(_ZERO_ADDRESS)) {                                                                                                                                                                │
│             pool = factory.createPool(tokenA, tokenB);                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired                                                                                                                                                                                  │
│     )                                                                                                                                                                                                           │
│         private                                                                                                                                                                                                 │
│         returns (                                                                                                                                                                                               │
│             IVaderPool pool,                                                                                                                                                                                    │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB                                                                                                                                                                                     │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         pool = factory.getPool(tokenA, tokenB);                                                                                                                                                                 │
│         if (pool == IVaderPool(_ZERO_ADDRESS)) {                                                                                                                                                                │
│             pool = factory.createPool(tokenA, tokenB);                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired                                                                                                                                                                                  │
│     )                                                                                                                                                                                                           │
│         private                                                                                                                                                                                                 │
│         returns (                                                                                                                                                                                               │
│             IVaderPool pool,                                                                                                                                                                                    │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB                                                                                                                                                                                     │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         pool = factory.getPool(tokenA, tokenB);                                                                                                                                                                 │
│         if (pool == IVaderPool(_ZERO_ADDRESS)) {                                                                                                                                                                │
│             pool = factory.createPool(tokenA, tokenB);                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         IVaderPool pool;                                                                                                                                                                                        │
│         (pool, amountA, amountB) = _addLiquidity(                                                                                                                                                               │
│             address(tokenA),                                                                                                                                                                                    │
│             address(tokenB),                                                                                                                                                                                    │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         tokenA.safeTransferFrom(msg.sender, address(pool), amountA);                                                                                                                                            │
│         tokenB.safeTransferFrom(msg.sender, address(pool), amountB);                                                                                                                                            │
│         liquidity = pool.mint(to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired                                                                                                                                                                                  │
│     )                                                                                                                                                                                                           │
│         private                                                                                                                                                                                                 │
│         returns (                                                                                                                                                                                               │
│             IVaderPool pool,                                                                                                                                                                                    │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB                                                                                                                                                                                     │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         pool = factory.getPool(tokenA, tokenB);                                                                                                                                                                 │
│         if (pool == IVaderPool(_ZERO_ADDRESS)) {                                                                                                                                                                │
│             pool = factory.createPool(tokenA, tokenB);                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateInGivenOut(uint256 amountOut, address[] calldata path)                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountIn)                                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwapReverse(                                                                                                                                                                 │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateInGivenOut(uint256 amountOut, address[] calldata path)                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountIn)                                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwapReverse(                                                                                                                                                                 │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function swapTokensForExactTokens(                                                                                                                                                                          │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 amountInMax,                                                                                                                                                                                    │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual ensure(deadline) returns (uint256 amountIn) {                                                                                                                                            │
│         amountIn = calculateInGivenOut(amountOut, path);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountInMax >= amountIn,                                                                                                                                                                            │
│             "VaderRouter::swapTokensForExactTokens: Large Trade Input"                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _swap(amountIn, path, to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function calculateInGivenOut(uint256 amountOut, address[] calldata path)                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountIn)                                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwapReverse(                                                                                                                                                                 │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function swapTokensForExactTokens(                                                                                                                                                                          │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 amountInMax,                                                                                                                                                                                    │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual ensure(deadline) returns (uint256 amountIn) {                                                                                                                                            │
│         amountIn = calculateInGivenOut(amountOut, path);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountInMax >= amountIn,                                                                                                                                                                            │
│             "VaderRouter::swapTokensForExactTokens: Large Trade Input"                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _swap(amountIn, path, to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function calculateInGivenOut(uint256 amountOut, address[] calldata path)                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountIn)                                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwapReverse(                                                                                                                                                                 │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function swapTokensForExactTokens(                                                                                                                                                                          │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 amountInMax,                                                                                                                                                                                    │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual ensure(deadline) returns (uint256 amountIn) {                                                                                                                                            │
│         amountIn = calculateInGivenOut(amountOut, path);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountInMax >= amountIn,                                                                                                                                                                            │
│             "VaderRouter::swapTokensForExactTokens: Large Trade Input"                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _swap(amountIn, path, to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function calculateInGivenOut(uint256 amountOut, address[] calldata path)                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountIn)                                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwapReverse(                                                                                                                                                                 │
│                     VaderMath.calculateSwapReverse(                                                                                                                                                             │
│                         amountOut,                                                                                                                                                                              │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateOutGivenIn(uint256 amountIn, address[] calldata path)                                                                                                                                     │
│         external                                                                                                                                                                                                │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountOut)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwap(                                                                                                                                                                        │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateOutGivenIn(uint256 amountIn, address[] calldata path)                                                                                                                                     │
│         external                                                                                                                                                                                                │
│         view                                                                                                                                                                                                    │
│         returns (uint256 amountOut)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         if (path.length == 2) {                                                                                                                                                                                 │
│             address nativeAsset = factory.nativeAsset();                                                                                                                                                        │
│             IVaderPool pool = factory.getPool(path[0], path[1]);                                                                                                                                                │
│             (uint256 nativeReserve, uint256 foreignReserve, ) = pool                                                                                                                                            │
│                 .getReserves();                                                                                                                                                                                 │
│             if (path[0] == nativeAsset) {                                                                                                                                                                       │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         nativeReserve,                                                                                                                                                                          │
│                         foreignReserve                                                                                                                                                                          │
│                     );                                                                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 return                                                                                                                                                                                          │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         foreignReserve,                                                                                                                                                                         │
│                         nativeReserve                                                                                                                                                                           │
│                     );                                                                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IVaderPool pool0 = factory.getPool(path[0], path[1]);                                                                                                                                               │
│             IVaderPool pool1 = factory.getPool(path[1], path[2]);                                                                                                                                               │
│             (uint256 nativeReserve0, uint256 foreignReserve0, ) = pool0                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│             (uint256 nativeReserve1, uint256 foreignReserve1, ) = pool1                                                                                                                                         │
│                 .getReserves();                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│             return                                                                                                                                                                                              │
│                 VaderMath.calculateSwap(                                                                                                                                                                        │
│                     VaderMath.calculateSwap(                                                                                                                                                                    │
│                         amountIn,                                                                                                                                                                               │
│                         nativeReserve1,                                                                                                                                                                         │
│                         foreignReserve1                                                                                                                                                                         │
│                     ),                                                                                                                                                                                          │
│                     foreignReserve0,                                                                                                                                                                            │
│                     nativeReserve0                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ mint or vest or collect token/liquidity/earning and assign them to the address recipient or to variable,                                                                                                        │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes",                                                                                                                                                                                                 │
│     "4": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: mint or vest or collect token/liquidity/earning and assign them to the address recipient or to variable, and this operation could be front run to benefit the account/address that can be controlled │
│ by the parameter and has no sender check in the function code                                                                                                                                                   │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function leave(uint256 _shares) external {                                                                                                                                                                  │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│         // Calculates the amount of vader the xVader is worth                                                                                                                                                   │
│         uint256 vaderAmount = (_shares * vader.balanceOf(address(this))) /                                                                                                                                      │
│             totalShares;                                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│         vader.transfer(msg.sender, vaderAmount);                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 id, address to)                                                                                                                                                                       │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountNative, amountForeign) = _burn(id, to);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         Position storage position = positions;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 creation = position.creation;                                                                                                                                                                   │
│         uint256 originalNative = position.originalNative;                                                                                                                                                       │
│         uint256 originalForeign = position.originalForeign;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         delete positions;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Validate it behaves as expected for non-18 decimal tokens                                                                                                                                      │
│         uint256 loss = VaderMath.calculateLoss(                                                                                                                                                                 │
│             originalNative,                                                                                                                                                                                     │
│             originalForeign,                                                                                                                                                                                    │
│             amountNative,                                                                                                                                                                                       │
│             amountForeign                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Original Implementation Applied 100 Days                                                                                                                                                       │
│         coveredLoss =                                                                                                                                                                                           │
│             (loss * _min(block.timestamp - creation, _ONE_YEAR)) /                                                                                                                                              │
│             _ONE_YEAR;                                                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 id, address to)                                                                                                                                                                       │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountNative, amountForeign) = _burn(id, to);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         Position storage position = positions;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 creation = position.creation;                                                                                                                                                                   │
│         uint256 originalNative = position.originalNative;                                                                                                                                                       │
│         uint256 originalForeign = position.originalForeign;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         delete positions;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Validate it behaves as expected for non-18 decimal tokens                                                                                                                                      │
│         uint256 loss = VaderMath.calculateLoss(                                                                                                                                                                 │
│             originalNative,                                                                                                                                                                                     │
│             originalForeign,                                                                                                                                                                                    │
│             amountNative,                                                                                                                                                                                       │
│             amountForeign                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Original Implementation Applied 100 Days                                                                                                                                                       │
│         coveredLoss =                                                                                                                                                                                           │
│             (loss * _min(block.timestamp - creation, _ONE_YEAR)) /                                                                                                                                              │
│             _ONE_YEAR;                                                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function swap(                                                                                                                                                                                              │
│         uint256 nativeAmountIn,                                                                                                                                                                                 │
│         uint256 foreignAmountIn,                                                                                                                                                                                │
│         address to                                                                                                                                                                                              │
│     ) public override nonReentrant validateGas returns (uint256) {                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             (nativeAmountIn > 0 && foreignAmountIn == 0) ||                                                                                                                                                     │
│                 (nativeAmountIn == 0 && foreignAmountIn > 0),                                                                                                                                                   │
│             "BasePool::swap: Only One-Sided Swaps Supported"                                                                                                                                                    │
│         );                                                                                                                                                                                                      │
│         (uint112 nativeReserve, uint112 foreignReserve, ) = getReserves(); // gas savings                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 nativeBalance;                                                                                                                                                                                  │
│         uint256 foreignBalance;                                                                                                                                                                                 │
│         uint256 nativeAmountOut;                                                                                                                                                                                │
│         uint256 foreignAmountOut;                                                                                                                                                                               │
│         {                                                                                                                                                                                                       │
│             // scope for _token{0,1}, avoids stack too deep errors                                                                                                                                              │
│             IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                  │
│             IERC20 _foreignAsset = foreignAsset;                                                                                                                                                                │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│                                                                                                                                                                                                                 │
│             require(                                                                                                                                                                                            │
│                 to != address(_nativeAsset) && to != address(_foreignAsset),                                                                                                                                    │
│                 "BasePool::swap: Invalid Receiver"                                                                                                                                                              │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (foreignAmountIn > 0) {                                                                                                                                                                          │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignBalance - foreignReserve,                                                                                                                                         │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignReserve,                                                                                                                                                          │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 nativeAmountOut = VaderMath.calculateSwap(                                                                                                                                                      │
│                     foreignAmountIn,                                                                                                                                                                            │
│                     foreignReserve,                                                                                                                                                                             │
│                     nativeReserve                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountOut > 0 && nativeAmountOut <= nativeReserve,                                                                                                                                    │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _nativeAsset.safeTransfer(to, nativeAmountOut); // optimistically transfer tokens                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeBalance - nativeReserve,                                                                                                                                            │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeReserve,                                                                                                                                                            │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 foreignAmountOut = VaderMath.calculateSwap(                                                                                                                                                     │
│                     nativeAmountIn,                                                                                                                                                                             │
│                     nativeReserve,                                                                                                                                                                              │
│                     foreignReserve                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountOut > 0 && foreignAmountOut <= foreignReserve,                                                                                                                                 │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _foreignAsset.safeTransfer(to, foreignAmountOut); // optimistically transfer tokens                                                                                                             │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, nativeReserve, foreignReserve);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Swap(                                                                                                                                                                                              │
│             msg.sender,                                                                                                                                                                                         │
│             nativeAmountIn,                                                                                                                                                                                     │
│             foreignAmountIn,                                                                                                                                                                                    │
│             nativeAmountOut,                                                                                                                                                                                    │
│             foreignAmountOut,                                                                                                                                                                                   │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return nativeAmountOut > 0 ? nativeAmountOut : foreignAmountOut;                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function swap(                                                                                                                                                                                              │
│         uint256 nativeAmountIn,                                                                                                                                                                                 │
│         uint256 foreignAmountIn,                                                                                                                                                                                │
│         address to                                                                                                                                                                                              │
│     ) public override nonReentrant validateGas returns (uint256) {                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             (nativeAmountIn > 0 && foreignAmountIn == 0) ||                                                                                                                                                     │
│                 (nativeAmountIn == 0 && foreignAmountIn > 0),                                                                                                                                                   │
│             "BasePool::swap: Only One-Sided Swaps Supported"                                                                                                                                                    │
│         );                                                                                                                                                                                                      │
│         (uint112 nativeReserve, uint112 foreignReserve, ) = getReserves(); // gas savings                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 nativeBalance;                                                                                                                                                                                  │
│         uint256 foreignBalance;                                                                                                                                                                                 │
│         uint256 nativeAmountOut;                                                                                                                                                                                │
│         uint256 foreignAmountOut;                                                                                                                                                                               │
│         {                                                                                                                                                                                                       │
│             // scope for _token{0,1}, avoids stack too deep errors                                                                                                                                              │
│             IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                  │
│             IERC20 _foreignAsset = foreignAsset;                                                                                                                                                                │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│                                                                                                                                                                                                                 │
│             require(                                                                                                                                                                                            │
│                 to != address(_nativeAsset) && to != address(_foreignAsset),                                                                                                                                    │
│                 "BasePool::swap: Invalid Receiver"                                                                                                                                                              │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (foreignAmountIn > 0) {                                                                                                                                                                          │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignBalance - foreignReserve,                                                                                                                                         │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignReserve,                                                                                                                                                          │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 nativeAmountOut = VaderMath.calculateSwap(                                                                                                                                                      │
│                     foreignAmountIn,                                                                                                                                                                            │
│                     foreignReserve,                                                                                                                                                                             │
│                     nativeReserve                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountOut > 0 && nativeAmountOut <= nativeReserve,                                                                                                                                    │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _nativeAsset.safeTransfer(to, nativeAmountOut); // optimistically transfer tokens                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeBalance - nativeReserve,                                                                                                                                            │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeReserve,                                                                                                                                                            │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 foreignAmountOut = VaderMath.calculateSwap(                                                                                                                                                     │
│                     nativeAmountIn,                                                                                                                                                                             │
│                     nativeReserve,                                                                                                                                                                              │
│                     foreignReserve                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountOut > 0 && foreignAmountOut <= foreignReserve,                                                                                                                                 │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _foreignAsset.safeTransfer(to, foreignAmountOut); // optimistically transfer tokens                                                                                                             │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, nativeReserve, foreignReserve);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Swap(                                                                                                                                                                                              │
│             msg.sender,                                                                                                                                                                                         │
│             nativeAmountIn,                                                                                                                                                                                     │
│             foreignAmountIn,                                                                                                                                                                                    │
│             nativeAmountOut,                                                                                                                                                                                    │
│             foreignAmountOut,                                                                                                                                                                                   │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return nativeAmountOut > 0 ? nativeAmountOut : foreignAmountOut;                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _swap(                                                                                                                                                                                             │
│         uint256[] memory amounts,                                                                                                                                                                               │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             uint256 amountOut = amounts;                                                                                                                                                                        │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOut)                                                                                                                                                                       │
│                 : (amountOut, uint256(0));                                                                                                                                                                      │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             IUniswapV2Pair(UniswapV2Library.pairFor(factory, input, output))                                                                                                                                    │
│                 .swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function swap(                                                                                                                                                                                              │
│         uint256 nativeAmountIn,                                                                                                                                                                                 │
│         uint256 foreignAmountIn,                                                                                                                                                                                │
│         address to                                                                                                                                                                                              │
│     ) public override nonReentrant validateGas returns (uint256) {                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             (nativeAmountIn > 0 && foreignAmountIn == 0) ||                                                                                                                                                     │
│                 (nativeAmountIn == 0 && foreignAmountIn > 0),                                                                                                                                                   │
│             "BasePool::swap: Only One-Sided Swaps Supported"                                                                                                                                                    │
│         );                                                                                                                                                                                                      │
│         (uint112 nativeReserve, uint112 foreignReserve, ) = getReserves(); // gas savings                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 nativeBalance;                                                                                                                                                                                  │
│         uint256 foreignBalance;                                                                                                                                                                                 │
│         uint256 nativeAmountOut;                                                                                                                                                                                │
│         uint256 foreignAmountOut;                                                                                                                                                                               │
│         {                                                                                                                                                                                                       │
│             // scope for _token{0,1}, avoids stack too deep errors                                                                                                                                              │
│             IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                  │
│             IERC20 _foreignAsset = foreignAsset;                                                                                                                                                                │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│                                                                                                                                                                                                                 │
│             require(                                                                                                                                                                                            │
│                 to != address(_nativeAsset) && to != address(_foreignAsset),                                                                                                                                    │
│                 "BasePool::swap: Invalid Receiver"                                                                                                                                                              │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (foreignAmountIn > 0) {                                                                                                                                                                          │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignBalance - foreignReserve,                                                                                                                                         │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignReserve,                                                                                                                                                          │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 nativeAmountOut = VaderMath.calculateSwap(                                                                                                                                                      │
│                     foreignAmountIn,                                                                                                                                                                            │
│                     foreignReserve,                                                                                                                                                                             │
│                     nativeReserve                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountOut > 0 && nativeAmountOut <= nativeReserve,                                                                                                                                    │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _nativeAsset.safeTransfer(to, nativeAmountOut); // optimistically transfer tokens                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeBalance - nativeReserve,                                                                                                                                            │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeReserve,                                                                                                                                                            │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 foreignAmountOut = VaderMath.calculateSwap(                                                                                                                                                     │
│                     nativeAmountIn,                                                                                                                                                                             │
│                     nativeReserve,                                                                                                                                                                              │
│                     foreignReserve                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountOut > 0 && foreignAmountOut <= foreignReserve,                                                                                                                                 │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _foreignAsset.safeTransfer(to, foreignAmountOut); // optimistically transfer tokens                                                                                                             │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, nativeReserve, foreignReserve);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Swap(                                                                                                                                                                                              │
│             msg.sender,                                                                                                                                                                                         │
│             nativeAmountIn,                                                                                                                                                                                     │
│             foreignAmountIn,                                                                                                                                                                                    │
│             nativeAmountOut,                                                                                                                                                                                    │
│             foreignAmountOut,                                                                                                                                                                                   │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return nativeAmountOut > 0 ? nativeAmountOut : foreignAmountOut;                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _swap(                                                                                                                                                                                             │
│         uint256[] memory amounts,                                                                                                                                                                               │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             uint256 amountOut = amounts;                                                                                                                                                                        │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOut)                                                                                                                                                                       │
│                 : (amountOut, uint256(0));                                                                                                                                                                      │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             IUniswapV2Pair(UniswapV2Library.pairFor(factory, input, output))                                                                                                                                    │
│                 .swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function swap(                                                                                                                                                                                              │
│         uint256 nativeAmountIn,                                                                                                                                                                                 │
│         uint256 foreignAmountIn,                                                                                                                                                                                │
│         address to                                                                                                                                                                                              │
│     ) public override nonReentrant validateGas returns (uint256) {                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             (nativeAmountIn > 0 && foreignAmountIn == 0) ||                                                                                                                                                     │
│                 (nativeAmountIn == 0 && foreignAmountIn > 0),                                                                                                                                                   │
│             "BasePool::swap: Only One-Sided Swaps Supported"                                                                                                                                                    │
│         );                                                                                                                                                                                                      │
│         (uint112 nativeReserve, uint112 foreignReserve, ) = getReserves(); // gas savings                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 nativeBalance;                                                                                                                                                                                  │
│         uint256 foreignBalance;                                                                                                                                                                                 │
│         uint256 nativeAmountOut;                                                                                                                                                                                │
│         uint256 foreignAmountOut;                                                                                                                                                                               │
│         {                                                                                                                                                                                                       │
│             // scope for _token{0,1}, avoids stack too deep errors                                                                                                                                              │
│             IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                  │
│             IERC20 _foreignAsset = foreignAsset;                                                                                                                                                                │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│                                                                                                                                                                                                                 │
│             require(                                                                                                                                                                                            │
│                 to != address(_nativeAsset) && to != address(_foreignAsset),                                                                                                                                    │
│                 "BasePool::swap: Invalid Receiver"                                                                                                                                                              │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (foreignAmountIn > 0) {                                                                                                                                                                          │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignBalance - foreignReserve,                                                                                                                                         │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountIn <= foreignReserve,                                                                                                                                                          │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 nativeAmountOut = VaderMath.calculateSwap(                                                                                                                                                      │
│                     foreignAmountIn,                                                                                                                                                                            │
│                     foreignReserve,                                                                                                                                                                             │
│                     nativeReserve                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountOut > 0 && nativeAmountOut <= nativeReserve,                                                                                                                                    │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _nativeAsset.safeTransfer(to, nativeAmountOut); // optimistically transfer tokens                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeBalance - nativeReserve,                                                                                                                                            │
│                     "BasePool::swap: Insufficient Tokens Provided"                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                 require(                                                                                                                                                                                        │
│                     nativeAmountIn <= nativeReserve,                                                                                                                                                            │
│                     "BasePool::swap: Unfavourable Trade"                                                                                                                                                        │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 foreignAmountOut = VaderMath.calculateSwap(                                                                                                                                                     │
│                     nativeAmountIn,                                                                                                                                                                             │
│                     nativeReserve,                                                                                                                                                                              │
│                     foreignReserve                                                                                                                                                                              │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 require(                                                                                                                                                                                        │
│                     foreignAmountOut > 0 && foreignAmountOut <= foreignReserve,                                                                                                                                 │
│                     "BasePool::swap: Swap Impossible"                                                                                                                                                           │
│                 );                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│                 _foreignAsset.safeTransfer(to, foreignAmountOut); // optimistically transfer tokens                                                                                                             │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                              │
│             foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, nativeReserve, foreignReserve);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Swap(                                                                                                                                                                                              │
│             msg.sender,                                                                                                                                                                                         │
│             nativeAmountIn,                                                                                                                                                                                     │
│             foreignAmountIn,                                                                                                                                                                                    │
│             nativeAmountOut,                                                                                                                                                                                    │
│             foreignAmountOut,                                                                                                                                                                                   │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return nativeAmountOut > 0 ? nativeAmountOut : foreignAmountOut;                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function convert(bytes32[] calldata proof, uint256 amount, uint256 minVader)                                                                                                                                │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (uint256 vaderReceived)                                                                                                                                                                         │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             amount != 0,                                                                                                                                                                                        │
│             "Converter::convert: Non-Zero Conversion Amount Required"                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         ILinearVesting _vesting = vesting;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _vesting != ILinearVesting(_ZERO_ADDRESS),                                                                                                                                                          │
│             "Converter::convert: Vesting is not set"                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bytes32 leaf = keccak256(                                                                                                                                                                               │
│             abi.encodePacked(msg.sender, amount, salt, getChainId())                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             !claimed && proof.verify(root, leaf),                                                                                                                                                               │
│             "Converter::convert: Incorrect Proof Provided"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         claimed = true;                                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 allowance = vether.allowance(msg.sender, address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         amount = amount > allowance ? allowance : amount;                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: FoT is ignored as units are meant to be burned anyway                                                                                                                                          │
│         vether.transferFrom(msg.sender, _BURN, amount);                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;                                                                                                                                                 │
│         require(vaderReceived >= minVader, "Converter::convert: Vader < min");                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Conversion(msg.sender, amount, vaderReceived);                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 half = vaderReceived / 2;                                                                                                                                                                       │
│         vader.transfer(msg.sender, half);                                                                                                                                                                       │
│         _vesting.vestFor(msg.sender, vaderReceived - half);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function convert(bytes32[] calldata proof, uint256 amount, uint256 minVader)                                                                                                                                │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (uint256 vaderReceived)                                                                                                                                                                         │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             amount != 0,                                                                                                                                                                                        │
│             "Converter::convert: Non-Zero Conversion Amount Required"                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         ILinearVesting _vesting = vesting;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _vesting != ILinearVesting(_ZERO_ADDRESS),                                                                                                                                                          │
│             "Converter::convert: Vesting is not set"                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bytes32 leaf = keccak256(                                                                                                                                                                               │
│             abi.encodePacked(msg.sender, amount, salt, getChainId())                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             !claimed && proof.verify(root, leaf),                                                                                                                                                               │
│             "Converter::convert: Incorrect Proof Provided"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         claimed = true;                                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 allowance = vether.allowance(msg.sender, address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         amount = amount > allowance ? allowance : amount;                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: FoT is ignored as units are meant to be burned anyway                                                                                                                                          │
│         vether.transferFrom(msg.sender, _BURN, amount);                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;                                                                                                                                                 │
│         require(vaderReceived >= minVader, "Converter::convert: Vader < min");                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Conversion(msg.sender, amount, vaderReceived);                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 half = vaderReceived / 2;                                                                                                                                                                       │
│         vader.transfer(msg.sender, half);                                                                                                                                                                       │
│         _vesting.vestFor(msg.sender, vaderReceived - half);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function leave(uint256 _shares) external {                                                                                                                                                                  │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│         // Calculates the amount of vader the xVader is worth                                                                                                                                                   │
│         uint256 vaderAmount = (_shares * vader.balanceOf(address(this))) /                                                                                                                                      │
│             totalShares;                                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│         vader.transfer(msg.sender, vaderAmount);                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         IVaderPool pool;                                                                                                                                                                                        │
│         (pool, amountA, amountB) = _addLiquidity(                                                                                                                                                               │
│             address(tokenA),                                                                                                                                                                                    │
│             address(tokenB),                                                                                                                                                                                    │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         tokenA.safeTransferFrom(msg.sender, address(pool), amountA);                                                                                                                                            │
│         tokenB.safeTransferFrom(msg.sender, address(pool), amountB);                                                                                                                                            │
│         liquidity = pool.mint(to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         IVaderPool pool;                                                                                                                                                                                        │
│         (pool, amountA, amountB) = _addLiquidity(                                                                                                                                                               │
│             address(tokenA),                                                                                                                                                                                    │
│             address(tokenB),                                                                                                                                                                                    │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         tokenA.safeTransferFrom(msg.sender, address(pool), amountA);                                                                                                                                            │
│         tokenB.safeTransferFrom(msg.sender, address(pool), amountB);                                                                                                                                            │
│         liquidity = pool.mint(to);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _addLiquidity(                                                                                                                                                                                     │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin                                                                                                                                                                                      │
│     ) internal virtual returns (uint256 amountA, uint256 amountB) {                                                                                                                                             │
│         // create the pair if it doesn't exist yet                                                                                                                                                              │
│         if (IUniswapV2Factory(factory).getPair(tokenA, tokenB) == address(0)) {                                                                                                                                 │
│             IUniswapV2Factory(factory).createPair(tokenA, tokenB);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         (uint256 reserveA, uint256 reserveB) = UniswapV2Library.getReserves(                                                                                                                                    │
│             factory,                                                                                                                                                                                            │
│             tokenA,                                                                                                                                                                                             │
│             tokenB                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         if (reserveA == 0 && reserveB == 0) {                                                                                                                                                                   │
│             (amountA, amountB) = (amountADesired, amountBDesired);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 amountBOptimal = UniswapV2Library.quote(                                                                                                                                                    │
│                 amountADesired,                                                                                                                                                                                 │
│                 reserveA,                                                                                                                                                                                       │
│                 reserveB                                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│             if (amountBOptimal <= amountBDesired) {                                                                                                                                                             │
│                 require(                                                                                                                                                                                        │
│                     amountBOptimal >= amountBMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_B_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountADesired, amountBOptimal);                                                                                                                                          │
│             } else {                                                                                                                                                                                            │
│                 uint256 amountAOptimal = UniswapV2Library.quote(                                                                                                                                                │
│                     amountBDesired,                                                                                                                                                                             │
│                     reserveB,                                                                                                                                                                                   │
│                     reserveA                                                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 assert(amountAOptimal <= amountADesired);                                                                                                                                                       │
│                 require(                                                                                                                                                                                        │
│                     amountAOptimal >= amountAMin,                                                                                                                                                               │
│                     "UniswapV2Router: INSUFFICIENT_A_AMOUNT"                                                                                                                                                    │
│                 );                                                                                                                                                                                              │
│                 (amountA, amountB) = (amountAOptimal, amountBDesired);                                                                                                                                          │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountA,                                                                                                                                                                                    │
│             uint256 amountB,                                                                                                                                                                                    │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountA, amountB) = _addLiquidity(                                                                                                                                                                     │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             amountADesired,                                                                                                                                                                                     │
│             amountBDesired,                                                                                                                                                                                     │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         TransferHelper.safeTransferFrom(tokenA, msg.sender, pair, amountA);                                                                                                                                     │
│         TransferHelper.safeTransferFrom(tokenB, msg.sender, pair, amountB);                                                                                                                                     │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidityETH(                                                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 amountTokenDesired,                                                                                                                                                                             │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         payable                                                                                                                                                                                                 │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (                                                                                                                                                                                               │
│             uint256 amountToken,                                                                                                                                                                                │
│             uint256 amountETH,                                                                                                                                                                                  │
│             uint256 liquidity                                                                                                                                                                                   │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = _addLiquidity(                                                                                                                                                               │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             amountTokenDesired,                                                                                                                                                                                 │
│             msg.value,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         TransferHelper.safeTransferFrom(token, msg.sender, pair, amountToken);                                                                                                                                  │
│         IWETH(WETH).deposit{value: amountETH}();                                                                                                                                                                │
│         assert(IWETH(WETH).transfer(pair, amountETH));                                                                                                                                                          │
│         liquidity = IUniswapV2Pair(pair).mint(to);                                                                                                                                                              │
│         // refund dust eth, if any                                                                                                                                                                              │
│         if (msg.value > amountETH)                                                                                                                                                                              │
│             TransferHelper.safeTransferETH(msg.sender, msg.value - amountETH);                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermit(                                                                                                                                                                      │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         (amountToken, amountETH) = removeLiquidityETH(                                                                                                                                                          │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermit(                                                                                                                                                                      │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         (amountToken, amountETH) = removeLiquidityETH(                                                                                                                                                          │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens(                                                                                                                                         │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountETH) {                                                                                                                                                   │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         amountETH = removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens(                                                                                                                                         │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountETH) {                                                                                                                                                   │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         amountETH = removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve transfering token from an address different from message sender                                                                                                                              │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens(                                                                                                                                         │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountETH) {                                                                                                                                                   │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         amountETH = removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve transfering token from an address different from message sender and there is no check of allowance/approval from the address owner                                                           │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHWithPermitSupportingFeeOnTransferTokens(                                                                                                                                         │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountETH) {                                                                                                                                                   │
│         address pair = UniswapV2Library.pairFor(factory, token, WETH);                                                                                                                                          │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         amountETH = removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function swapExactETHForTokensSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external payable virtual override ensure(deadline) {                                                                                                                                                      │
│         require(path[0] == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                              │
│         uint256 amountIn = msg.value;                                                                                                                                                                           │
│         IWETH(WETH).deposit{value: amountIn}();                                                                                                                                                                 │
│         assert(                                                                                                                                                                                                 │
│             IWETH(WETH).transfer(                                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                            │
│                 amountIn                                                                                                                                                                                        │
│             )                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function swapExactETHForTokensSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external payable virtual override ensure(deadline) {                                                                                                                                                      │
│         require(path[0] == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                              │
│         uint256 amountIn = msg.value;                                                                                                                                                                           │
│         IWETH(WETH).deposit{value: amountIn}();                                                                                                                                                                 │
│         assert(                                                                                                                                                                                                 │
│             IWETH(WETH).transfer(                                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                            │
│                 amountIn                                                                                                                                                                                        │
│             )                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForTokensSupportingFeeOnTransferTokens(                                                                                                                                             │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForTokensSupportingFeeOnTransferTokens(                                                                                                                                             │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForETHSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         _swapSupportingFeeOnTransferTokens(path, address(this));                                                                                                                                                │
│         uint256 amountOut = IERC20(WETH).balanceOf(address(this));                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             amountOut >= amountOutMin,                                                                                                                                                                          │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountOut);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountOut);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForETHSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         _swapSupportingFeeOnTransferTokens(path, address(this));                                                                                                                                                │
│         uint256 amountOut = IERC20(WETH).balanceOf(address(this));                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             amountOut >= amountOutMin,                                                                                                                                                                          │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountOut);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountOut);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _swapSupportingFeeOnTransferTokens(                                                                                                                                                                │
│         address[] memory path,                                                                                                                                                                                  │
│         address _to                                                                                                                                                                                             │
│     ) internal virtual {                                                                                                                                                                                        │
│         for (uint256 i; i < path.length - 1; i++) {                                                                                                                                                             │
│             (address input, address output) = (path, path);                                                                                                                                                     │
│             (address token0, ) = UniswapV2Library.sortTokens(input, output);                                                                                                                                    │
│             IUniswapV2Pair pair = IUniswapV2Pair(                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, input, output)                                                                                                                                                │
│             );                                                                                                                                                                                                  │
│             uint256 amountInput;                                                                                                                                                                                │
│             uint256 amountOutput;                                                                                                                                                                               │
│             {                                                                                                                                                                                                   │
│                 // scope to avoid stack too deep errors                                                                                                                                                         │
│                 (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                    │
│                 (uint256 reserveInput, uint256 reserveOutput) = input == token0                                                                                                                                 │
│                     ? (reserve0, reserve1)                                                                                                                                                                      │
│                     : (reserve1, reserve0);                                                                                                                                                                     │
│                 amountInput = IERC20(input).balanceOf(address(pair)).sub(                                                                                                                                       │
│                     reserveInput                                                                                                                                                                                │
│                 );                                                                                                                                                                                              │
│                 amountOutput = UniswapV2Library.getAmountOut(                                                                                                                                                   │
│                     amountInput,                                                                                                                                                                                │
│                     reserveInput,                                                                                                                                                                               │
│                     reserveOutput                                                                                                                                                                               │
│                 );                                                                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│             (uint256 amount0Out, uint256 amount1Out) = input == token0                                                                                                                                          │
│                 ? (uint256(0), amountOutput)                                                                                                                                                                    │
│                 : (amountOutput, uint256(0));                                                                                                                                                                   │
│             address to = i < path.length - 2                                                                                                                                                                    │
│                 ? UniswapV2Library.pairFor(factory, output, path)                                                                                                                                               │
│                 : _to;                                                                                                                                                                                          │
│             pair.swap(amount0Out, amount1Out, to, new bytes(0));                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForTokensSupportingFeeOnTransferTokens(                                                                                                                                             │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve transfering token from an address different from message sender                                                                                                                              │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function swapExactETHForTokensSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external payable virtual override ensure(deadline) {                                                                                                                                                      │
│         require(path[0] == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                              │
│         uint256 amountIn = msg.value;                                                                                                                                                                           │
│         IWETH(WETH).deposit{value: amountIn}();                                                                                                                                                                 │
│         assert(                                                                                                                                                                                                 │
│             IWETH(WETH).transfer(                                                                                                                                                                               │
│                 UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                            │
│                 amountIn                                                                                                                                                                                        │
│             )                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         uint256 balanceBefore = IERC20(path).balanceOf(to);                                                                                                                                                     │
│         _swapSupportingFeeOnTransferTokens(path, to);                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             IERC20(path).balanceOf(to).sub(balanceBefore) >=                                                                                                                                                    │
│                 amountOutMin,                                                                                                                                                                                   │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForETHSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         _swapSupportingFeeOnTransferTokens(path, address(this));                                                                                                                                                │
│         uint256 amountOut = IERC20(WETH).balanceOf(address(this));                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             amountOut >= amountOutMin,                                                                                                                                                                          │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountOut);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountOut);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getStaleVaderPrice() external view returns (uint256) {                                                                                                                                             │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         uint256[] memory pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                      │
│         uint256 pastTotalLiquidityWeight = totalLiquidityWeight[                                                                                                                                                │
│             uint256(Paths.VADER)                                                                                                                                                                                │
│         ];                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i)                                                                                                                                                                    │
│             pastLiquidityWeights = twapData[address(vaderPairs)]                                                                                                                                                │
│                 .pastLiquidityEvaluation;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateVaderPrice(                                                                                                                                                                               │
│                 pastLiquidityWeights,                                                                                                                                                                           │
│                 pastTotalLiquidityWeight                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getStaleUSDVPrice() external view returns (uint256) {                                                                                                                                              │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         uint256[] memory pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                      │
│         uint256 pastTotalLiquidityWeight = totalLiquidityWeight[                                                                                                                                                │
│             uint256(Paths.USDV)                                                                                                                                                                                 │
│         ];                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i)                                                                                                                                                                    │
│             pastLiquidityWeights = twapData[address(usdvPairs)]                                                                                                                                                 │
│                 .pastLiquidityEvaluation;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateUSDVPrice(pastLiquidityWeights, pastTotalLiquidityWeight);                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getVaderPrice() external returns (uint256) {                                                                                                                                                       │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncVaderPrice();                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateVaderPrice(                                                                                                                                                                               │
│                 pastLiquidityWeights,                                                                                                                                                                           │
│                 pastTotalLiquidityWeight                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getVaderPrice() external returns (uint256) {                                                                                                                                                       │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncVaderPrice();                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateVaderPrice(                                                                                                                                                                               │
│                 pastLiquidityWeights,                                                                                                                                                                           │
│                 pastTotalLiquidityWeight                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _updateVaderPrice(                                                                                                                                                                                 │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 price0Cumulative,                                                                                                                                                                           │
│             uint256 price1Cumulative,                                                                                                                                                                           │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = UniswapV2OracleLibrary.currentCumulativePrices(address(pair));                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 nativeTokenPriceCumulative = isFirst                                                                                                                                                            │
│             ? price0Cumulative                                                                                                                                                                                  │
│             : price1Cumulative;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(pairData.foreignAsset));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _updateVaderPrice(                                                                                                                                                                                 │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 price0Cumulative,                                                                                                                                                                           │
│             uint256 price1Cumulative,                                                                                                                                                                           │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = UniswapV2OracleLibrary.currentCumulativePrices(address(pair));                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 nativeTokenPriceCumulative = isFirst                                                                                                                                                            │
│             ? price0Cumulative                                                                                                                                                                                  │
│             : price1Cumulative;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(pairData.foreignAsset));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _updateVaderPrice(                                                                                                                                                                                 │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 price0Cumulative,                                                                                                                                                                           │
│             uint256 price1Cumulative,                                                                                                                                                                           │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = UniswapV2OracleLibrary.currentCumulativePrices(address(pair));                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 nativeTokenPriceCumulative = isFirst                                                                                                                                                            │
│             ? price0Cumulative                                                                                                                                                                                  │
│             : price1Cumulative;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(pairData.foreignAsset));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _updateVaderPrice(                                                                                                                                                                                 │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 price0Cumulative,                                                                                                                                                                           │
│             uint256 price1Cumulative,                                                                                                                                                                           │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = UniswapV2OracleLibrary.currentCumulativePrices(address(pair));                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 nativeTokenPriceCumulative = isFirst                                                                                                                                                            │
│             ? price0Cumulative                                                                                                                                                                                  │
│             : price1Cumulative;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(pairData.foreignAsset));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes.                                                                                                                                                                                                            │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _calculateVaderPrice(                                                                                                                                                                              │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalVaderLiquidityWeight                                                                                                                                                                       │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalVader;                                                                                                                                                                                     │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(pairData.foreignAsset);                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             totalVader +=                                                                                                                                                                                       │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalVader;                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getStaleVaderPrice() external view returns (uint256) {                                                                                                                                             │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         uint256[] memory pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                      │
│         uint256 pastTotalLiquidityWeight = totalLiquidityWeight[                                                                                                                                                │
│             uint256(Paths.VADER)                                                                                                                                                                                │
│         ];                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i)                                                                                                                                                                    │
│             pastLiquidityWeights = twapData[address(vaderPairs)]                                                                                                                                                │
│                 .pastLiquidityEvaluation;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateVaderPrice(                                                                                                                                                                               │
│                 pastLiquidityWeights,                                                                                                                                                                           │
│                 pastTotalLiquidityWeight                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _calculateVaderPrice(                                                                                                                                                                              │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalVaderLiquidityWeight                                                                                                                                                                       │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalVader;                                                                                                                                                                                     │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(pairData.foreignAsset);                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             totalVader +=                                                                                                                                                                                       │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalVader;                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getVaderPrice() external returns (uint256) {                                                                                                                                                       │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncVaderPrice();                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateVaderPrice(                                                                                                                                                                               │
│                 pastLiquidityWeights,                                                                                                                                                                           │
│                 pastTotalLiquidityWeight                                                                                                                                                                        │
│             );                                                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _calculateVaderPrice(                                                                                                                                                                              │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalVaderLiquidityWeight                                                                                                                                                                       │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalVader;                                                                                                                                                                                     │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(pairData.foreignAsset);                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             totalVader +=                                                                                                                                                                                       │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalVaderLiquidityWeight;                                                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalVader;                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _addVaderPair(                                                                                                                                                                                     │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         IAggregatorV3 oracle,                                                                                                                                                                                   │
│         uint256 updatePeriod                                                                                                                                                                                    │
│     ) internal {                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             updatePeriod != 0,                                                                                                                                                                                  │
│             "LBTWAP::addVaderPair: Incorrect Update Period"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(oracle.decimals() == 8, "LBTWAP::addVaderPair: Non-USD Oracle");                                                                                                                                │
│                                                                                                                                                                                                                 │
│         ExchangePair storage pairData = twapData;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (address nativeAsset, address foreignAsset) = isFirst                                                                                                                                                   │
│             ? (pair.token0(), pair.token1())                                                                                                                                                                    │
│             : (pair.token1(), pair.token0());                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         oracles = oracle;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(nativeAsset == vader, "LBTWAP::addVaderPair: Unsupported Pair");                                                                                                                                │
│                                                                                                                                                                                                                 │
│         pairData.foreignAsset = foreignAsset;                                                                                                                                                                   │
│         pairData.foreignUnit = uint96(                                                                                                                                                                          │
│             10**uint256(IERC20Metadata(foreignAsset).decimals())                                                                                                                                                │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.updatePeriod = updatePeriod;                                                                                                                                                                   │
│         pairData.lastMeasurement = block.timestamp;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = isFirst                                                                                                                                                           │
│             ? pair.price0CumulativeLast()                                                                                                                                                                       │
│             : pair.price1CumulativeLast();                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 pairLiquidityEvaluation = (reserveNative *                                                                                                                                                      │
│             previousPrices) +                                                                                                                                                                                   │
│             (reserveForeign * getChainlinkPrice(foreignAsset));                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         pairData.pastLiquidityEvaluation = pairLiquidityEvaluation;                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight += pairLiquidityEvaluation;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         vaderPairs.push(pair);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         if (maxUpdateWindow < updatePeriod) maxUpdateWindow = updatePeriod;                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _addVaderPair(                                                                                                                                                                                     │
│         IUniswapV2Pair pair,                                                                                                                                                                                    │
│         IAggregatorV3 oracle,                                                                                                                                                                                   │
│         uint256 updatePeriod                                                                                                                                                                                    │
│     ) internal {                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             updatePeriod != 0,                                                                                                                                                                                  │
│             "LBTWAP::addVaderPair: Incorrect Update Period"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(oracle.decimals() == 8, "LBTWAP::addVaderPair: Non-USD Oracle");                                                                                                                                │
│                                                                                                                                                                                                                 │
│         ExchangePair storage pairData = twapData;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         bool isFirst = pair.token0() == vader;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (address nativeAsset, address foreignAsset) = isFirst                                                                                                                                                   │
│             ? (pair.token0(), pair.token1())                                                                                                                                                                    │
│             : (pair.token1(), pair.token0());                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         oracles = oracle;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(nativeAsset == vader, "LBTWAP::addVaderPair: Unsupported Pair");                                                                                                                                │
│                                                                                                                                                                                                                 │
│         pairData.foreignAsset = foreignAsset;                                                                                                                                                                   │
│         pairData.foreignUnit = uint96(                                                                                                                                                                          │
│             10**uint256(IERC20Metadata(foreignAsset).decimals())                                                                                                                                                │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.updatePeriod = updatePeriod;                                                                                                                                                                   │
│         pairData.lastMeasurement = block.timestamp;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = isFirst                                                                                                                                                           │
│             ? pair.price0CumulativeLast()                                                                                                                                                                       │
│             : pair.price1CumulativeLast();                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint256 reserve0, uint256 reserve1, ) = pair.getReserves();                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign) = isFirst                                                                                                                                               │
│             ? (reserve0, reserve1)                                                                                                                                                                              │
│             : (reserve1, reserve0);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 pairLiquidityEvaluation = (reserveNative *                                                                                                                                                      │
│             previousPrices) +                                                                                                                                                                                   │
│             (reserveForeign * getChainlinkPrice(foreignAsset));                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         pairData.pastLiquidityEvaluation = pairLiquidityEvaluation;                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight += pairLiquidityEvaluation;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         vaderPairs.push(pair);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         if (maxUpdateWindow < updatePeriod) maxUpdateWindow = updatePeriod;                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getUSDVPrice() external returns (uint256) {                                                                                                                                                        │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncUSDVPrice();                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateUSDVPrice(pastLiquidityWeights, pastTotalLiquidityWeight);                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getUSDVPrice() external returns (uint256) {                                                                                                                                                        │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncUSDVPrice();                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateUSDVPrice(pastLiquidityWeights, pastTotalLiquidityWeight);                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _updateUSDVPrice(                                                                                                                                                                                  │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 nativeTokenPriceCumulative,                                                                                                                                                                 │
│             ,                                                                                                                                                                                                   │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = vaderPool.cumulativePrices(foreignAsset);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _updateUSDVPrice(                                                                                                                                                                                  │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 nativeTokenPriceCumulative,                                                                                                                                                                 │
│             ,                                                                                                                                                                                                   │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = vaderPool.cumulativePrices(foreignAsset);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _updateUSDVPrice(                                                                                                                                                                                  │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 nativeTokenPriceCumulative,                                                                                                                                                                 │
│             ,                                                                                                                                                                                                   │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = vaderPool.cumulativePrices(foreignAsset);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _updateUSDVPrice(                                                                                                                                                                                  │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         ExchangePair storage pairData,                                                                                                                                                                          │
│         uint256 timeElapsed                                                                                                                                                                                     │
│     ) internal returns (uint256 currentLiquidityEvaluation) {                                                                                                                                                   │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 nativeTokenPriceCumulative,                                                                                                                                                                 │
│             ,                                                                                                                                                                                                   │
│             uint256 currentMeasurement                                                                                                                                                                          │
│         ) = vaderPool.cumulativePrices(foreignAsset);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         unchecked {                                                                                                                                                                                             │
│             pairData.nativeTokenPriceAverage = FixedPoint.uq112x112(                                                                                                                                            │
│                 uint224(                                                                                                                                                                                        │
│                     (nativeTokenPriceCumulative -                                                                                                                                                               │
│                         pairData.nativeTokenPriceCumulative) / timeElapsed                                                                                                                                      │
│                 )                                                                                                                                                                                               │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pairData.lastMeasurement = currentMeasurement;                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         currentLiquidityEvaluation =                                                                                                                                                                            │
│             (reserveNative * previousPrices) +                                                                                                                                                                  │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _calculateUSDVPrice(                                                                                                                                                                               │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalUSDVLiquidityWeight                                                                                                                                                                        │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalUSDV;                                                                                                                                                                                      │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(address(foreignAsset));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│             totalUSDV +=                                                                                                                                                                                        │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalUSDV;                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getStaleUSDVPrice() external view returns (uint256) {                                                                                                                                              │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         uint256[] memory pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                      │
│         uint256 pastTotalLiquidityWeight = totalLiquidityWeight[                                                                                                                                                │
│             uint256(Paths.USDV)                                                                                                                                                                                 │
│         ];                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i)                                                                                                                                                                    │
│             pastLiquidityWeights = twapData[address(usdvPairs)]                                                                                                                                                 │
│                 .pastLiquidityEvaluation;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateUSDVPrice(pastLiquidityWeights, pastTotalLiquidityWeight);                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function _calculateUSDVPrice(                                                                                                                                                                               │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalUSDVLiquidityWeight                                                                                                                                                                        │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalUSDV;                                                                                                                                                                                      │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(address(foreignAsset));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│             totalUSDV +=                                                                                                                                                                                        │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalUSDV;                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getUSDVPrice() external returns (uint256) {                                                                                                                                                        │
│         (                                                                                                                                                                                                       │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         ) = syncUSDVPrice();                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         return                                                                                                                                                                                                  │
│             _calculateUSDVPrice(pastLiquidityWeights, pastTotalLiquidityWeight);                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function _calculateUSDVPrice(                                                                                                                                                                               │
│         uint256[] memory liquidityWeights,                                                                                                                                                                      │
│         uint256 totalUSDVLiquidityWeight                                                                                                                                                                        │
│     ) internal view returns (uint256) {                                                                                                                                                                         │
│         uint256 totalUSD;                                                                                                                                                                                       │
│         uint256 totalUSDV;                                                                                                                                                                                      │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│             uint256 foreignPrice = getChainlinkPrice(address(foreignAsset));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│             totalUSD +=                                                                                                                                                                                         │
│                 (foreignPrice * liquidityWeights) /                                                                                                                                                             │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│             totalUSDV +=                                                                                                                                                                                        │
│                 (pairData                                                                                                                                                                                       │
│                     .nativeTokenPriceAverage                                                                                                                                                                    │
│                     .mul(pairData.foreignUnit)                                                                                                                                                                  │
│                     .decode144() * liquidityWeights) /                                                                                                                                                          │
│                 totalUSDVLiquidityWeight;                                                                                                                                                                       │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Accuracy of VADER & USDV is 18 decimals == 1 ether                                                                                                                                             │
│         return (totalUSD * 1 ether) / totalUSDV;                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _addUSDVPair(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         IAggregatorV3 oracle,                                                                                                                                                                                   │
│         uint256 updatePeriod                                                                                                                                                                                    │
│     ) internal {                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             updatePeriod != 0,                                                                                                                                                                                  │
│             "LBTWAP::addUSDVPair: Incorrect Update Period"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(oracle.decimals() == 8, "LBTWAP::addUSDVPair: Non-USD Oracle");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         oracles = oracle;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         ExchangePair storage pairData = twapData;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // NOTE: Redundant                                                                                                                                                                                      │
│         // pairData.foreignAsset = foreignAsset;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         pairData.foreignUnit = uint96(                                                                                                                                                                          │
│             10**uint256(IERC20Metadata(address(foreignAsset)).decimals())                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.updatePeriod = updatePeriod;                                                                                                                                                                   │
│         pairData.lastMeasurement = block.timestamp;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (uint256 nativeTokenPriceCumulative, , ) = vaderPool.cumulativePrices(                                                                                                                                  │
│             foreignAsset                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 pairLiquidityEvaluation = (reserveNative *                                                                                                                                                      │
│             previousPrices) +                                                                                                                                                                                   │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         pairData.pastLiquidityEvaluation = pairLiquidityEvaluation;                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight += pairLiquidityEvaluation;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         usdvPairs.push(foreignAsset);                                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         if (maxUpdateWindow < updatePeriod) maxUpdateWindow = updatePeriod;                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _addUSDVPair(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         IAggregatorV3 oracle,                                                                                                                                                                                   │
│         uint256 updatePeriod                                                                                                                                                                                    │
│     ) internal {                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             updatePeriod != 0,                                                                                                                                                                                  │
│             "LBTWAP::addUSDVPair: Incorrect Update Period"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(oracle.decimals() == 8, "LBTWAP::addUSDVPair: Non-USD Oracle");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         oracles = oracle;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         ExchangePair storage pairData = twapData;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // NOTE: Redundant                                                                                                                                                                                      │
│         // pairData.foreignAsset = foreignAsset;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         pairData.foreignUnit = uint96(                                                                                                                                                                          │
│             10**uint256(IERC20Metadata(address(foreignAsset)).decimals())                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.updatePeriod = updatePeriod;                                                                                                                                                                   │
│         pairData.lastMeasurement = block.timestamp;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         (uint256 nativeTokenPriceCumulative, , ) = vaderPool.cumulativePrices(                                                                                                                                  │
│             foreignAsset                                                                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pairData.nativeTokenPriceCumulative = nativeTokenPriceCumulative;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (uint256 reserveNative, uint256 reserveForeign, ) = vaderPool                                                                                                                                           │
│             .getReserves(foreignAsset);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 pairLiquidityEvaluation = (reserveNative *                                                                                                                                                      │
│             previousPrices) +                                                                                                                                                                                   │
│             (reserveForeign * getChainlinkPrice(address(foreignAsset)));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         pairData.pastLiquidityEvaluation = pairLiquidityEvaluation;                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight += pairLiquidityEvaluation;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         usdvPairs.push(foreignAsset);                                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         if (maxUpdateWindow < updatePeriod) maxUpdateWindow = updatePeriod;                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public override ensure(deadline) returns (uint256 liquidity) {                                                                                                                                            │
│         IERC20 foreignAsset;                                                                                                                                                                                    │
│         uint256 nativeDeposit;                                                                                                                                                                                  │
│         uint256 foreignDeposit;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (tokenA == nativeAsset) {                                                                                                                                                                            │
│             require(                                                                                                                                                                                            │
│                 pool.supported(tokenB),                                                                                                                                                                         │
│                 "VaderRouterV2::addLiquidity: Unsupported Assets Specified"                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│             foreignAsset = tokenB;                                                                                                                                                                              │
│             foreignDeposit = amountBDesired;                                                                                                                                                                    │
│             nativeDeposit = amountADesired;                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 tokenB == nativeAsset && pool.supported(tokenA),                                                                                                                                                │
│                 "VaderRouterV2::addLiquidity: Unsupported Assets Specified"                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│             foreignAsset = tokenA;                                                                                                                                                                              │
│             foreignDeposit = amountADesired;                                                                                                                                                                    │
│             nativeDeposit = amountBDesired;                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         liquidity = pool.mint(                                                                                                                                                                                  │
│             foreignAsset,                                                                                                                                                                                       │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit,                                                                                                                                                                                     │
│             msg.sender,                                                                                                                                                                                         │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function addLiquidity(                                                                                                                                                                                      │
│         IERC20 tokenA,                                                                                                                                                                                          │
│         IERC20 tokenB,                                                                                                                                                                                          │
│         uint256 amountADesired,                                                                                                                                                                                 │
│         uint256 amountBDesired,                                                                                                                                                                                 │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public override ensure(deadline) returns (uint256 liquidity) {                                                                                                                                            │
│         IERC20 foreignAsset;                                                                                                                                                                                    │
│         uint256 nativeDeposit;                                                                                                                                                                                  │
│         uint256 foreignDeposit;                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (tokenA == nativeAsset) {                                                                                                                                                                            │
│             require(                                                                                                                                                                                            │
│                 pool.supported(tokenB),                                                                                                                                                                         │
│                 "VaderRouterV2::addLiquidity: Unsupported Assets Specified"                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│             foreignAsset = tokenB;                                                                                                                                                                              │
│             foreignDeposit = amountBDesired;                                                                                                                                                                    │
│             nativeDeposit = amountADesired;                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 tokenB == nativeAsset && pool.supported(tokenA),                                                                                                                                                │
│                 "VaderRouterV2::addLiquidity: Unsupported Assets Specified"                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│             foreignAsset = tokenA;                                                                                                                                                                              │
│             foreignDeposit = amountADesired;                                                                                                                                                                    │
│             nativeDeposit = amountBDesired;                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         liquidity = pool.mint(                                                                                                                                                                                  │
│             foreignAsset,                                                                                                                                                                                       │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit,                                                                                                                                                                                     │
│             msg.sender,                                                                                                                                                                                         │
│             to                                                                                                                                                                                                  │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityWithPermit(                                                                                                                                                                         │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountA, uint256 amountB) {                                                                                                                                    │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         (amountA, amountB) = removeLiquidity(                                                                                                                                                                   │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             liquidity,                                                                                                                                                                                          │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin,                                                                                                                                                                                         │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityWithPermit(                                                                                                                                                                         │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline,                                                                                                                                                                                       │
│         bool approveMax,                                                                                                                                                                                        │
│         uint8 v,                                                                                                                                                                                                │
│         bytes32 r,                                                                                                                                                                                              │
│         bytes32 s                                                                                                                                                                                               │
│     ) external virtual override returns (uint256 amountA, uint256 amountB) {                                                                                                                                    │
│         address pair = UniswapV2Library.pairFor(factory, tokenA, tokenB);                                                                                                                                       │
│         uint256 value = approveMax ? type(uint256).max : liquidity;                                                                                                                                             │
│         IUniswapV2Pair(pair).permit(                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             address(this),                                                                                                                                                                                      │
│             value,                                                                                                                                                                                              │
│             deadline,                                                                                                                                                                                           │
│             v,                                                                                                                                                                                                  │
│             r,                                                                                                                                                                                                  │
│             s                                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│         (amountA, amountB) = removeLiquidity(                                                                                                                                                                   │
│             tokenA,                                                                                                                                                                                             │
│             tokenB,                                                                                                                                                                                             │
│             liquidity,                                                                                                                                                                                          │
│             amountAMin,                                                                                                                                                                                         │
│             amountBMin,                                                                                                                                                                                         │
│             to,                                                                                                                                                                                                 │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function removeLiquidity(                                                                                                                                                                                   │
│         address tokenA,                                                                                                                                                                                         │
│         address tokenB,                                                                                                                                                                                         │
│         uint256 id,                                                                                                                                                                                             │
│         uint256 amountAMin,                                                                                                                                                                                     │
│         uint256 amountBMin,                                                                                                                                                                                     │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountA, uint256 amountB)                                                                                                                                                              │
│     {                                                                                                                                                                                                           │
│         IERC20 _foreignAsset = pool.positionForeignAsset(id);                                                                                                                                                   │
│         IERC20 _nativeAsset = nativeAsset;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bool isNativeA = _nativeAsset == IERC20(tokenA);                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         if (isNativeA) {                                                                                                                                                                                        │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenB) == _foreignAsset,                                                                                                                                                                │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             require(                                                                                                                                                                                            │
│                 IERC20(tokenA) == _foreignAsset &&                                                                                                                                                              │
│                     IERC20(tokenB) == _nativeAsset,                                                                                                                                                             │
│                 "VaderRouterV2::removeLiquidity: Incorrect Addresses Specified"                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         pool.transferFrom(msg.sender, address(pool), id);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         (                                                                                                                                                                                                       │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         ) = pool.burn(id, to);                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (amountA, amountB) = isNativeA                                                                                                                                                                          │
│             ? (amountNative, amountForeign)                                                                                                                                                                     │
│             : (amountForeign, amountNative);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         require(amountA >= amountAMin, "VaderRouterV2: INSUFFICIENT_A_AMOUNT");                                                                                                                                 │
│         require(amountB >= amountBMin, "VaderRouterV2: INSUFFICIENT_B_AMOUNT");                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         reserve.reimburseImpermanentLoss(msg.sender, coveredLoss);                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePool::burn: Incorrect Ownership"                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         IERC20 _nativeAsset = nativeAsset; // gas savings                                                                                                                                                       │
│         IERC20 _foreignAsset = foreignAsset; // gas savings                                                                                                                                                     │
│         uint256 nativeBalance = IERC20(_nativeAsset).balanceOf(address(this));                                                                                                                                  │
│         uint256 foreignBalance = IERC20(_foreignAsset).balanceOf(address(this));                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _totalSupply = totalSupply; // gas savings, must be defined here since totalSupply can update in _mintFee                                                                                       │
│         amountNative = (liquidity * nativeBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                              │
│         amountForeign = (liquidity * foreignBalance) / _totalSupply; // using balances ensures pro-rata distribution                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePool::burn: Insufficient Liquidity Burned"                                                                                                                                                     │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         totalSupply -= liquidity;                                                                                                                                                                               │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         _nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                            │
│         _foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         nativeBalance = _nativeAsset.balanceOf(address(this));                                                                                                                                                  │
│         foreignBalance = _foreignAsset.balanceOf(address(this));                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         _update(nativeBalance, foreignBalance, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function leave(uint256 _shares) external {                                                                                                                                                                  │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│         // Calculates the amount of vader the xVader is worth                                                                                                                                                   │
│         uint256 vaderAmount = (_shares * vader.balanceOf(address(this))) /                                                                                                                                      │
│             totalShares;                                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│         vader.transfer(msg.sender, vaderAmount);                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 id, address to)                                                                                                                                                                       │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountNative, amountForeign) = _burn(id, to);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         Position storage position = positions;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 creation = position.creation;                                                                                                                                                                   │
│         uint256 originalNative = position.originalNative;                                                                                                                                                       │
│         uint256 originalForeign = position.originalForeign;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         delete positions;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Validate it behaves as expected for non-18 decimal tokens                                                                                                                                      │
│         uint256 loss = VaderMath.calculateLoss(                                                                                                                                                                 │
│             originalNative,                                                                                                                                                                                     │
│             originalForeign,                                                                                                                                                                                    │
│             amountNative,                                                                                                                                                                                       │
│             amountForeign                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Original Implementation Applied 100 Days                                                                                                                                                       │
│         coveredLoss =                                                                                                                                                                                           │
│             (loss * _min(block.timestamp - creation, _ONE_YEAR)) /                                                                                                                                              │
│             _ONE_YEAR;                                                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 id, address to)                                                                                                                                                                       │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256 amountNative,                                                                                                                                                                               │
│             uint256 amountForeign,                                                                                                                                                                              │
│             uint256 coveredLoss                                                                                                                                                                                 │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         (amountNative, amountForeign) = _burn(id, to);                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         Position storage position = positions;                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 creation = position.creation;                                                                                                                                                                   │
│         uint256 originalNative = position.originalNative;                                                                                                                                                       │
│         uint256 originalForeign = position.originalForeign;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         delete positions;                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: Validate it behaves as expected for non-18 decimal tokens                                                                                                                                      │
│         uint256 loss = VaderMath.calculateLoss(                                                                                                                                                                 │
│             originalNative,                                                                                                                                                                                     │
│             originalForeign,                                                                                                                                                                                    │
│             amountNative,                                                                                                                                                                                       │
│             amountForeign                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Original Implementation Applied 100 Days                                                                                                                                                       │
│         coveredLoss =                                                                                                                                                                                           │
│             (loss * _min(block.timestamp - creation, _ONE_YEAR)) /                                                                                                                                              │
│             _ONE_YEAR;                                                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function _burn(uint256 id, address to)                                                                                                                                                                      │
│         internal                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             ownerOf(id) == address(this),                                                                                                                                                                       │
│             "BasePoolV2::burn: Incorrect Ownership"                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20 foreignAsset = positions.foreignAsset;                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 liquidity = positions.liquidity;                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "BasePoolV2::burn: Insufficient Liquidity Burned"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│         _burn(id);                                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function rescue(IERC20 foreignAsset) external {                                                                                                                                                             │
│         uint256 foreignBalance = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 reserveForeign = pairInfo.reserveForeign;                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 unaccounted = foreignBalance - reserveForeign;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         foreignAsset.safeTransfer(msg.sender, unaccounted);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "1": "No",                                                                                                                                                                                                    │
│   "2": "No",                                                                                                                                                                                                    │
│   "3": "Yes"                                                                                                                                                                                                    │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mint(address to)                                                                                                                                                                                   │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 liquidity)                                                                                                                                                                             │
│     {                                                                                                                                                                                                           │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(); // gas savings                                                                                                                       │
│         uint256 balanceNative = nativeAsset.balanceOf(address(this));                                                                                                                                           │
│         uint256 balanceForeign = foreignAsset.balanceOf(address(this));                                                                                                                                         │
│         uint256 nativeDeposit = balanceNative - reserveNative;                                                                                                                                                  │
│         uint256 foreignDeposit = balanceForeign - reserveForeign;                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 totalLiquidityUnits = totalSupply;                                                                                                                                                              │
│         if (totalLiquidityUnits == 0)                                                                                                                                                                           │
│             liquidity = nativeDeposit; // TODO: Contact ThorChain on proper approach                                                                                                                            │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePool::mint: Insufficient Liquidity Provided"                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         totalSupply += liquidity;                                                                                                                                                                               │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(balanceNative, balanceForeign, reserveNative, reserveForeign);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Mint(msg.sender, to, nativeDeposit, foreignDeposit);                                                                                                                                               │
│         emit PositionOpened(msg.sender, id, liquidity);                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes",                                                                                                                                                                                                 │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function enter(uint256 _amount) external {                                                                                                                                                                  │
│         // Gets the amount of vader locked in the contract                                                                                                                                                      │
│         uint256 totalVader = vader.balanceOf(address(this));                                                                                                                                                    │
│         // Gets the amount of xVader in existence                                                                                                                                                               │
│         uint256 totalShares = totalSupply();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 xVADERToMint = totalShares == 0 || totalVader == 0 // If no xVader exists, mint it 1:1 to the amount put in                                                                                     │
│             ? _amount // Calculate and mint the amount of xVader the vader is worth.                                                                                                                            │
│             : // The ratio will change overtime, as xVader is burned/minted and                                                                                                                                 │
│             // vader deposited + gained from fees / withdrawn.                                                                                                                                                  │
│             (_amount * totalShares) / totalVader;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _mint(msg.sender, xVADERToMint);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         // Lock the vader in the contract                                                                                                                                                                       │
│         vader.transferFrom(msg.sender, address(this), _amount);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _mint(                                                                                                                                                                                             │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) internal nonReentrant returns (uint256 liquidity) {                                                                                                                                                       │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "BasePoolV2::mint: Insufficient Liquidity Provided"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 id = positionId++;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│         _mint(to, id);                                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         positions = Position(                                                                                                                                                                                   │
│             foreignAsset,                                                                                                                                                                                       │
│             block.timestamp,                                                                                                                                                                                    │
│             liquidity,                                                                                                                                                                                          │
│             nativeDeposit,                                                                                                                                                                                      │
│             foreignDeposit                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│         emit PositionOpened(from, to, id, liquidity);                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mintSynth(                                                                                                                                                                                         │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         supportedToken(foreignAsset)                                                                                                                                                                            │
│         returns (uint256 amountSynth)                                                                                                                                                                           │
│     {                                                                                                                                                                                                           │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         ISynth synth = synthFactory.synths(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (synth == ISynth(_ZERO_ADDRESS))                                                                                                                                                                     │
│             synth = synthFactory.createSynth(                                                                                                                                                                   │
│                 IERC20Extended(address(foreignAsset))                                                                                                                                                           │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         amountSynth = VaderMath.calculateSwap(                                                                                                                                                                  │
│             nativeDeposit,                                                                                                                                                                                      │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Clarify                                                                                                                                                                                        │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         synth.mint(to, amountSynth);                                                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function mintSynth(                                                                                                                                                                                         │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         supportedToken(foreignAsset)                                                                                                                                                                            │
│         returns (uint256 amountSynth)                                                                                                                                                                           │
│     {                                                                                                                                                                                                           │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         ISynth synth = synthFactory.synths(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (synth == ISynth(_ZERO_ADDRESS))                                                                                                                                                                     │
│             synth = synthFactory.createSynth(                                                                                                                                                                   │
│                 IERC20Extended(address(foreignAsset))                                                                                                                                                           │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         amountSynth = VaderMath.calculateSwap(                                                                                                                                                                  │
│             nativeDeposit,                                                                                                                                                                                      │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Clarify                                                                                                                                                                                        │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         synth.mint(to, amountSynth);                                                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burnSynth(                                                                                                                                                                                         │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 synthAmount,                                                                                                                                                                                    │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 amountNative) {                                                                                                                                           │
│         ISynth synth = synthFactory.synths(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synth != ISynth(_ZERO_ADDRESS),                                                                                                                                                                     │
│             "VaderPoolV2::burnSynth: Inexistent Synth"                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synthAmount > 0,                                                                                                                                                                                    │
│             "VaderPoolV2::burnSynth: Insufficient Synth Amount"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20(synth).safeTransferFrom(msg.sender, address(this), synthAmount);                                                                                                                                 │
│         synth.burn(synthAmount);                                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         amountNative = VaderMath.calculateSwap(                                                                                                                                                                 │
│             synthAmount,                                                                                                                                                                                        │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Clarify                                                                                                                                                                                        │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function burnSynth(                                                                                                                                                                                         │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 synthAmount,                                                                                                                                                                                    │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 amountNative) {                                                                                                                                           │
│         ISynth synth = synthFactory.synths(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synth != ISynth(_ZERO_ADDRESS),                                                                                                                                                                     │
│             "VaderPoolV2::burnSynth: Inexistent Synth"                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synthAmount > 0,                                                                                                                                                                                    │
│             "VaderPoolV2::burnSynth: Insufficient Synth Amount"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20(synth).safeTransferFrom(msg.sender, address(this), synthAmount);                                                                                                                                 │
│         synth.burn(synthAmount);                                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         amountNative = VaderMath.calculateSwap(                                                                                                                                                                 │
│             synthAmount,                                                                                                                                                                                        │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Clarify                                                                                                                                                                                        │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function burnSynth(                                                                                                                                                                                         │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 synthAmount,                                                                                                                                                                                    │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 amountNative) {                                                                                                                                           │
│         ISynth synth = synthFactory.synths(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synth != ISynth(_ZERO_ADDRESS),                                                                                                                                                                     │
│             "VaderPoolV2::burnSynth: Inexistent Synth"                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             synthAmount > 0,                                                                                                                                                                                    │
│             "VaderPoolV2::burnSynth: Insufficient Synth Amount"                                                                                                                                                 │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20(synth).safeTransferFrom(msg.sender, address(this), synthAmount);                                                                                                                                 │
│         synth.burn(synthAmount);                                                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         amountNative = VaderMath.calculateSwap(                                                                                                                                                                 │
│             synthAmount,                                                                                                                                                                                        │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         // TODO: Clarify                                                                                                                                                                                        │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign,                                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries,                                                                                               │
│ have code statements that get or calculate LP token's value/price                                                                                                                                               │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function mintFungible(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 liquidity) {                                                                                                                                              │
│         IERC20Extended lp = wrapper.tokens(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             lp != IERC20Extended(_ZERO_ADDRESS),                                                                                                                                                                │
│             "VaderPoolV2::mintFungible: Unsupported Token"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "VaderPoolV2::mintFungible: Insufficient Liquidity Provided"                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lp.mint(to, liquidity);                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve calculating swap/liquidity or adding liquidity, and there is asset exchanges or price queries, but this operation could be attacked by slippage/Sandwich Attack due to no slip limit/minimum │
│ value check                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function mintFungible(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 liquidity) {                                                                                                                                              │
│         IERC20Extended lp = wrapper.tokens(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             lp != IERC20Extended(_ZERO_ADDRESS),                                                                                                                                                                │
│             "VaderPoolV2::mintFungible: Unsupported Token"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "VaderPoolV2::mintFungible: Insufficient Liquidity Provided"                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lp.mint(to, liquidity);                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function mintFungible(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 nativeDeposit,                                                                                                                                                                                  │
│         uint256 foreignDeposit,                                                                                                                                                                                 │
│         address from,                                                                                                                                                                                           │
│         address to                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256 liquidity) {                                                                                                                                              │
│         IERC20Extended lp = wrapper.tokens(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             lp != IERC20Extended(_ZERO_ADDRESS),                                                                                                                                                                │
│             "VaderPoolV2::mintFungible: Unsupported Token"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransferFrom(from, address(this), nativeDeposit);                                                                                                                                       │
│         foreignAsset.safeTransferFrom(from, address(this), foreignDeposit);                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 totalLiquidityUnits = pair.totalSupply;                                                                                                                                                         │
│         if (totalLiquidityUnits == 0) liquidity = nativeDeposit;                                                                                                                                                │
│         else                                                                                                                                                                                                    │
│             liquidity = VaderMath.calculateLiquidityUnits(                                                                                                                                                      │
│                 nativeDeposit,                                                                                                                                                                                  │
│                 reserveNative,                                                                                                                                                                                  │
│                 foreignDeposit,                                                                                                                                                                                 │
│                 reserveForeign,                                                                                                                                                                                 │
│                 totalLiquidityUnits                                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             liquidity > 0,                                                                                                                                                                                      │
│             "VaderPoolV2::mintFungible: Insufficient Liquidity Provided"                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = totalLiquidityUnits + liquidity;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative + nativeDeposit,                                                                                                                                                                      │
│             reserveForeign + foreignDeposit,                                                                                                                                                                    │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lp.mint(to, liquidity);                                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         emit Mint(from, to, nativeDeposit, foreignDeposit);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function burnFungible(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 liquidity,                                                                                                                                                                                      │
│         address to                                                                                                                                                                                              │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         IERC20Extended lp = wrapper.tokens(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             lp != IERC20Extended(_ZERO_ADDRESS),                                                                                                                                                                │
│             "VaderPoolV2::burnFungible: Unsupported Token"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20(lp).safeTransferFrom(msg.sender, address(this), liquidity);                                                                                                                                      │
│         lp.burn(liquidity);                                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "VaderPoolV2::burnFungible: Insufficient Liquidity Burned"                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function burnFungible(                                                                                                                                                                                      │
│         IERC20 foreignAsset,                                                                                                                                                                                    │
│         uint256 liquidity,                                                                                                                                                                                      │
│         address to                                                                                                                                                                                              │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         returns (uint256 amountNative, uint256 amountForeign)                                                                                                                                                   │
│     {                                                                                                                                                                                                           │
│         IERC20Extended lp = wrapper.tokens(foreignAsset);                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             lp != IERC20Extended(_ZERO_ADDRESS),                                                                                                                                                                │
│             "VaderPoolV2::burnFungible: Unsupported Token"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         IERC20(lp).safeTransferFrom(msg.sender, address(this), liquidity);                                                                                                                                      │
│         lp.burn(liquidity);                                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         (uint112 reserveNative, uint112 reserveForeign, ) = getReserves(                                                                                                                                        │
│             foreignAsset                                                                                                                                                                                        │
│         ); // gas savings                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         PairInfo storage pair = pairInfo;                                                                                                                                                                       │
│         uint256 _totalSupply = pair.totalSupply;                                                                                                                                                                │
│         amountNative = (liquidity * reserveNative) / _totalSupply;                                                                                                                                              │
│         amountForeign = (liquidity * reserveForeign) / _totalSupply;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             amountNative > 0 && amountForeign > 0,                                                                                                                                                              │
│             "VaderPoolV2::burnFungible: Insufficient Liquidity Burned"                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         pair.totalSupply = _totalSupply - liquidity;                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         nativeAsset.safeTransfer(to, amountNative);                                                                                                                                                             │
│         foreignAsset.safeTransfer(to, amountForeign);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _update(                                                                                                                                                                                                │
│             foreignAsset,                                                                                                                                                                                       │
│             reserveNative - amountNative,                                                                                                                                                                       │
│             reserveForeign - amountForeign,                                                                                                                                                                     │
│             reserveNative,                                                                                                                                                                                      │
│             reserveForeign                                                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit Burn(msg.sender, amountNative, amountForeign, to);                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function stake(uint256 amount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         notPaused                                                                                                                                                                                               │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot stake 0");                                                                                                                                                                  │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         stakingToken.safeTransferFrom(msg.sender, address(this), amount);                                                                                                                                       │
│         emit Staked(msg.sender, amount);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function stake(uint256 amount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         nonReentrant                                                                                                                                                                                            │
│         notPaused                                                                                                                                                                                               │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot stake 0");                                                                                                                                                                  │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         stakingToken.safeTransferFrom(msg.sender, address(this), amount);                                                                                                                                       │
│         emit Staked(msg.sender, amount);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETH(                                                                                                                                                                                │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256 amountToken, uint256 amountETH)                                                                                                                                                        │
│     {                                                                                                                                                                                                           │
│         (amountToken, amountETH) = removeLiquidity(                                                                                                                                                             │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(token, to, amountToken);                                                                                                                                                    │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForETHSupportingFeeOnTransferTokens(                                                                                                                                                │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) external virtual override ensure(deadline) {                                                                                                                                                              │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amountIn                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         _swapSupportingFeeOnTransferTokens(path, address(this));                                                                                                                                                │
│         uint256 amountOut = IERC20(WETH).balanceOf(address(this));                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             amountOut >= amountOutMin,                                                                                                                                                                          │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountOut);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountOut);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function swapExactTokensForETH(                                                                                                                                                                             │
│         uint256 amountIn,                                                                                                                                                                                       │
│         uint256 amountOutMin,                                                                                                                                                                                   │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256[] memory amounts)                                                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         amounts = UniswapV2Library.getAmountsOut(factory, amountIn, path);                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             amounts >= amountOutMin,                                                                                                                                                                            │
│             "UniswapV2Router: INSUFFICIENT_OUTPUT_AMOUNT"                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amounts[0]                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         _swap(amounts, path, address(this));                                                                                                                                                                    │
│         IWETH(WETH).withdraw(amounts);                                                                                                                                                                          │
│         TransferHelper.safeTransferETH(to, amounts);                                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function swapTokensForExactETH(                                                                                                                                                                             │
│         uint256 amountOut,                                                                                                                                                                                      │
│         uint256 amountInMax,                                                                                                                                                                                    │
│         address[] calldata path,                                                                                                                                                                                │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     )                                                                                                                                                                                                           │
│         external                                                                                                                                                                                                │
│         virtual                                                                                                                                                                                                 │
│         override                                                                                                                                                                                                │
│         ensure(deadline)                                                                                                                                                                                        │
│         returns (uint256[] memory amounts)                                                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         require(path == WETH, "UniswapV2Router: INVALID_PATH");                                                                                                                                                 │
│         amounts = UniswapV2Library.getAmountsIn(factory, amountOut, path);                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             amounts[0] <= amountInMax,                                                                                                                                                                          │
│             "UniswapV2Router: EXCESSIVE_INPUT_AMOUNT"                                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransferFrom(                                                                                                                                                                        │
│             path[0],                                                                                                                                                                                            │
│             msg.sender,                                                                                                                                                                                         │
│             UniswapV2Library.pairFor(factory, path[0], path[1]),                                                                                                                                                │
│             amounts[0]                                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│         _swap(amounts, path, address(this));                                                                                                                                                                    │
│         IWETH(WETH).withdraw(amounts);                                                                                                                                                                          │
│         TransferHelper.safeTransferETH(to, amounts);                                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function removeLiquidityETHSupportingFeeOnTransferTokens(                                                                                                                                                   │
│         address token,                                                                                                                                                                                          │
│         uint256 liquidity,                                                                                                                                                                                      │
│         uint256 amountTokenMin,                                                                                                                                                                                 │
│         uint256 amountETHMin,                                                                                                                                                                                   │
│         address to,                                                                                                                                                                                             │
│         uint256 deadline                                                                                                                                                                                        │
│     ) public virtual override ensure(deadline) returns (uint256 amountETH) {                                                                                                                                    │
│         (, amountETH) = removeLiquidity(                                                                                                                                                                        │
│             token,                                                                                                                                                                                              │
│             WETH,                                                                                                                                                                                               │
│             liquidity,                                                                                                                                                                                          │
│             amountTokenMin,                                                                                                                                                                                     │
│             amountETHMin,                                                                                                                                                                                       │
│             address(this),                                                                                                                                                                                      │
│             deadline                                                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         TransferHelper.safeTransfer(                                                                                                                                                                            │
│             token,                                                                                                                                                                                              │
│             to,                                                                                                                                                                                                 │
│             IERC20(token).balanceOf(address(this))                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IWETH(WETH).withdraw(amountETH);                                                                                                                                                                        │
│         TransferHelper.safeTransferETH(to, amountETH);                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 amount)                                                                                                                                                                           │
│         public                                                                                                                                                                                                  │
│         nonReentrant                                                                                                                                                                                            │
│         updateReward(msg.sender)                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         require(amount > 0, "Cannot withdraw 0");                                                                                                                                                               │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         _balances = _balances.sub(amount);                                                                                                                                                                      │
│         stakingToken.safeTransfer(msg.sender, amount);                                                                                                                                                          │
│         emit Withdrawn(msg.sender, amount);                                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ Code:                                                                                                                                                                                                           │
│     function notifyRewardAmount(uint256 reward)                                                                                                                                                                 │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         onlyRewardsDistribution                                                                                                                                                                                 │
│         updateReward(address(0))                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         if (block.timestamp >= periodFinish) {                                                                                                                                                                  │
│             rewardRate = reward.div(rewardsDuration);                                                                                                                                                           │
│         } else {                                                                                                                                                                                                │
│             uint256 remaining = periodFinish.sub(block.timestamp);                                                                                                                                              │
│             uint256 leftover = remaining.mul(rewardRate);                                                                                                                                                       │
│             rewardRate = reward.add(leftover).div(rewardsDuration);                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // Ensure the provided reward amount is not more than the balance in the contract.                                                                                                                      │
│         // This keeps the reward rate in the right range, preventing overflows due to                                                                                                                           │
│         // very high values of rewardRate in the earned and rewardsPerToken functions;                                                                                                                          │
│         // Reward + leftover must be less than 2^256 / 10^18 to avoid overflow.                                                                                                                                 │
│         uint256 balance = rewardsToken.balanceOf(address(this));                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             rewardRate <= balance.div(rewardsDuration),                                                                                                                                                         │
│             "Provided reward too high"                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lastUpdateTime = block.timestamp;                                                                                                                                                                       │
│         periodFinish = block.timestamp.add(rewardsDuration);                                                                                                                                                    │
│         emit RewardAdded(reward);                                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function notifyRewardAmount(uint256 reward)                                                                                                                                                                 │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         onlyRewardsDistribution                                                                                                                                                                                 │
│         updateReward(address(0))                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         if (block.timestamp >= periodFinish) {                                                                                                                                                                  │
│             rewardRate = reward.div(rewardsDuration);                                                                                                                                                           │
│         } else {                                                                                                                                                                                                │
│             uint256 remaining = periodFinish.sub(block.timestamp);                                                                                                                                              │
│             uint256 leftover = remaining.mul(rewardRate);                                                                                                                                                       │
│             rewardRate = reward.add(leftover).div(rewardsDuration);                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // Ensure the provided reward amount is not more than the balance in the contract.                                                                                                                      │
│         // This keeps the reward rate in the right range, preventing overflows due to                                                                                                                           │
│         // very high values of rewardRate in the earned and rewardsPerToken functions;                                                                                                                          │
│         // Reward + leftover must be less than 2^256 / 10^18 to avoid overflow.                                                                                                                                 │
│         uint256 balance = rewardsToken.balanceOf(address(this));                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             rewardRate <= balance.div(rewardsDuration),                                                                                                                                                         │
│             "Provided reward too high"                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lastUpdateTime = block.timestamp;                                                                                                                                                                       │
│         periodFinish = block.timestamp.add(rewardsDuration);                                                                                                                                                    │
│         emit RewardAdded(reward);                                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function adjust() private {                                                                                                                                                                                 │
│         uint blockCanAdjust = adjustment.lastBlock.add(adjustment.buffer);                                                                                                                                      │
│         if (adjustment.rate != 0 && block.number >= blockCanAdjust) {                                                                                                                                           │
│             uint initial = terms.controlVariable;                                                                                                                                                               │
│             if (adjustment.add) {                                                                                                                                                                               │
│                 terms.controlVariable = terms.controlVariable.add(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable >= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 terms.controlVariable = terms.controlVariable.sub(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable <= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             adjustment.lastBlock = block.number;                                                                                                                                                                │
│             emit ControlVariableAdjustment(initial, terms.controlVariable, adjustment.rate, adjustment.add);                                                                                                    │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function adjust() private {                                                                                                                                                                                 │
│         uint blockCanAdjust = adjustment.lastBlock.add(adjustment.buffer);                                                                                                                                      │
│         if (adjustment.rate != 0 && block.number >= blockCanAdjust) {                                                                                                                                           │
│             uint initial = terms.controlVariable;                                                                                                                                                               │
│             if (adjustment.add) {                                                                                                                                                                               │
│                 terms.controlVariable = terms.controlVariable.add(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable >= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 terms.controlVariable = terms.controlVariable.sub(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable <= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             adjustment.lastBlock = block.number;                                                                                                                                                                │
│             emit ControlVariableAdjustment(initial, terms.controlVariable, adjustment.rate, adjustment.add);                                                                                                    │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "y4"                                                                                                                                                                                          │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:44] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/math/VaderMath.sol, current      tasks.py:260
                             function: calculateSwapReverse, current vul: no-slippage-limit-check                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountADesired"                                                                                                                                                                            │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:260
                             function: addLiquidity, current vul: no-slippage-limit-check                                                                                                                          
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountIn"                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:45] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:260
                             function: calculateInGivenOut, current vul: no-slippage-limit-check                                                                                                                   
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountInMax"                                                                                                                                                                               │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:359
                             function: calculateInGivenOut, current vul: no-slippage-limit-check                                                                                                                   
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "nativeReserve": "Holds the native asset reserve in the pool",                                                                                                                                          │
│         "foreignReserve": "Holds the foreign asset reserve in the pool",                                                                                                                                        │
│         "amountOut": "Represents the output amount for the swap"                                                                                                                                                │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountIn": "Holds the calculated input amount for the swap"                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:46] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:260
                             function: calculateInGivenOut, current vul: price-manipulation                                                                                                                        
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 209, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the `validate_description` validation                                                                                             
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "amountIn": "Holds the calculated value of input token amount"                                                                                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountIn": "Holds the calculated value of input token amount"                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:47] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:359
                             function: calculateInGivenOut, current vul: price-manipulation                                                                                                                        
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "nativeReserve"                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/router/VaderRouter.sol, current  tasks.py:260
                             function: calculateOutGivenIn, current vul: no-slippage-limit-check                                                                                                                   
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalSupply": "Holds the value of total minted share or amount"                                                                                                                                        │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "totalLiquidityUnits": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "nativeDeposit": "Holds the value of the deposit/mint/add amount"                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:48] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:260
                             function: mint, current vul: first-deposit                                                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:260
                             function: mint, current vul: front-running                                                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "liquidity"                                                                                                                                                                                 │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:49] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:260
                             function: mint, current vul: no-slippage-limit-check                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountAMin"                                                                                                                                                                                │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:359
                             function: mint, current vul: no-slippage-limit-check                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidity": "Holds the value of total minted share or amount"                                                                                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "liquidity": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "amountA": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:52] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:359
                             function: mint, current vul: first-deposit                                                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountETHMin"                                                                                                                                                                              │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:359
                             function: mint, current vul: no-slippage-limit-check                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "foreignReserve"                                                                                                                                                                              │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:53] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:260
                             function: swap, current vul: no-slippage-limit-check                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "amountOut"}                                                                                                                                                                                   │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex/pool/BasePool.sol, current       tasks.py:359
                             function: swap, current vul: no-slippage-limit-check                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `cycleMints += uAmount;`.                                                                                                                        │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function mint(uint256 vAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 uAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 vPrice = lbt.getVaderPrice();                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         vader.transferFrom(msg.sender, address(this), vAmount);                                                                                                                                                 │
│         vader.burn(vAmount);                                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uAmount = (vPrice * vAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (cycleTimestamp <= block.timestamp) {                                                                                                                                                                │
│             cycleTimestamp = block.timestamp + 24 hours;                                                                                                                                                        │
│             cycleMints = uAmount;                                                                                                                                                                               │
│         } else {                                                                                                                                                                                                │
│             cycleMints += uAmount;                                                                                                                                                                              │
│             require(                                                                                                                                                                                            │
│                 cycleMints <= dailyLimit,                                                                                                                                                                       │
│                 "USDV::mint: 24 Hour Limit Reached"                                                                                                                                                             │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (uAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             uAmount = uAmount - fee;                                                                                                                                                                            │
│             _mint(owner(), fee);                                                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _mint(address(this), uAmount);                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.USDV, uAmount);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uAmount = (vPrice * vAmount) / 1e18;`                                                                                                                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:54] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/tokens/USDV.sol, current function:   tasks.py:260
                             mint, current vul: wrong-order-interest                                                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `uint256 uPrice = lbt.getUSDVPrice();`.                                                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function burn(uint256 uAmount)                                                                                                                                                                              │
│         external                                                                                                                                                                                                │
│         onlyWhenNotLocked                                                                                                                                                                                       │
│         returns (uint256 vAmount)                                                                                                                                                                               │
│     {                                                                                                                                                                                                           │
│         uint256 uPrice = lbt.getUSDVPrice();                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _burn(msg.sender, uAmount);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         vAmount = (uPrice * uAmount) / 1e18;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (exchangeFee != 0) {                                                                                                                                                                                 │
│             uint256 fee = (vAmount * exchangeFee) / _MAX_BASIS_POINTS;                                                                                                                                          │
│             vAmount = vAmount - fee;                                                                                                                                                                            │
│             vader.mint(owner(), fee);                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         vader.mint(address(this), vAmount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         _createLock(LockTypes.VADER, vAmount);                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `vAmount = (uPrice * uAmount) / 1e18;`                                                                                                                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:55] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/tokens/USDV.sol, current function:   tasks.py:260
                             burn, current vul: wrong-order-interest                                                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function convert(bytes32[] calldata proof, uint256 amount, uint256 minVader)                                                                                                                                │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (uint256 vaderReceived)                                                                                                                                                                         │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             amount != 0,                                                                                                                                                                                        │
│             "Converter::convert: Non-Zero Conversion Amount Required"                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         ILinearVesting _vesting = vesting;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _vesting != ILinearVesting(_ZERO_ADDRESS),                                                                                                                                                          │
│             "Converter::convert: Vesting is not set"                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bytes32 leaf = keccak256(                                                                                                                                                                               │
│             abi.encodePacked(msg.sender, amount, salt, getChainId())                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             !claimed && proof.verify(root, leaf),                                                                                                                                                               │
│             "Converter::convert: Incorrect Proof Provided"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         claimed = true;                                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 allowance = vether.allowance(msg.sender, address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         amount = amount > allowance ? allowance : amount;                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: FoT is ignored as units are meant to be burned anyway                                                                                                                                          │
│         vether.transferFrom(msg.sender, _BURN, amount);                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;                                                                                                                                                 │
│         require(vaderReceived >= minVader, "Converter::convert: Vader < min");                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Conversion(msg.sender, amount, vaderReceived);                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 half = vaderReceived / 2;                                                                                                                                                                       │
│         vader.transfer(msg.sender, half);                                                                                                                                                                       │
│         _vesting.vestFor(msg.sender, vaderReceived - half);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;`.                                                                                       │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function convert(bytes32[] calldata proof, uint256 amount, uint256 minVader)                                                                                                                                │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         returns (uint256 vaderReceived)                                                                                                                                                                         │
│     {                                                                                                                                                                                                           │
│         require(                                                                                                                                                                                                │
│             amount != 0,                                                                                                                                                                                        │
│             "Converter::convert: Non-Zero Conversion Amount Required"                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         ILinearVesting _vesting = vesting;                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _vesting != ILinearVesting(_ZERO_ADDRESS),                                                                                                                                                          │
│             "Converter::convert: Vesting is not set"                                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         bytes32 leaf = keccak256(                                                                                                                                                                               │
│             abi.encodePacked(msg.sender, amount, salt, getChainId())                                                                                                                                            │
│         );                                                                                                                                                                                                      │
│         require(                                                                                                                                                                                                │
│             !claimed && proof.verify(root, leaf),                                                                                                                                                               │
│             "Converter::convert: Incorrect Proof Provided"                                                                                                                                                      │
│         );                                                                                                                                                                                                      │
│         claimed = true;                                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 allowance = vether.allowance(msg.sender, address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         amount = amount > allowance ? allowance : amount;                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // NOTE: FoT is ignored as units are meant to be burned anyway                                                                                                                                          │
│         vether.transferFrom(msg.sender, _BURN, amount);                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;                                                                                                                                                 │
│         require(vaderReceived >= minVader, "Converter::convert: Vader < min");                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         emit Conversion(msg.sender, amount, vaderReceived);                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 half = vaderReceived / 2;                                                                                                                                                                       │
│         vader.transfer(msg.sender, half);                                                                                                                                                                       │
│         _vesting.vestFor(msg.sender, vaderReceived - half);                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `vaderReceived = amount * _VADER_VETHER_CONVERSION_RATE;`                                                                                                                                                       │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:56] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/tokens/converter/Converter.sol,      tasks.py:260
                             current function: convert, current vul: wrong-order-interest                                                                                                                          
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalVader": "Holds the amount of vader locked in the contract",                                                                                                                                       │
│         "totalShares": "Holds the amount of xVader in existence"                                                                                                                                                │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "xVADERToMint": "Holds the calculated amount of xVADER tokens to mint"                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:57] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/x-vader/XVader.sol, current          tasks.py:260
                             function: enter, current vul: price-manipulation                                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "xVADERToMint": "Holds the value of total minted share or amount"                                                                                                                                       │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "totalShares": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:58] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/x-vader/XVader.sol, current          tasks.py:260
                             function: enter, current vul: first-deposit                                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "reserveA, reserveB": "Market reserves"                                                                                                                                                                 │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountA, amountB": "Calculated value/price of LP token"                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:30:59] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:260
                             current function: _addLiquidity, current vul: price-manipulation                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "pair": "Holds the address of the pair contract for tokenA and tokenB"                                                                                                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "liquidity": "Holds the calculated liquidity value"                                                                                                                                                     │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: _addLiquidity, current vul: price-manipulation                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "pool": "Holds the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation"                                                                        │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "liquidity": "Holds the calculated value/price of LP token"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:00] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: _addLiquidity, current vul: price-manipulation                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "amountETHMin"                                                                                                                                                                                │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:01] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:260
                             current function: removeLiquidityETH, current vul: no-slippage-limit-check                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "value"                                                                                                                                                                                       │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: removeLiquidityETH, current vul: no-slippage-limit-check                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "amountETHMin"}                                                                                                                                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:260
                             current function: removeLiquidityETHSupportingFeeOnTransferTokens, current vul: no-slippage-limit-check                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "value"}                                                                                                                                                                                       │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:02] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: removeLiquidityETHSupportingFeeOnTransferTokens, current vul: no-slippage-limit-check                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "msg.sender": "Holds the sender's address of transfer"                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:260
                             current function: removeLiquidityETHWithPermitSupportingFeeOnTransferTokens, current vul: unauthorized-transfer                                                                       
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 220, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the `exclude_variable` validation                                                                                                 
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "reserve0": "Holds the reserve of token0 in the Uniswap pair",                                                                                                                                              │
│     "reserve1": "Holds the reserve of token1 in the Uniswap pair",                                                                                                                                              │
│     "reserveInput": "Holds the reserve of the input token in the Uniswap pair",                                                                                                                                 │
│     "reserveOutput": "Holds the reserve of the output token in the Uniswap pair",                                                                                                                               │
│     "amountInput": "Holds the calculated input amount for the swap",                                                                                                                                            │
│     "amountOutput": "Holds the calculated output amount for the swap"                                                                                                                                           │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "to": "Holds the address where the swapped tokens are sent"                                                                                                                                                 │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:04] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:260
                             current function: _swapSupportingFeeOnTransferTokens, current vul: price-manipulation                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 209, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the `validate_description` validation                                                                                             
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "balanceBefore": "Variable to hold the balance of the custom token before the swap"                                                                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountIn": "Variable to hold the amount of ETH being swapped for tokens"                                                                                                                               │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: _swapSupportingFeeOnTransferTokens, current vul: price-manipulation                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "balanceBefore": "Variable to hold the balance of the token 'to' before the swap"                                                                                                                       │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "balanceBefore": "Variable to hold the balance of the token 'to' before the swap"                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:05] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: _swapSupportingFeeOnTransferTokens, current vul: price-manipulation                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "amountIn": "Variable holding the amount of tokens to swap"                                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountOut": "Variable holding the calculated value/price of LP token"                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:06] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/mocks/MockUniswapV2Router.sol,       tasks.py:359
                             current function: _swapSupportingFeeOnTransferTokens, current vul: price-manipulation                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `currentLiquidityEvaluation = _updateVaderPrice(pair, pairData, timeElapsed);`.                                                                  │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function syncVaderPrice()                                                                                                                                                                                   │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = vaderPairs.length;                                                                                                                                                                 │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IUniswapV2Pair pair = vaderPairs;                                                                                                                                                                   │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateVaderPrice(                                                                                                                                             │
│                 pair,                                                                                                                                                                                           │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward is `pastLiquidityWeights = new uint256[](totalPairs);`.                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:07] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:260
                             function: syncVaderPrice, current vul: wrong-order-interest                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "reserve0": "Holds the reserve of token0 in the Uniswap pair",                                                                                                                                          │
│         "reserve1": "Holds the reserve of token1 in the Uniswap pair",                                                                                                                                          │
│         "reserveNative": "Holds the reserve of the native token in the Uniswap pair",                                                                                                                           │
│         "reserveForeign": "Holds the reserve of the foreign token in the Uniswap pair",                                                                                                                         │
│         "price0Cumulative": "Holds the cumulative price of token0",                                                                                                                                             │
│         "price1Cumulative": "Holds the cumulative price of token1",                                                                                                                                             │
│         "currentMeasurement": "Holds the current measurement value"                                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "currentLiquidityEvaluation": "Holds the calculated value of LP token price"                                                                                                                            │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:09] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:260
                             function: _updateVaderPrice, current vul: price-manipulation                                                                                                                          
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalLiquidityWeight": "Holds the market reserves/AMM price/exchange rate calculation"                                                                                                                 │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_totalLiquidityWeight": "Holds the calculated value/price of LP token"                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:10] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:359
                             function: _updateVaderPrice, current vul: price-manipulation                                                                                                                          
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `pastTotalLiquidityWeight = totalLiquidityWeight;`.                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function syncUSDVPrice()                                                                                                                                                                                    │
│         public                                                                                                                                                                                                  │
│         override                                                                                                                                                                                                │
│         returns (                                                                                                                                                                                               │
│             uint256[] memory pastLiquidityWeights,                                                                                                                                                              │
│             uint256 pastTotalLiquidityWeight                                                                                                                                                                    │
│         )                                                                                                                                                                                                       │
│     {                                                                                                                                                                                                           │
│         uint256 _totalLiquidityWeight;                                                                                                                                                                          │
│         uint256 totalPairs = usdvPairs.length;                                                                                                                                                                  │
│         pastLiquidityWeights = new uint256[](totalPairs);                                                                                                                                                       │
│         pastTotalLiquidityWeight = totalLiquidityWeight;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         for (uint256 i; i < totalPairs; ++i) {                                                                                                                                                                  │
│             IERC20 foreignAsset = usdvPairs;                                                                                                                                                                    │
│             ExchangePair storage pairData = twapData;                                                                                                                                                           │
│             uint256 timeElapsed = block.timestamp - pairData.lastMeasurement;                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (timeElapsed < pairData.updatePeriod) continue;                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             uint256 pastLiquidityEvaluation = pairData.pastLiquidityEvaluation;                                                                                                                                 │
│             uint256 currentLiquidityEvaluation = _updateUSDVPrice(                                                                                                                                              │
│                 foreignAsset,                                                                                                                                                                                   │
│                 pairData,                                                                                                                                                                                       │
│                 timeElapsed                                                                                                                                                                                     │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             pastLiquidityWeights = pastLiquidityEvaluation;                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│             pairData.pastLiquidityEvaluation = currentLiquidityEvaluation;                                                                                                                                      │
│                                                                                                                                                                                                                 │
│             _totalLiquidityWeight += currentLiquidityEvaluation;                                                                                                                                                │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         totalLiquidityWeight = _totalLiquidityWeight;                                                                                                                                                           │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward is `pastLiquidityWeights = pastLiquidityEvaluation;`.                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:11] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:260
                             function: syncUSDVPrice, current vul: wrong-order-interest                                                                                                                            
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "reserveNative": "Holds the market reserves of the native asset",                                                                                                                                       │
│         "reserveForeign": "Holds the market reserves of the foreign asset",                                                                                                                                     │
│         "currentMeasurement": "Holds the current measurement value"                                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "currentLiquidityEvaluation": "Holds the calculated value/price of LP token"                                                                                                                            │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:12] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:260
                             function: _updateUSDVPrice, current vul: price-manipulation                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalLiquidityWeight": "Holds the market reserves/AMM price/exchange rate calculation"                                                                                                                 │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_totalLiquidityWeight": "Holds the calculated value/price of LP token"                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:13] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/lbt/LiquidityBasedTWAP.sol, current  tasks.py:359
                             function: _updateUSDVPrice, current vul: price-manipulation                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "nativeDeposit"                                                                                                                                                                               │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/router/VaderRouterV2.sol,     tasks.py:260
                             current function: addLiquidity, current vul: no-slippage-limit-check                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "amountAMin"                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:14] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/router/VaderRouterV2.sol,     tasks.py:260
                             current function: removeLiquidity, current vul: no-slippage-limit-check                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "amountETHMin"}                                                                                                                                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/router/VaderRouterV2.sol,     tasks.py:359
                             current function: removeLiquidity, current vul: no-slippage-limit-check                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "amountAMin"                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:15] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/router/VaderRouterV2.sol,     tasks.py:359
                             current function: removeLiquidity, current vul: no-slippage-limit-check                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "amountETHMin"}                                                                                                                                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/router/VaderRouterV2.sol,     tasks.py:359
                             current function: removeLiquidity, current vul: no-slippage-limit-check                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidity": "Variable holding the liquidity amount for a specific position"                                                                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountNative": "Variable holding the calculated value of native asset to be transferred"                                                                                                               │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:16] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:260
                             function: _burn, current vul: price-manipulation                                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "uPrice": "Holds the market price of the LP token in USD"                                                                                                                                               │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "vAmount": "Holds the calculated value of LP tokens to be minted"                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:17] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _burn, current vul: price-manipulation                                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "liquidity"                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:260
                             function: _mint, current vul: no-slippage-limit-check                                                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidity": "Holds the value of total minted share or amount"                                                                                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "pair.totalSupply": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "nativeDeposit": "Holds the value of the deposit/mint/add amount"                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:18] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:260
                             function: _mint, current vul: first-deposit                                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidity": "Holds the value of total minted share or amount"                                                                                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "pair.totalSupply": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "nativeDeposit": "Holds the value of the deposit/mint/add amount"                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:19] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _mint, current vul: first-deposit                                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "liquidity"                                                                                                                                                                                 │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:20] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _mint, current vul: no-slippage-limit-check                                                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "dailyLimit"}                                                                                                                                                                                  │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _mint, current vul: no-slippage-limit-check                                                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "reserveNative": "Holds the market reserves for the native asset",                                                                                                                                      │
│         "reserveForeign": "Holds the market reserves for the foreign asset",                                                                                                                                    │
│         "totalLiquidityUnits": "Holds the total supply of liquidity units"                                                                                                                                      │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "liquidity": "Holds the calculated value of LP token"                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:21] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:260
                             function: _mint, current vul: price-manipulation                                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "vPrice": "Holds the market price of Vader token obtained from lbt.getVaderPrice()"                                                                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "uAmount": "Holds the calculated value of LP token to be minted"                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:22] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _mint, current vul: price-manipulation                                                                                                                                      
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "totalShares"}                                                                                                                                                                                 │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/BasePoolV2.sol, current  tasks.py:359
                             function: _mint, current vul: no-slippage-limit-check                                                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 355, in simple_cli                                                                                       
                                 falcon_instance, function2_text)                                                                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableName": "amountSynth"                                                                                                                                                                               │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:23] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/VaderPoolV2.sol, current tasks.py:260
                             function: mintSynth, current vul: no-slippage-limit-check                                                                                                                             
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {"VariableName": "synthAmount"}                                                                                                                                                                                 │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/VaderPoolV2.sol, current tasks.py:260
                             function: burnSynth, current vul: no-slippage-limit-check                                                                                                                             
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "reserveNative": "Variable holding the market reserves/AMM price/exchange rate"                                                                                                                         │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amountNative": "Variable holding the calculated value/price of LP token"                                                                                                                               │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:24] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/VaderPoolV2.sol, current tasks.py:260
                             function: burnSynth, current vul: price-manipulation                                                                                                                                  
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableName": "liquidity"                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                    ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/VaderPoolV2.sol, current tasks.py:260
                             function: mintFungible, current vul: no-slippage-limit-check                                                                                                                          
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidity": "Holds the value of total minted share or amount"                                                                                                                                          │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "pair.totalSupply": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "nativeDeposit, foreignDeposit": "Holds the value of the deposit/mint/add amount"                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:25] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/dex-v2/pool/VaderPoolV2.sol, current tasks.py:260
                             function: mintFungible, current vul: first-deposit                                                                                                                                    
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function notifyRewardAmount(uint256 reward)                                                                                                                                                                 │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         onlyRewardsDistribution                                                                                                                                                                                 │
│         updateReward(address(0))                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         if (block.timestamp >= periodFinish) {                                                                                                                                                                  │
│             rewardRate = reward.div(rewardsDuration);                                                                                                                                                           │
│         } else {                                                                                                                                                                                                │
│             uint256 remaining = periodFinish.sub(block.timestamp);                                                                                                                                              │
│             uint256 leftover = remaining.mul(rewardRate);                                                                                                                                                       │
│             rewardRate = reward.add(leftover).div(rewardsDuration);                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // Ensure the provided reward amount is not more than the balance in the contract.                                                                                                                      │
│         // This keeps the reward rate in the right range, preventing overflows due to                                                                                                                           │
│         // very high values of rewardRate in the earned and rewardsPerToken functions;                                                                                                                          │
│         // Reward + leftover must be less than 2^256 / 10^18 to avoid overflow.                                                                                                                                 │
│         uint256 balance = rewardsToken.balanceOf(address(this));                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             rewardRate <= balance.div(rewardsDuration),                                                                                                                                                         │
│             "Provided reward too high"                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lastUpdateTime = block.timestamp;                                                                                                                                                                       │
│         periodFinish = block.timestamp.add(rewardsDuration);                                                                                                                                                    │
│         emit RewardAdded(reward);                                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `rewardRate = reward.div(rewardsDuration);`.                                                                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function notifyRewardAmount(uint256 reward)                                                                                                                                                                 │
│         external                                                                                                                                                                                                │
│         override                                                                                                                                                                                                │
│         onlyRewardsDistribution                                                                                                                                                                                 │
│         updateReward(address(0))                                                                                                                                                                                │
│     {                                                                                                                                                                                                           │
│         if (block.timestamp >= periodFinish) {                                                                                                                                                                  │
│             rewardRate = reward.div(rewardsDuration);                                                                                                                                                           │
│         } else {                                                                                                                                                                                                │
│             uint256 remaining = periodFinish.sub(block.timestamp);                                                                                                                                              │
│             uint256 leftover = remaining.mul(rewardRate);                                                                                                                                                       │
│             rewardRate = reward.add(leftover).div(rewardsDuration);                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // Ensure the provided reward amount is not more than the balance in the contract.                                                                                                                      │
│         // This keeps the reward rate in the right range, preventing overflows due to                                                                                                                           │
│         // very high values of rewardRate in the earned and rewardsPerToken functions;                                                                                                                          │
│         // Reward + leftover must be less than 2^256 / 10^18 to avoid overflow.                                                                                                                                 │
│         uint256 balance = rewardsToken.balanceOf(address(this));                                                                                                                                                │
│         require(                                                                                                                                                                                                │
│             rewardRate <= balance.div(rewardsDuration),                                                                                                                                                         │
│             "Provided reward too high"                                                                                                                                                                          │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         lastUpdateTime = block.timestamp;                                                                                                                                                                       │
│         periodFinish = block.timestamp.add(rewardsDuration);                                                                                                                                                    │
│         emit RewardAdded(reward);                                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `rewardRate = reward.div(rewardsDuration);`                                                                                                                                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:26] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/contracts/staking-rewards/StakingRewards.sol,  tasks.py:260
                             current function: notifyRewardAmount, current vul: wrong-order-interest                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function adjust() private {                                                                                                                                                                                 │
│         uint blockCanAdjust = adjustment.lastBlock.add(adjustment.buffer);                                                                                                                                      │
│         if (adjustment.rate != 0 && block.number >= blockCanAdjust) {                                                                                                                                           │
│             uint initial = terms.controlVariable;                                                                                                                                                               │
│             if (adjustment.add) {                                                                                                                                                                               │
│                 terms.controlVariable = terms.controlVariable.add(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable >= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 terms.controlVariable = terms.controlVariable.sub(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable <= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             adjustment.lastBlock = block.number;                                                                                                                                                                │
│             emit ControlVariableAdjustment(initial, terms.controlVariable, adjustment.rate, adjustment.add);                                                                                                    │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `terms.controlVariable = terms.controlVariable.add(adjustment.rate);`.                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function adjust() private {                                                                                                                                                                                 │
│         uint blockCanAdjust = adjustment.lastBlock.add(adjustment.buffer);                                                                                                                                      │
│         if (adjustment.rate != 0 && block.number >= blockCanAdjust) {                                                                                                                                           │
│             uint initial = terms.controlVariable;                                                                                                                                                               │
│             if (adjustment.add) {                                                                                                                                                                               │
│                 terms.controlVariable = terms.controlVariable.add(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable >= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             } else {                                                                                                                                                                                            │
│                 terms.controlVariable = terms.controlVariable.sub(adjustment.rate);                                                                                                                             │
│                 if (terms.controlVariable <= adjustment.target) {                                                                                                                                               │
│                     adjustment.rate = 0;                                                                                                                                                                        │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             adjustment.lastBlock = block.number;                                                                                                                                                                │
│             emit ControlVariableAdjustment(initial, terms.controlVariable, adjustment.rate, adjustment.add);                                                                                                    │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `terms.controlVariable = terms.controlVariable.add(adjustment.rate);`                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:31:27] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-vader-main/repo/vader-bond/contracts/VaderBond.sol,       tasks.py:260
                             current function: adjust, current vul: wrong-order-interest                                                                                                                           
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 254, in simple_cli                                                                                       
                                 res_1 = static_check.run_static_check(checker, args, function1, falcon_instance,                                                                                                  
                             UnboundLocalError: local variable 'falcon_instance' referenced before assignment                                                                                                      
                                                                                                                                                                                                                   
                      Scan Results                       
┏━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Type ┃ Description ┃ Affected Files ┃ Analysis Report ┃
┡━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
└──────┴─────────────┴────────────────┴─────────────────┘
                   Summary                   
┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━┓
┃ Key                  ┃ Value              ┃
┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━┩
│ Files                │ 68                 │
│ Contracts            │ 68                 │
│ Functions            │ 110                │
│ Lines of Code        │ 8689               │
│ Used Time            │ 122.00563645362854 │
│ Estimated Cost (USD) │ 0.1661705          │
└──────────────────────┴────────────────────┘
