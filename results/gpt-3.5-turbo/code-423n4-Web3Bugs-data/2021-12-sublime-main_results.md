

  .oooooo.    ooooooooo.   ooooooooooooo  .oooooo..o                                 
 d8P'  `Y8b   `888   `Y88. 8'   888   `8 d8P'    `Y8                                 
888            888   .d88'      888      Y88bo.       .ooooo.   .oooo.   ooo. .oo.   
888            888ooo88P'       888       `"Y8888o.  d88' `"Y8 `P  )88b  `888P"Y88b  
888     ooooo  888              888           `"Y88b 888        .oP"888   888   888  
`88.    .88'   888              888      oo     .d8P 888   .o8 d8(  888   888   888  
 `Y8bood8P'   o888o            o888o     8""88888P'  `Y8bod8P' `Y888""8o o888o o888o                                                        


                                                                   

[19:25:28] Loaded 10 rules                                                                                                                                                                             tasks.py:119
[12/08/24 19:25:28] INFO     CryticCompile: 'npx hardhat clean' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main)              subprocess.py:41
[12/08/24 19:25:31] INFO     CryticCompile: 'npx hardhat clean --global' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main)     subprocess.py:41
[12/08/24 19:25:36] INFO     CryticCompile: Problem executing hardhat: (node:128424) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.   hardhat.py:327
                             (Use `node --trace-deprecation ...` to show where the warning was created)                                                                                                            
                             (node:128450) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.                                                           
                             (Use `node --trace-deprecation ...` to show where the warning was created)                                                                                                            
                                                                                                                                                                                                                   
                    INFO     CryticCompile: 'npx hardhat compile --force' running (wd: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main)    subprocess.py:41
[12/08/24 19:25:50] ERROR    ContractSolcParsing: Impossible to generate IR for PoolFactory._createPool:                                                                                            contract.py:392
                              'CompilationUnit' object has no attribute 'bytecode_init'                                                                                                                            
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function initialize(                                                                                                                                                                                        │
│         address _defaultStrategy,                                                                                                                                                                               │
│         address _priceOracle,                                                                                                                                                                                   │
│         address _savingsAccount,                                                                                                                                                                                │
│         address _strategyRegistry,                                                                                                                                                                              │
│         address _owner,                                                                                                                                                                                         │
│         uint256 _protocolFeeFraction,                                                                                                                                                                           │
│         address _protocolFeeCollector,                                                                                                                                                                          │
│         uint256 _liquidatorRewardFraction                                                                                                                                                                       │
│     ) external initializer {                                                                                                                                                                                    │
│         OwnableUpgradeable.__Ownable_init();                                                                                                                                                                    │
│         OwnableUpgradeable.transferOwnership(_owner);                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         _updateDefaultStrategy(_defaultStrategy);                                                                                                                                                               │
│         _updatePriceOracle(_priceOracle);                                                                                                                                                                       │
│         _updateSavingsAccount(_savingsAccount);                                                                                                                                                                 │
│         _updateStrategyRegistry(_strategyRegistry);                                                                                                                                                             │
│         _updateProtocolFeeFraction(_protocolFeeFraction);                                                                                                                                                       │
│         _updateProtocolFeeCollector(_protocolFeeCollector);                                                                                                                                                     │
│         _updateLiquidatorRewardFraction(_liquidatorRewardFraction);                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _updateStrategyRegistry(address _strategyRegistry) internal {                                                                                                                                      │
│         require(_strategyRegistry != address(0), 'CL::I zero address');                                                                                                                                         │
│         strategyRegistry = _strategyRegistry;                                                                                                                                                                   │
│         emit StrategyRegistryUpdated(_strategyRegistry);                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterest(                                                                                                                                                                                 │
│         uint256 _principal,                                                                                                                                                                                     │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         uint256 _timeElapsed                                                                                                                                                                                    │
│     ) public pure returns (uint256) {                                                                                                                                                                           │
│         uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);                                                                                                     │
│                                                                                                                                                                                                                 │
│         return _interest;                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterest(                                                                                                                                                                                 │
│         uint256 _principal,                                                                                                                                                                                     │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         uint256 _timeElapsed                                                                                                                                                                                    │
│     ) public pure returns (uint256) {                                                                                                                                                                           │
│         uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);                                                                                                     │
│                                                                                                                                                                                                                 │
│         return _interest;                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterestAccrued(uint256 _id) public view returns (uint256) {                                                                                                                              │
│         uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;                                                                                                                    │
│         if (_lastPrincipalUpdateTime == 0) return 0;                                                                                                                                                            │
│         uint256 _timeElapsed = (block.timestamp).sub(_lastPrincipalUpdateTime);                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterest(creditLineVariables[_id].principal, creditLineConstants[_id].borrowRate, _timeElapsed);                                                                    │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterestAccrued(uint256 _id) public view returns (uint256) {                                                                                                                              │
│         uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;                                                                                                                    │
│         if (_lastPrincipalUpdateTime == 0) return 0;                                                                                                                                                            │
│         uint256 _timeElapsed = (block.timestamp).sub(_lastPrincipalUpdateTime);                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterest(creditLineVariables[_id].principal, creditLineConstants[_id].borrowRate, _timeElapsed);                                                                    │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateCurrentDebt(uint256 _id) public view returns (uint256) {                                                                                                                                  │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _currentDebt = (creditLineVariables[_id].principal)                                                                                                                                             │
│             .add(creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate)                                                                                                                               │
│             .add(_interestAccrued)                                                                                                                                                                              │
│             .sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                                                                 │
│         return _currentDebt;                                                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function calculateCurrentDebt(uint256 _id) public view returns (uint256) {                                                                                                                                  │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _currentDebt = (creditLineVariables[_id].principal)                                                                                                                                             │
│             .add(creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate)                                                                                                                               │
│             .add(_interestAccrued)                                                                                                                                                                              │
│             .sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                                                                 │
│         return _currentDebt;                                                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function updateinterestAccruedTillLastPrincipalUpdate(uint256 _id) internal {                                                                                                                               │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _newInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(_interestAccrued);                                                                                  │
│         creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _newInterestAccrued;                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function updateinterestAccruedTillLastPrincipalUpdate(uint256 _id) internal {                                                                                                                               │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _newInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(_interestAccrued);                                                                                  │
│         creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _newInterestAccrued;                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function request(                                                                                                                                                                                           │
│         address _requestTo,                                                                                                                                                                                     │
│         uint256 _borrowLimit,                                                                                                                                                                                   │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         bool _autoLiquidation,                                                                                                                                                                                  │
│         uint256 _collateralRatio,                                                                                                                                                                               │
│         address _borrowAsset,                                                                                                                                                                                   │
│         address _collateralAsset,                                                                                                                                                                               │
│         bool _requestAsLender                                                                                                                                                                                   │
│     ) external returns (uint256) {                                                                                                                                                                              │
│         require(_borrowAsset != _collateralAsset, 'R: cant borrow lent token');                                                                                                                                 │
│         require(IPriceOracle(priceOracle).doesFeedExist(_borrowAsset, _collateralAsset), 'R: No price feed');                                                                                                   │
│                                                                                                                                                                                                                 │
│         address _lender = _requestTo;                                                                                                                                                                           │
│         address _borrower = msg.sender;                                                                                                                                                                         │
│         if (_requestAsLender) {                                                                                                                                                                                 │
│             _lender = msg.sender;                                                                                                                                                                               │
│             _borrower = _requestTo;                                                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _id = _createRequest(                                                                                                                                                                           │
│             _lender,                                                                                                                                                                                            │
│             _borrower,                                                                                                                                                                                          │
│             _borrowLimit,                                                                                                                                                                                       │
│             _borrowRate,                                                                                                                                                                                        │
│             _autoLiquidation,                                                                                                                                                                                   │
│             _collateralRatio,                                                                                                                                                                                   │
│             _borrowAsset,                                                                                                                                                                                       │
│             _collateralAsset,                                                                                                                                                                                   │
│             _requestAsLender                                                                                                                                                                                    │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         emit CreditLineRequested(_id, _lender, _borrower);                                                                                                                                                      │
│         return _id;                                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _createRequest(                                                                                                                                                                                    │
│         address _lender,                                                                                                                                                                                        │
│         address _borrower,                                                                                                                                                                                      │
│         uint256 _borrowLimit,                                                                                                                                                                                   │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         bool _autoLiquidation,                                                                                                                                                                                  │
│         uint256 _collateralRatio,                                                                                                                                                                               │
│         address _borrowAsset,                                                                                                                                                                                   │
│         address _collateralAsset,                                                                                                                                                                               │
│         bool _requestByLender                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         require(_lender != _borrower, 'Lender and Borrower cannot be same addresses');                                                                                                                          │
│         uint256 _id = creditLineCounter + 1;                                                                                                                                                                    │
│         creditLineCounter = _id;                                                                                                                                                                                │
│         creditLineVariables[_id].status = CreditLineStatus.REQUESTED;                                                                                                                                           │
│         creditLineConstants[_id].borrower = _borrower;                                                                                                                                                          │
│         creditLineConstants[_id].lender = _lender;                                                                                                                                                              │
│         creditLineConstants[_id].borrowLimit = _borrowLimit;                                                                                                                                                    │
│         creditLineConstants[_id].autoLiquidation = _autoLiquidation;                                                                                                                                            │
│         creditLineConstants[_id].idealCollateralRatio = _collateralRatio;                                                                                                                                       │
│         creditLineConstants[_id].borrowRate = _borrowRate;                                                                                                                                                      │
│         creditLineConstants[_id].borrowAsset = _borrowAsset;                                                                                                                                                    │
│         creditLineConstants[_id].collateralAsset = _collateralAsset;                                                                                                                                            │
│         creditLineConstants[_id].requestByLender = _requestByLender;                                                                                                                                            │
│         return _id;                                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function depositCollateral(                                                                                                                                                                                 │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy,                                                                                                                                                                                      │
│         bool _fromSavingsAccount                                                                                                                                                                                │
│     ) external payable nonReentrant ifCreditLineExists(_id) {                                                                                                                                                   │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine not active');                                                                                                           │
│         _depositCollateral(_id, _amount, _strategy, _fromSavingsAccount);                                                                                                                                       │
│         emit CollateralDeposited(_id, _amount, _strategy);                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateral(                                                                                                                                                                                │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy,                                                                                                                                                                                      │
│         bool _fromSavingsAccount                                                                                                                                                                                │
│     ) internal {                                                                                                                                                                                                │
│         require(creditLineConstants[_id].lender != msg.sender, 'lender cant deposit collateral');                                                                                                               │
│         if (_fromSavingsAccount) {                                                                                                                                                                              │
│             _depositCollateralFromSavingsAccount(_id, _amount, msg.sender);                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                │
│             ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                  │
│             if (_collateralAsset == address(0)) {                                                                                                                                                               │
│                 require(msg.value == _amount, "CreditLine::_depositCollateral - value to transfer doesn't match argument");                                                                                     │
│             } else {                                                                                                                                                                                            │
│                 IERC20(_collateralAsset).safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                  │
│                 IERC20(_collateralAsset).approve(_strategy, _amount);                                                                                                                                           │
│             }                                                                                                                                                                                                   │
│             uint256 _sharesReceived = _savingsAccount.deposit{value: msg.value}(_amount, _collateralAsset, _strategy, address(this));                                                                           │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(_sharesReceived);                                                                                         │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawBorrowAmount(                                                                                                                                                                             │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_lender, _asset, _strategyList[_index]);                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 tokenInStrategy = _liquidityShares;                                                                                                                                                     │
│                 tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                   │
│                 uint256 _tokensToTransfer = tokenInStrategy;                                                                                                                                                    │
│                 if (_activeAmount.add(tokenInStrategy) >= _amountInTokens) {                                                                                                                                    │
│                     _tokensToTransfer = (_amountInTokens.sub(_activeAmount));                                                                                                                                   │
│                 }                                                                                                                                                                                               │
│                 _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                           │
│                 _savingsAccount.withdrawFrom(_tokensToTransfer, _asset, _strategyList[_index], _lender, address(this), false);                                                                                  │
│                 if (_activeAmount == _amountInTokens) {                                                                                                                                                         │
│                     return;                                                                                                                                                                                     │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         require(_activeAmount == _amountInTokens, 'insufficient balance');                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ Code:                                                                                                                                                                                                           │
│     function borrow(uint256 _id, uint256 _amount) external payable nonReentrant onlyCreditLineBorrower(_id) {                                                                                                   │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         uint256 _borrowableAmount = calculateBorrowableAmount(_id);                                                                                                                                             │
│         require(_amount <= _borrowableAmount, "CreditLine::borrow - The current collateral ratio doesn't allow to withdraw the amount");                                                                        │
│         address _borrowAsset = creditLineConstants[_id].borrowAsset;                                                                                                                                            │
│         address _lender = creditLineConstants[_id].lender;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         updateinterestAccruedTillLastPrincipalUpdate(_id);                                                                                                                                                      │
│         creditLineVariables[_id].principal = creditLineVariables[_id].principal.add(_amount);                                                                                                                   │
│         creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 _tokenDiffBalance;                                                                                                                                                                              │
│         if (_borrowAsset != address(0)) {                                                                                                                                                                       │
│             uint256 _balanceBefore = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                             │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                              │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 _balanceBefore = address(this).balance;                                                                                                                                                     │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = address(this).balance;                                                                                                                                                      │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         uint256 _protocolFee = _tokenDiffBalance.mul(protocolFeeFraction).div(10**30);                                                                                                                          │
│         _tokenDiffBalance = _tokenDiffBalance.sub(_protocolFee);                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         if (_borrowAsset == address(0)) {                                                                                                                                                                       │
│             (bool feeSuccess, ) = protocolFeeCollector.call{value: _protocolFee}('');                                                                                                                           │
│             require(feeSuccess, 'Transfer fail');                                                                                                                                                               │
│             (bool success, ) = msg.sender.call{value: _tokenDiffBalance}('');                                                                                                                                   │
│             require(success, 'Transfer fail');                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             IERC20(_borrowAsset).safeTransfer(protocolFeeCollector, _protocolFee);                                                                                                                              │
│             IERC20(_borrowAsset).safeTransfer(msg.sender, _tokenDiffBalance);                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         emit BorrowedFromCreditLine(_id, _tokenDiffBalance);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function borrow(uint256 _id, uint256 _amount) external payable nonReentrant onlyCreditLineBorrower(_id) {                                                                                                   │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         uint256 _borrowableAmount = calculateBorrowableAmount(_id);                                                                                                                                             │
│         require(_amount <= _borrowableAmount, "CreditLine::borrow - The current collateral ratio doesn't allow to withdraw the amount");                                                                        │
│         address _borrowAsset = creditLineConstants[_id].borrowAsset;                                                                                                                                            │
│         address _lender = creditLineConstants[_id].lender;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         updateinterestAccruedTillLastPrincipalUpdate(_id);                                                                                                                                                      │
│         creditLineVariables[_id].principal = creditLineVariables[_id].principal.add(_amount);                                                                                                                   │
│         creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 _tokenDiffBalance;                                                                                                                                                                              │
│         if (_borrowAsset != address(0)) {                                                                                                                                                                       │
│             uint256 _balanceBefore = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                             │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                              │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 _balanceBefore = address(this).balance;                                                                                                                                                     │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = address(this).balance;                                                                                                                                                      │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         uint256 _protocolFee = _tokenDiffBalance.mul(protocolFeeFraction).div(10**30);                                                                                                                          │
│         _tokenDiffBalance = _tokenDiffBalance.sub(_protocolFee);                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         if (_borrowAsset == address(0)) {                                                                                                                                                                       │
│             (bool feeSuccess, ) = protocolFeeCollector.call{value: _protocolFee}('');                                                                                                                           │
│             require(feeSuccess, 'Transfer fail');                                                                                                                                                               │
│             (bool success, ) = msg.sender.call{value: _tokenDiffBalance}('');                                                                                                                                   │
│             require(success, 'Transfer fail');                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             IERC20(_borrowAsset).safeTransfer(protocolFeeCollector, _protocolFee);                                                                                                                              │
│             IERC20(_borrowAsset).safeTransfer(msg.sender, _tokenDiffBalance);                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         emit BorrowedFromCreditLine(_id, _tokenDiffBalance);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repayFromSavingsAccount(                                                                                                                                                                          │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _asset,                                                                                                                                                                                         │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(msg.sender, _asset, _strategyList[_index]);                                                                                              │
│             if (_liquidityShares == 0) {                                                                                                                                                                        │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                      │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _asset, _strategyList[_index], msg.sender, _lender);                                                                                                │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_repayFromSavingsAccount - Insufficient balance');                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repay(                                                                                                                                                                                            │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         uint256 _principalPaid                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         address _defaultStrategy = defaultStrategy;                                                                                                                                                             │
│         address _borrowAsset = creditLineConstants[_id].borrowAsset;                                                                                                                                            │
│         address _lender = creditLineConstants[_id].lender;                                                                                                                                                      │
│         if (!_fromSavingsAccount) {                                                                                                                                                                             │
│             if (_borrowAsset == address(0)) {                                                                                                                                                                   │
│                 require(msg.value == _amount, 'creditLine::repay - Ether sent not equal to repay amount');                                                                                                      │
│                 _savingsAccount.deposit{value: _amount}(_amount, _borrowAsset, _defaultStrategy, _lender);                                                                                                      │
│             } else {                                                                                                                                                                                            │
│                 IERC20(_borrowAsset).safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                      │
│                 IERC20(_borrowAsset).approve(_defaultStrategy, _amount);                                                                                                                                        │
│                 _savingsAccount.deposit(_amount, _borrowAsset, _defaultStrategy, _lender);                                                                                                                      │
│             }                                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             _repayFromSavingsAccount(_amount, _borrowAsset, _lender);                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│         if (_principalPaid != 0) {                                                                                                                                                                              │
│             _savingsAccount.increaseAllowanceToCreditLine(_principalPaid, _borrowAsset, _lender);                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function repay(                                                                                                                                                                                             │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _fromSavingsAccount                                                                                                                                                                                │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         require(creditLineConstants[_id].lender != msg.sender, 'Lender cant repay');                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _interestSincePrincipalUpdate = calculateInterestAccrued(_id);                                                                                                                                  │
│         uint256 _totalInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(                                                                                                  │
│             _interestSincePrincipalUpdate                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _interestToPay = _totalInterestAccrued.sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                       │
│         uint256 _totalCurrentDebt = _interestToPay.add(creditLineVariables[_id].principal);                                                                                                                     │
│         uint256 _principalPaid = 0;                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         if (_amount >= _totalCurrentDebt) {                                                                                                                                                                     │
│             _amount = _totalCurrentDebt;                                                                                                                                                                        │
│             emit CompleteCreditLineRepaid(_id, _amount);                                                                                                                                                        │
│         } else {                                                                                                                                                                                                │
│             emit PartialCreditLineRepaid(_id, _amount);                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_amount > _interestToPay) {                                                                                                                                                                         │
│             creditLineVariables[_id].principal = _totalCurrentDebt.sub(_amount);                                                                                                                                │
│             creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _totalInterestAccrued;                                                                                                            │
│             creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                 │
│             creditLineVariables[_id].totalInterestRepaid = _totalInterestAccrued;                                                                                                                               │
│             _principalPaid = _amount.sub(_interestToPay);                                                                                                                                                       │
│         } else {                                                                                                                                                                                                │
│             creditLineVariables[_id].totalInterestRepaid = creditLineVariables[_id].totalInterestRepaid.add(_amount);                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _repay(_id, _amount, _fromSavingsAccount, _principalPaid);                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         if (creditLineVariables[_id].principal == 0) {                                                                                                                                                          │
│             _resetCreditLine(_id);                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function repay(                                                                                                                                                                                             │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _fromSavingsAccount                                                                                                                                                                                │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         require(creditLineConstants[_id].lender != msg.sender, 'Lender cant repay');                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _interestSincePrincipalUpdate = calculateInterestAccrued(_id);                                                                                                                                  │
│         uint256 _totalInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(                                                                                                  │
│             _interestSincePrincipalUpdate                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _interestToPay = _totalInterestAccrued.sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                       │
│         uint256 _totalCurrentDebt = _interestToPay.add(creditLineVariables[_id].principal);                                                                                                                     │
│         uint256 _principalPaid = 0;                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         if (_amount >= _totalCurrentDebt) {                                                                                                                                                                     │
│             _amount = _totalCurrentDebt;                                                                                                                                                                        │
│             emit CompleteCreditLineRepaid(_id, _amount);                                                                                                                                                        │
│         } else {                                                                                                                                                                                                │
│             emit PartialCreditLineRepaid(_id, _amount);                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_amount > _interestToPay) {                                                                                                                                                                         │
│             creditLineVariables[_id].principal = _totalCurrentDebt.sub(_amount);                                                                                                                                │
│             creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _totalInterestAccrued;                                                                                                            │
│             creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                 │
│             creditLineVariables[_id].totalInterestRepaid = _totalInterestAccrued;                                                                                                                               │
│             _principalPaid = _amount.sub(_interestToPay);                                                                                                                                                       │
│         } else {                                                                                                                                                                                                │
│             creditLineVariables[_id].totalInterestRepaid = creditLineVariables[_id].totalInterestRepaid.add(_amount);                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _repay(_id, _amount, _fromSavingsAccount, _principalPaid);                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         if (creditLineVariables[_id].principal == 0) {                                                                                                                                                          │
│             _resetCreditLine(_id);                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _resetCreditLine(uint256 _id) internal {                                                                                                                                                           │
│         creditLineVariables[_id].lastPrincipalUpdateTime = 0;                                                                                                                                                   │
│         creditLineVariables[_id].totalInterestRepaid = 0;                                                                                                                                                       │
│         creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = 0;                                                                                                                                    │
│         emit CreditLineReset(_id);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function close(uint256 _id) external ifCreditLineExists(_id) {                                                                                                                                              │
│         require(                                                                                                                                                                                                │
│             msg.sender == creditLineConstants[_id].borrower || msg.sender == creditLineConstants[_id].lender,                                                                                                   │
│             'CreditLine: Permission denied while closing Line of credit'                                                                                                                                        │
│         );                                                                                                                                                                                                      │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: Credit line should be active.');                                                                                       │
│         require(creditLineVariables[_id].principal == 0, 'CreditLine: Cannot be closed since not repaid.');                                                                                                     │
│         require(creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate == 0, 'CreditLine: Cannot be closed since not repaid.');                                                                        │
│         creditLineVariables[_id].status = CreditLineStatus.CLOSED;                                                                                                                                              │
│         emit CreditLineClosed(_id);                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function calculateTotalCollateralTokens(uint256 _id) public returns (uint256 _amount) {                                                                                                                     │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _liquidityShares;                                                                                                                                                                               │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             if (_strategyList == address(0)) {                                                                                                                                                                  │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             _liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                    │
│                                                                                                                                                                                                                 │
│             _amount = _amount.add(_tokenInStrategy);                                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function setVault(address _token, address _vault) public {                                                                                                                                                  │
│         require(msg.sender == strategist || msg.sender == governance, '!strategist');                                                                                                                           │
│         require(vaults[_token] == address(0), 'vault');                                                                                                                                                         │
│         vaults[_token] = _vault;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function setStrategy(address _token, address _strategy) public {                                                                                                                                            │
│         require(msg.sender == strategist || msg.sender == governance, '!strategist');                                                                                                                           │
│         require(approvedStrategies[_token][_strategy], '!approved');                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         address _current = strategies[_token];                                                                                                                                                                  │
│         if (_current != address(0)) {                                                                                                                                                                           │
│             IStrategy(_current).withdrawAll();                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         strategies[_token] = _strategy;                                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function earn(address _token, uint256 _amount) public {                                                                                                                                                     │
│         address _strategy = strategies[_token];                                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         if (_want != _token) {                                                                                                                                                                                  │
│             address converter = converters[_token][_want];                                                                                                                                                      │
│             IERC20(_token).safeTransfer(converter, _amount);                                                                                                                                                    │
│             _amount = Converter(converter).convert(_strategy);                                                                                                                                                  │
│             IERC20(_want).safeTransfer(_strategy, _amount);                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             IERC20(_token).safeTransfer(_strategy, _amount);                                                                                                                                                    │
│         }                                                                                                                                                                                                       │
│         IStrategy(_strategy).deposit();                                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ Code:                                                                                                                                                                                                           │
│     function getExpectedReturn(                                                                                                                                                                                 │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public view returns (uint256 expected) {                                                                                                                                                                  │
│         uint256 _balance = IERC20(_token).balanceOf(_strategy);                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         (expected, ) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _balance, parts, 0);                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function yearn(                                                                                                                                                                                             │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public {                                                                                                                                                                                                  │
│         require(msg.sender == strategist || msg.sender == governance, '!governance');                                                                                                                           │
│         // This contract should never have value in it, but just incase since this is a public call                                                                                                             │
│         uint256 _before = IERC20(_token).balanceOf(address(this));                                                                                                                                              │
│         IStrategy(_strategy).withdraw(_token);                                                                                                                                                                  │
│         uint256 _after = IERC20(_token).balanceOf(address(this));                                                                                                                                               │
│         if (_after > _before) {                                                                                                                                                                                 │
│             uint256 _amount = _after.sub(_before);                                                                                                                                                              │
│             address _want = IStrategy(_strategy).want();                                                                                                                                                        │
│             uint256[] memory _distribution;                                                                                                                                                                     │
│             uint256 _expected;                                                                                                                                                                                  │
│             _before = IERC20(_want).balanceOf(address(this));                                                                                                                                                   │
│             IERC20(_token).safeApprove(onesplit, 0);                                                                                                                                                            │
│             IERC20(_token).safeApprove(onesplit, _amount);                                                                                                                                                      │
│             (_expected, _distribution) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _amount, parts, 0);                                                                                           │
│             OneSplitAudit(onesplit).swap(_token, _want, _amount, _expected, _distribution, 0);                                                                                                                  │
│             _after = IERC20(_want).balanceOf(address(this));                                                                                                                                                    │
│             if (_after > _before) {                                                                                                                                                                             │
│                 _amount = _after.sub(_before);                                                                                                                                                                  │
│                 uint256 _reward = _amount.mul(split).div(max);                                                                                                                                                  │
│                 earn(_want, _amount.sub(_reward));                                                                                                                                                              │
│                 IERC20(_want).safeTransfer(rewards, _reward);                                                                                                                                                   │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getExpectedReturn(                                                                                                                                                                                 │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public view returns (uint256 expected) {                                                                                                                                                                  │
│         uint256 _balance = IERC20(_token).balanceOf(_strategy);                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         (expected, ) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _balance, parts, 0);                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function getExpectedReturn(                                                                                                                                                                                 │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public view returns (uint256 expected) {                                                                                                                                                                  │
│         uint256 _balance = IERC20(_token).balanceOf(_strategy);                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         (expected, ) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _balance, parts, 0);                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function getExpectedReturn(                                                                                                                                                                                 │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public view returns (uint256 expected) {                                                                                                                                                                  │
│         uint256 _balance = IERC20(_token).balanceOf(_strategy);                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         (expected, ) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _balance, parts, 0);                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ Code:                                                                                                                                                                                                           │
│     function yearn(                                                                                                                                                                                             │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public {                                                                                                                                                                                                  │
│         require(msg.sender == strategist || msg.sender == governance, '!governance');                                                                                                                           │
│         // This contract should never have value in it, but just incase since this is a public call                                                                                                             │
│         uint256 _before = IERC20(_token).balanceOf(address(this));                                                                                                                                              │
│         IStrategy(_strategy).withdraw(_token);                                                                                                                                                                  │
│         uint256 _after = IERC20(_token).balanceOf(address(this));                                                                                                                                               │
│         if (_after > _before) {                                                                                                                                                                                 │
│             uint256 _amount = _after.sub(_before);                                                                                                                                                              │
│             address _want = IStrategy(_strategy).want();                                                                                                                                                        │
│             uint256[] memory _distribution;                                                                                                                                                                     │
│             uint256 _expected;                                                                                                                                                                                  │
│             _before = IERC20(_want).balanceOf(address(this));                                                                                                                                                   │
│             IERC20(_token).safeApprove(onesplit, 0);                                                                                                                                                            │
│             IERC20(_token).safeApprove(onesplit, _amount);                                                                                                                                                      │
│             (_expected, _distribution) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _amount, parts, 0);                                                                                           │
│             OneSplitAudit(onesplit).swap(_token, _want, _amount, _expected, _distribution, 0);                                                                                                                  │
│             _after = IERC20(_want).balanceOf(address(this));                                                                                                                                                    │
│             if (_after > _before) {                                                                                                                                                                             │
│                 _amount = _after.sub(_before);                                                                                                                                                                  │
│                 uint256 _reward = _amount.mul(split).div(max);                                                                                                                                                  │
│                 earn(_want, _amount.sub(_reward));                                                                                                                                                              │
│                 IERC20(_want).safeTransfer(rewards, _reward);                                                                                                                                                   │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function withdrawAll() external returns (uint256 balance) {                                                                                                                                                 │
│         require(msg.sender == controller, '!controller');                                                                                                                                                       │
│         balance = IERC20(want).balanceOf(address(this));                                                                                                                                                        │
│         address _vault = IController(controller).vaults(address(want));                                                                                                                                         │
│         IERC20(want).safeTransfer(_vault, balance);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function setStrategy(address _token, address _strategy) public {                                                                                                                                            │
│         require(msg.sender == strategist || msg.sender == governance, '!strategist');                                                                                                                           │
│         require(approvedStrategies[_token][_strategy], '!approved');                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         address _current = strategies[_token];                                                                                                                                                                  │
│         if (_current != address(0)) {                                                                                                                                                                           │
│             IStrategy(_current).withdrawAll();                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         strategies[_token] = _strategy;                                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function withdrawAll() external returns (uint256 balance) {                                                                                                                                                 │
│         require(msg.sender == controller, '!controller');                                                                                                                                                       │
│         balance = IERC20(want).balanceOf(address(this));                                                                                                                                                        │
│         address _vault = IController(controller).vaults(address(want));                                                                                                                                         │
│         IERC20(want).safeTransfer(_vault, balance);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function depositETH() public payable {                                                                                                                                                                      │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         uint256 _amount = msg.value;                                                                                                                                                                            │
│         WETH(address(token)).deposit{value: _amount}();                                                                                                                                                         │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function depositETH() public payable {                                                                                                                                                                      │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         uint256 _amount = msg.value;                                                                                                                                                                            │
│         WETH(address(token)).deposit{value: _amount}();                                                                                                                                                         │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function lend(                                                                                                                                                                                              │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy                                                                                                                                                                                       │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         address _lenderVerifier = poolConstants.lenderVerifier;                                                                                                                                                 │
│         address _borrower = poolConstants.borrower;                                                                                                                                                             │
│         require(_lender != _borrower && _borrower != msg.sender, 'L1');                                                                                                                                         │
│         if (_lenderVerifier != address(0)) {                                                                                                                                                                    │
│             require(IVerification(IPoolFactory(poolFactory).userRegistry()).isUser(_lender, _lenderVerifier), 'L2');                                                                                            │
│         }                                                                                                                                                                                                       │
│         require(poolVariables.loanStatus == LoanStatus.COLLECTION && block.timestamp < poolConstants.loanStartTime, 'L3');                                                                                      │
│         uint256 _borrowAmountNeeded = poolConstants.borrowAmountRequested;                                                                                                                                      │
│         uint256 _lentAmount = totalSupply();                                                                                                                                                                    │
│         if (_amount.add(_lentAmount) > _borrowAmountNeeded) {                                                                                                                                                   │
│             _amount = _borrowAmountNeeded.sub(_lentAmount);                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowToken = poolConstants.borrowAsset;                                                                                                                                                       │
│         bool _fromSavingsAccount;                                                                                                                                                                               │
│         if(_strategy != address(0)) {                                                                                                                                                                           │
│             _fromSavingsAccount = true;                                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│         _deposit(                                                                                                                                                                                               │
│             _fromSavingsAccount,                                                                                                                                                                                │
│             false,                                                                                                                                                                                              │
│             _borrowToken,                                                                                                                                                                                       │
│             _amount,                                                                                                                                                                                            │
│             _strategy,                                                                                                                                                                                          │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         _mint(_lender, _amount);                                                                                                                                                                                │
│         emit LiquiditySupplied(_amount, _lender);                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function lend(                                                                                                                                                                                              │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy                                                                                                                                                                                       │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         address _lenderVerifier = poolConstants.lenderVerifier;                                                                                                                                                 │
│         address _borrower = poolConstants.borrower;                                                                                                                                                             │
│         require(_lender != _borrower && _borrower != msg.sender, 'L1');                                                                                                                                         │
│         if (_lenderVerifier != address(0)) {                                                                                                                                                                    │
│             require(IVerification(IPoolFactory(poolFactory).userRegistry()).isUser(_lender, _lenderVerifier), 'L2');                                                                                            │
│         }                                                                                                                                                                                                       │
│         require(poolVariables.loanStatus == LoanStatus.COLLECTION && block.timestamp < poolConstants.loanStartTime, 'L3');                                                                                      │
│         uint256 _borrowAmountNeeded = poolConstants.borrowAmountRequested;                                                                                                                                      │
│         uint256 _lentAmount = totalSupply();                                                                                                                                                                    │
│         if (_amount.add(_lentAmount) > _borrowAmountNeeded) {                                                                                                                                                   │
│             _amount = _borrowAmountNeeded.sub(_lentAmount);                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowToken = poolConstants.borrowAsset;                                                                                                                                                       │
│         bool _fromSavingsAccount;                                                                                                                                                                               │
│         if(_strategy != address(0)) {                                                                                                                                                                           │
│             _fromSavingsAccount = true;                                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│         _deposit(                                                                                                                                                                                               │
│             _fromSavingsAccount,                                                                                                                                                                                │
│             false,                                                                                                                                                                                              │
│             _borrowToken,                                                                                                                                                                                       │
│             _amount,                                                                                                                                                                                            │
│             _strategy,                                                                                                                                                                                          │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         _mint(_lender, _amount);                                                                                                                                                                                │
│         emit LiquiditySupplied(_amount, _lender);                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function _mint(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: mint to the zero address');                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         _totalSupply = _totalSupply.add(amount);                                                                                                                                                                │
│         _balances = _balances.add(amount);                                                                                                                                                                      │
│         emit Transfer(address(0), account, amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawLiquidity() external isLender(msg.sender) nonReentrant {                                                                                                                                   │
│         LoanStatus _loanStatus = poolVariables.loanStatus;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _loanStatus == LoanStatus.CLOSED ||                                                                                                                                                                 │
│                 _loanStatus == LoanStatus.CANCELLED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.DEFAULTED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.TERMINATED,                                                                                                                                                           │
│             'WL1'                                                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //gets amount through liquidity shares                                                                                                                                                                  │
│         uint256 _actualBalance = balanceOf(msg.sender);                                                                                                                                                         │
│         uint256 _toTransfer = _actualBalance;                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.DEFAULTED || _loanStatus == LoanStatus.TERMINATED) {                                                                                                                      │
│             uint256 _totalAsset;                                                                                                                                                                                │
│             if (poolConstants.borrowAsset != address(0)) {                                                                                                                                                      │
│                 _totalAsset = IERC20(poolConstants.borrowAsset).balanceOf(address(this));                                                                                                                       │
│             } else {                                                                                                                                                                                            │
│                 _totalAsset = address(this).balance;                                                                                                                                                            │
│             }                                                                                                                                                                                                   │
│             //assuming their will be no tokens in pool in any case except liquidation (to be checked) or we should store the amount in liquidate()                                                              │
│             _toTransfer = _toTransfer.mul(_totalAsset).div(totalSupply());                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CANCELLED) {                                                                                                                                                              │
│             _toTransfer = _toTransfer.add(_toTransfer.mul(poolVariables.penaltyLiquidityAmount).div(totalSupply()));                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CLOSED) {                                                                                                                                                                 │
│             //transfer repayment                                                                                                                                                                                │
│             _withdrawRepayment(msg.sender);                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│         //to add transfer if not included in above (can be transferred with liquidity)                                                                                                                          │
│         _burn(msg.sender, _actualBalance);                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //transfer liquidity provided                                                                                                                                                                           │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _toTransfer, address(this), msg.sender);                                                                                                   │
│                                                                                                                                                                                                                 │
│         emit LiquidityWithdrawn(_toTransfer, msg.sender);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function withdrawLiquidity() external isLender(msg.sender) nonReentrant {                                                                                                                                   │
│         LoanStatus _loanStatus = poolVariables.loanStatus;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _loanStatus == LoanStatus.CLOSED ||                                                                                                                                                                 │
│                 _loanStatus == LoanStatus.CANCELLED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.DEFAULTED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.TERMINATED,                                                                                                                                                           │
│             'WL1'                                                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //gets amount through liquidity shares                                                                                                                                                                  │
│         uint256 _actualBalance = balanceOf(msg.sender);                                                                                                                                                         │
│         uint256 _toTransfer = _actualBalance;                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.DEFAULTED || _loanStatus == LoanStatus.TERMINATED) {                                                                                                                      │
│             uint256 _totalAsset;                                                                                                                                                                                │
│             if (poolConstants.borrowAsset != address(0)) {                                                                                                                                                      │
│                 _totalAsset = IERC20(poolConstants.borrowAsset).balanceOf(address(this));                                                                                                                       │
│             } else {                                                                                                                                                                                            │
│                 _totalAsset = address(this).balance;                                                                                                                                                            │
│             }                                                                                                                                                                                                   │
│             //assuming their will be no tokens in pool in any case except liquidation (to be checked) or we should store the amount in liquidate()                                                              │
│             _toTransfer = _toTransfer.mul(_totalAsset).div(totalSupply());                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CANCELLED) {                                                                                                                                                              │
│             _toTransfer = _toTransfer.add(_toTransfer.mul(poolVariables.penaltyLiquidityAmount).div(totalSupply()));                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CLOSED) {                                                                                                                                                                 │
│             //transfer repayment                                                                                                                                                                                │
│             _withdrawRepayment(msg.sender);                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│         //to add transfer if not included in above (can be transferred with liquidity)                                                                                                                          │
│         _burn(msg.sender, _actualBalance);                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //transfer liquidity provided                                                                                                                                                                           │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _toTransfer, address(this), msg.sender);                                                                                                   │
│                                                                                                                                                                                                                 │
│         emit LiquidityWithdrawn(_toTransfer, msg.sender);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function _burn(address account, uint256 amount) internal {                                                                                                                                                  │
│         require(account != address(0), 'ERC20: burn from the zero address');                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         _balances = _balances.sub(amount, 'ERC20: burn amount exceeds balance');                                                                                                                                │
│         _totalSupply = _totalSupply.sub(amount);                                                                                                                                                                │
│         emit Transfer(account, address(0), amount);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function earn(address _token, uint256 _amount) public {                                                                                                                                                     │
│         address _strategy = strategies[_token];                                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         if (_want != _token) {                                                                                                                                                                                  │
│             address converter = converters[_token][_want];                                                                                                                                                      │
│             IERC20(_token).safeTransfer(converter, _amount);                                                                                                                                                    │
│             _amount = Converter(converter).convert(_strategy);                                                                                                                                                  │
│             IERC20(_want).safeTransfer(_strategy, _amount);                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             IERC20(_token).safeTransfer(_strategy, _amount);                                                                                                                                                    │
│         }                                                                                                                                                                                                       │
│         IStrategy(_strategy).deposit();                                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function earn(address _token, uint256 _amount) public {                                                                                                                                                     │
│         address _strategy = strategies[_token];                                                                                                                                                                 │
│         address _want = IStrategy(_strategy).want();                                                                                                                                                            │
│         if (_want != _token) {                                                                                                                                                                                  │
│             address converter = converters[_token][_want];                                                                                                                                                      │
│             IERC20(_token).safeTransfer(converter, _amount);                                                                                                                                                    │
│             _amount = Converter(converter).convert(_strategy);                                                                                                                                                  │
│             IERC20(_want).safeTransfer(_strategy, _amount);                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             IERC20(_token).safeTransfer(_strategy, _amount);                                                                                                                                                    │
│         }                                                                                                                                                                                                       │
│         IStrategy(_strategy).deposit();                                                                                                                                                                         │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function deposit(uint256 _amount) public {                                                                                                                                                                  │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         token.safeTransferFrom(msg.sender, address(this), _amount);                                                                                                                                             │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function depositETH() public payable {                                                                                                                                                                      │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         uint256 _amount = msg.value;                                                                                                                                                                            │
│         WETH(address(token)).deposit{value: _amount}();                                                                                                                                                         │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function depositETH() public payable {                                                                                                                                                                      │
│         uint256 _pool = balance();                                                                                                                                                                              │
│         uint256 _before = token.balanceOf(address(this));                                                                                                                                                       │
│         uint256 _amount = msg.value;                                                                                                                                                                            │
│         WETH(address(token)).deposit{value: _amount}();                                                                                                                                                         │
│         uint256 _after = token.balanceOf(address(this));                                                                                                                                                        │
│         _amount = _after.sub(_before); // Additional check for deflationary tokens                                                                                                                              │
│         uint256 shares = 0;                                                                                                                                                                                     │
│         if (totalSupply() == 0) {                                                                                                                                                                               │
│             shares = _amount;                                                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             shares = (_amount.mul(totalSupply())).div(_pool);                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         _mint(msg.sender, shares);                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(address asset, uint256 amount) internal returns (uint256 tokensReceived) {                                                                                                            │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 tokensBefore = IERC20(asset).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         IERC20(aToken).approve(lendingPool, amount);                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         //withdraw collateral from vault                                                                                                                                                                        │
│         AaveLendingPool(lendingPool).withdraw(asset, amount, address(this));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(tokensBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function yearn(                                                                                                                                                                                             │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public {                                                                                                                                                                                                  │
│         require(msg.sender == strategist || msg.sender == governance, '!governance');                                                                                                                           │
│         // This contract should never have value in it, but just incase since this is a public call                                                                                                             │
│         uint256 _before = IERC20(_token).balanceOf(address(this));                                                                                                                                              │
│         IStrategy(_strategy).withdraw(_token);                                                                                                                                                                  │
│         uint256 _after = IERC20(_token).balanceOf(address(this));                                                                                                                                               │
│         if (_after > _before) {                                                                                                                                                                                 │
│             uint256 _amount = _after.sub(_before);                                                                                                                                                              │
│             address _want = IStrategy(_strategy).want();                                                                                                                                                        │
│             uint256[] memory _distribution;                                                                                                                                                                     │
│             uint256 _expected;                                                                                                                                                                                  │
│             _before = IERC20(_want).balanceOf(address(this));                                                                                                                                                   │
│             IERC20(_token).safeApprove(onesplit, 0);                                                                                                                                                            │
│             IERC20(_token).safeApprove(onesplit, _amount);                                                                                                                                                      │
│             (_expected, _distribution) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _amount, parts, 0);                                                                                           │
│             OneSplitAudit(onesplit).swap(_token, _want, _amount, _expected, _distribution, 0);                                                                                                                  │
│             _after = IERC20(_want).balanceOf(address(this));                                                                                                                                                    │
│             if (_after > _before) {                                                                                                                                                                             │
│                 _amount = _after.sub(_before);                                                                                                                                                                  │
│                 uint256 _reward = _amount.mul(split).div(max);                                                                                                                                                  │
│                 earn(_want, _amount.sub(_reward));                                                                                                                                                              │
│                 IERC20(_want).safeTransfer(rewards, _reward);                                                                                                                                                   │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function yearn(                                                                                                                                                                                             │
│         address _strategy,                                                                                                                                                                                      │
│         address _token,                                                                                                                                                                                         │
│         uint256 parts                                                                                                                                                                                           │
│     ) public {                                                                                                                                                                                                  │
│         require(msg.sender == strategist || msg.sender == governance, '!governance');                                                                                                                           │
│         // This contract should never have value in it, but just incase since this is a public call                                                                                                             │
│         uint256 _before = IERC20(_token).balanceOf(address(this));                                                                                                                                              │
│         IStrategy(_strategy).withdraw(_token);                                                                                                                                                                  │
│         uint256 _after = IERC20(_token).balanceOf(address(this));                                                                                                                                               │
│         if (_after > _before) {                                                                                                                                                                                 │
│             uint256 _amount = _after.sub(_before);                                                                                                                                                              │
│             address _want = IStrategy(_strategy).want();                                                                                                                                                        │
│             uint256[] memory _distribution;                                                                                                                                                                     │
│             uint256 _expected;                                                                                                                                                                                  │
│             _before = IERC20(_want).balanceOf(address(this));                                                                                                                                                   │
│             IERC20(_token).safeApprove(onesplit, 0);                                                                                                                                                            │
│             IERC20(_token).safeApprove(onesplit, _amount);                                                                                                                                                      │
│             (_expected, _distribution) = OneSplitAudit(onesplit).getExpectedReturn(_token, _want, _amount, parts, 0);                                                                                           │
│             OneSplitAudit(onesplit).swap(_token, _want, _amount, _expected, _distribution, 0);                                                                                                                  │
│             _after = IERC20(_want).balanceOf(address(this));                                                                                                                                                    │
│             if (_after > _before) {                                                                                                                                                                             │
│                 _amount = _after.sub(_before);                                                                                                                                                                  │
│                 uint256 _reward = _amount.mul(split).div(max);                                                                                                                                                  │
│                 earn(_want, _amount.sub(_reward));                                                                                                                                                              │
│                 IERC20(_want).safeTransfer(rewards, _reward);                                                                                                                                                   │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
│     function withdraw(uint256 _shares) public {                                                                                                                                                                 │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         token.safeTransfer(msg.sender, r);                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawETH(address vault, uint256 amount) internal returns (uint256 received) {                                                                                                                  │
│         uint256 ethBalance = address(this).balance;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdrawETH(amount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         received = address(this).balance.sub(ethBalance);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawETH(address vault, uint256 amount) internal returns (uint256 received) {                                                                                                                  │
│         uint256 ethBalance = address(this).balance;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdrawETH(amount);                                                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         received = address(this).balance.sub(ethBalance);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawETH(uint256 amount) internal returns (uint256 received) {                                                                                                                                 │
│         IERC20(IWETHGateway(wethGateway).getAWETHAddress()).approve(wethGateway, amount);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 ethBalance = address(this).balance;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral                                                                                                                                                                                       │
│         IWETHGateway(wethGateway).withdrawETH(amount, address(this));                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         received = address(this).balance.sub(ethBalance);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function withdrawETH(uint256 _shares) public {                                                                                                                                                              │
│         uint256 r = (balance().mul(_shares)).div(totalSupply());                                                                                                                                                │
│         _burn(msg.sender, _shares);                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         // Check balance                                                                                                                                                                                        │
│         uint256 b = token.balanceOf(address(this));                                                                                                                                                             │
│         if (b < r) {                                                                                                                                                                                            │
│             uint256 _withdraw = r.sub(b);                                                                                                                                                                       │
│             IController(controller).withdraw(address(token), _withdraw);                                                                                                                                        │
│             uint256 _after = token.balanceOf(address(this));                                                                                                                                                    │
│             uint256 _diff = _after.sub(b);                                                                                                                                                                      │
│             if (_diff < _withdraw) {                                                                                                                                                                            │
│                 r = b.add(_diff);                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         WETH(address(token)).withdraw(r);                                                                                                                                                                       │
│         msg.sender.transfer(r);                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawBorrowAmount(                                                                                                                                                                             │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_lender, _asset, _strategyList[_index]);                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 tokenInStrategy = _liquidityShares;                                                                                                                                                     │
│                 tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                   │
│                 uint256 _tokensToTransfer = tokenInStrategy;                                                                                                                                                    │
│                 if (_activeAmount.add(tokenInStrategy) >= _amountInTokens) {                                                                                                                                    │
│                     _tokensToTransfer = (_amountInTokens.sub(_activeAmount));                                                                                                                                   │
│                 }                                                                                                                                                                                               │
│                 _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                           │
│                 _savingsAccount.withdrawFrom(_tokensToTransfer, _asset, _strategyList[_index], _lender, address(this), false);                                                                                  │
│                 if (_activeAmount == _amountInTokens) {                                                                                                                                                         │
│                     return;                                                                                                                                                                                     │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         require(_activeAmount == _amountInTokens, 'insufficient balance');                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawBorrowAmount(                                                                                                                                                                             │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_lender, _asset, _strategyList[_index]);                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 tokenInStrategy = _liquidityShares;                                                                                                                                                     │
│                 tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                   │
│                 uint256 _tokensToTransfer = tokenInStrategy;                                                                                                                                                    │
│                 if (_activeAmount.add(tokenInStrategy) >= _amountInTokens) {                                                                                                                                    │
│                     _tokensToTransfer = (_amountInTokens.sub(_activeAmount));                                                                                                                                   │
│                 }                                                                                                                                                                                               │
│                 _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                           │
│                 _savingsAccount.withdrawFrom(_tokensToTransfer, _asset, _strategyList[_index], _lender, address(this), false);                                                                                  │
│                 if (_activeAmount == _amountInTokens) {                                                                                                                                                         │
│                     return;                                                                                                                                                                                     │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         require(_activeAmount == _amountInTokens, 'insufficient balance');                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _repayFromSavingsAccount(                                                                                                                                                                          │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _asset,                                                                                                                                                                                         │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(msg.sender, _asset, _strategyList[_index]);                                                                                              │
│             if (_liquidityShares == 0) {                                                                                                                                                                        │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                      │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _asset, _strategyList[_index], msg.sender, _lender);                                                                                                │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_repayFromSavingsAccount - Insufficient balance');                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _repayFromSavingsAccount(                                                                                                                                                                          │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _asset,                                                                                                                                                                                         │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(msg.sender, _asset, _strategyList[_index]);                                                                                              │
│             if (_liquidityShares == 0) {                                                                                                                                                                        │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                      │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _asset, _strategyList[_index], msg.sender, _lender);                                                                                                │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_repayFromSavingsAccount - Insufficient balance');                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateTotalCollateralTokens(uint256 _id) public returns (uint256 _amount) {                                                                                                                     │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _liquidityShares;                                                                                                                                                                               │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             if (_strategyList == address(0)) {                                                                                                                                                                  │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             _liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                    │
│                                                                                                                                                                                                                 │
│             _amount = _amount.add(_tokenInStrategy);                                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function calculateTotalCollateralTokens(uint256 _id) public returns (uint256 _amount) {                                                                                                                     │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _liquidityShares;                                                                                                                                                                               │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             if (_strategyList == address(0)) {                                                                                                                                                                  │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             _liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                    │
│                                                                                                                                                                                                                 │
│             _amount = _amount.add(_tokenInStrategy);                                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidatePool(                                                                                                                                                                                     │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         LoanStatus _currentPoolStatus = poolVariables.loanStatus;                                                                                                                                               │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_currentPoolStatus == LoanStatus.ACTIVE, 'LP1');                                                                                                                                                │
│         require(IRepayment(_poolFactory.repaymentImpl()).didBorrowerDefault(address(this)), 'LP2');                                                                                                             │
│         poolVariables.loanStatus = LoanStatus.DEFAULTED;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                          │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _collateralTokens = _collateralLiquidityShare;                                                                                                                                                  │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralLiquidityShare, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _poolBorrowTokens = correspondingBorrowTokens(                                                                                                                                                  │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│         delete poolVariables.baseLiquidityShares;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _poolBorrowTokens, _poolFactory.noStrategyAddress(), msg.sender, address(this));                                                                     │
│         _withdraw(_toSavingsAccount, _recieveLiquidityShare, _collateralAsset, _poolSavingsStrategy, _collateralTokens);                                                                                        │
│         emit PoolLiquidated(msg.sender);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidatePool(                                                                                                                                                                                     │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         LoanStatus _currentPoolStatus = poolVariables.loanStatus;                                                                                                                                               │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_currentPoolStatus == LoanStatus.ACTIVE, 'LP1');                                                                                                                                                │
│         require(IRepayment(_poolFactory.repaymentImpl()).didBorrowerDefault(address(this)), 'LP2');                                                                                                             │
│         poolVariables.loanStatus = LoanStatus.DEFAULTED;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                          │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _collateralTokens = _collateralLiquidityShare;                                                                                                                                                  │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralLiquidityShare, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _poolBorrowTokens = correspondingBorrowTokens(                                                                                                                                                  │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│         delete poolVariables.baseLiquidityShares;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _poolBorrowTokens, _poolFactory.noStrategyAddress(), msg.sender, address(this));                                                                     │
│         _withdraw(_toSavingsAccount, _recieveLiquidityShare, _collateralAsset, _poolSavingsStrategy, _collateralTokens);                                                                                        │
│         emit PoolLiquidated(msg.sender);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawAllCollateral(address _receiver, uint256 _penalty) internal {                                                                                                                             │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         uint256 _collateralShares = 0;                                                                                                                                                                          │
│         if (poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares) > _penalty) {                                                                                                             │
│             _collateralShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares).sub(_penalty);                                                                                        │
│         }                                                                                                                                                                                                       │
│         // uint256 _collateralTokens = _collateralShares;                                                                                                                                                       │
│         uint256 _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralShares, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         poolVariables.baseLiquidityShares = _penalty;                                                                                                                                                           │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived;                                                                                                                                                                                │
│         if (_collateralShares != 0) {                                                                                                                                                                           │
│             ISavingsAccount _savingsAccount = ISavingsAccount(IPoolFactory(poolFactory).savingsAccount());                                                                                                      │
│             _sharesReceived = SavingsAccountUtil.savingsAccountTransfer(                                                                                                                                        │
│                 _savingsAccount,                                                                                                                                                                                │
│                 address(this),                                                                                                                                                                                  │
│                 _receiver,                                                                                                                                                                                      │
│                 _collateralTokens,                                                                                                                                                                              │
│                 _collateralAsset,                                                                                                                                                                               │
│                 _poolSavingsStrategy                                                                                                                                                                            │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         emit CollateralWithdrawn(_receiver, _sharesReceived);                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawAllCollateral(address _receiver, uint256 _penalty) internal {                                                                                                                             │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         uint256 _collateralShares = 0;                                                                                                                                                                          │
│         if (poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares) > _penalty) {                                                                                                             │
│             _collateralShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares).sub(_penalty);                                                                                        │
│         }                                                                                                                                                                                                       │
│         // uint256 _collateralTokens = _collateralShares;                                                                                                                                                       │
│         uint256 _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralShares, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         poolVariables.baseLiquidityShares = _penalty;                                                                                                                                                           │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived;                                                                                                                                                                                │
│         if (_collateralShares != 0) {                                                                                                                                                                           │
│             ISavingsAccount _savingsAccount = ISavingsAccount(IPoolFactory(poolFactory).savingsAccount());                                                                                                      │
│             _sharesReceived = SavingsAccountUtil.savingsAccountTransfer(                                                                                                                                        │
│                 _savingsAccount,                                                                                                                                                                                │
│                 address(this),                                                                                                                                                                                  │
│                 _receiver,                                                                                                                                                                                      │
│                 _collateralTokens,                                                                                                                                                                              │
│                 _collateralAsset,                                                                                                                                                                               │
│                 _poolSavingsStrategy                                                                                                                                                                            │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         emit CollateralWithdrawn(_receiver, _sharesReceived);                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function getTotalTokens(address _user, address _token) external override returns (uint256 _totalTokens) {                                                                                                   │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│                                                                                                                                                                                                                 │
│         for (uint256 i = 0; i < _strategyList.length; i++) {                                                                                                                                                    │
│             uint256 _liquidityShares = balanceInShares[_user][_token][_strategyList];                                                                                                                           │
│                                                                                                                                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                    │
│                 if (_strategyList != address(0)) {                                                                                                                                                              │
│                     _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _token);                                                                                                      │
│                 }                                                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│                 _totalTokens = _totalTokens.add(_tokenInStrategy);                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function getTotalTokens(address _user, address _token) external override returns (uint256 _totalTokens) {                                                                                                   │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│                                                                                                                                                                                                                 │
│         for (uint256 i = 0; i < _strategyList.length; i++) {                                                                                                                                                    │
│             uint256 _liquidityShares = balanceInShares[_user][_token][_strategyList];                                                                                                                           │
│                                                                                                                                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                    │
│                 if (_strategyList != address(0)) {                                                                                                                                                              │
│                     _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _token);                                                                                                      │
│                 }                                                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│                 _totalTokens = _totalTokens.add(_tokenInStrategy);                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public view override returns (uint256 amount) {                                                                                                  │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         (, , , , , , , uint256 liquidityIndex, , ) = IProtocolDataProvider(protocolDataProvider).getReserveData(asset);                                                                                         │
│                                                                                                                                                                                                                 │
│         amount = IScaledBalanceToken(aToken).scaledBalanceOf(address(this)).mul(liquidityIndex).mul(shares).div(                                                                                                │
│             IERC20(aToken).balanceOf(address(this))                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositETH(uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                                            │
│         aToken = IWETHGateway(wethGateway).getAWETHAddress();                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //lock collateral                                                                                                                                                                                       │
│         IWETHGateway(wethGateway).depositETH{value: amount}(lendingPool, address(this), referralCode);                                                                                                          │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                                            │
│         aToken = IWETHGateway(wethGateway).getAWETHAddress();                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //lock collateral                                                                                                                                                                                       │
│         IWETHGateway(wethGateway).depositETH{value: amount}(lendingPool, address(this), referralCode);                                                                                                          │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                                            │
│         aToken = IWETHGateway(wethGateway).getAWETHAddress();                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //lock collateral                                                                                                                                                                                       │
│         IWETHGateway(wethGateway).depositETH{value: amount}(lendingPool, address(this), referralCode);                                                                                                          │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                                            │
│         aToken = IWETHGateway(wethGateway).getAWETHAddress();                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //lock collateral                                                                                                                                                                                       │
│         IWETHGateway(wethGateway).depositETH{value: amount}(lendingPool, address(this), referralCode);                                                                                                          │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(address asset, uint256 amount) internal returns (address aToken, uint256 sharesReceived) {                                                                                           │
│         aToken = liquidityToken(asset);                                                                                                                                                                         │
│         uint256 aTokensBefore = IERC20(aToken).balanceOf(address(this));                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         //approve collateral to vault                                                                                                                                                                           │
│         IERC20(asset).approve(lendingPool, 0);                                                                                                                                                                  │
│         IERC20(asset).approve(lendingPool, amount);                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         AaveLendingPool(lendingPool).deposit(asset, amount, address(this), referralCode);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(aToken).balanceOf(address(this)).sub(aTokensBefore);                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(address asset, uint256 amount) internal returns (uint256 tokensReceived) {                                                                                                            │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 tokensBefore = IERC20(asset).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         IERC20(aToken).approve(lendingPool, amount);                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         //withdraw collateral from vault                                                                                                                                                                        │
│         AaveLendingPool(lendingPool).withdraw(asset, amount, address(this));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(tokensBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(address asset, uint256 amount) internal returns (uint256 tokensReceived) {                                                                                                            │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 tokensBefore = IERC20(asset).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         IERC20(aToken).approve(lendingPool, amount);                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         //withdraw collateral from vault                                                                                                                                                                        │
│         AaveLendingPool(lendingPool).withdraw(asset, amount, address(this));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(tokensBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(amount);                                                                                                                                                                    │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, amount);                                                                                                                                                             │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(address asset, uint256 amount) internal returns (uint256 tokensReceived) {                                                                                                            │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 tokensBefore = IERC20(asset).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         IERC20(aToken).approve(lendingPool, amount);                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         //withdraw collateral from vault                                                                                                                                                                        │
│         AaveLendingPool(lendingPool).withdraw(asset, amount, address(this));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(tokensBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(address asset, uint256 amount) internal returns (uint256 tokensReceived) {                                                                                                            │
│         address aToken = liquidityToken(asset);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address lendingPool = ILendingPoolAddressesProvider(lendingPoolAddressesProvider).getLendingPool();                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 tokensBefore = IERC20(asset).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         IERC20(aToken).approve(lendingPool, amount);                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         //withdraw collateral from vault                                                                                                                                                                        │
│         AaveLendingPool(lendingPool).withdraw(asset, amount, address(this));                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(tokensBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawBorrowAmount(                                                                                                                                                                             │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_lender, _asset, _strategyList[_index]);                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 tokenInStrategy = _liquidityShares;                                                                                                                                                     │
│                 tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                   │
│                 uint256 _tokensToTransfer = tokenInStrategy;                                                                                                                                                    │
│                 if (_activeAmount.add(tokenInStrategy) >= _amountInTokens) {                                                                                                                                    │
│                     _tokensToTransfer = (_amountInTokens.sub(_activeAmount));                                                                                                                                   │
│                 }                                                                                                                                                                                               │
│                 _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                           │
│                 _savingsAccount.withdrawFrom(_tokensToTransfer, _asset, _strategyList[_index], _lender, address(this), false);                                                                                  │
│                 if (_activeAmount == _amountInTokens) {                                                                                                                                                         │
│                     return;                                                                                                                                                                                     │
│                 }                                                                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         require(_activeAmount == _amountInTokens, 'insufficient balance');                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _repayFromSavingsAccount(                                                                                                                                                                          │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _asset,                                                                                                                                                                                         │
│         address _lender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             if (_strategyList[_index] == address(0)) {                                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(msg.sender, _asset, _strategyList[_index]);                                                                                              │
│             if (_liquidityShares == 0) {                                                                                                                                                                        │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList[_index]).getTokensForShares(_liquidityShares, _asset);                                                                                                      │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _asset, _strategyList[_index], msg.sender, _lender);                                                                                                │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_repayFromSavingsAccount - Insufficient balance');                                                                                                                                  │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function calculateTotalCollateralTokens(uint256 _id) public returns (uint256 _amount) {                                                                                                                     │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _liquidityShares;                                                                                                                                                                               │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             if (_strategyList == address(0)) {                                                                                                                                                                  │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             _liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                    │
│                                                                                                                                                                                                                 │
│             _amount = _amount.add(_tokenInStrategy);                                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function calculateTotalCollateralTokens(uint256 _id) public returns (uint256 _amount) {                                                                                                                     │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _liquidityShares;                                                                                                                                                                               │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             if (_strategyList == address(0)) {                                                                                                                                                                  │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             _liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                    │
│                                                                                                                                                                                                                 │
│             _amount = _amount.add(_tokenInStrategy);                                                                                                                                                            │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function liquidatePool(                                                                                                                                                                                     │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         LoanStatus _currentPoolStatus = poolVariables.loanStatus;                                                                                                                                               │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_currentPoolStatus == LoanStatus.ACTIVE, 'LP1');                                                                                                                                                │
│         require(IRepayment(_poolFactory.repaymentImpl()).didBorrowerDefault(address(this)), 'LP2');                                                                                                             │
│         poolVariables.loanStatus = LoanStatus.DEFAULTED;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                          │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _collateralTokens = _collateralLiquidityShare;                                                                                                                                                  │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralLiquidityShare, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _poolBorrowTokens = correspondingBorrowTokens(                                                                                                                                                  │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│         delete poolVariables.baseLiquidityShares;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _poolBorrowTokens, _poolFactory.noStrategyAddress(), msg.sender, address(this));                                                                     │
│         _withdraw(_toSavingsAccount, _recieveLiquidityShare, _collateralAsset, _poolSavingsStrategy, _collateralTokens);                                                                                        │
│         emit PoolLiquidated(msg.sender);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidatePool(                                                                                                                                                                                     │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         LoanStatus _currentPoolStatus = poolVariables.loanStatus;                                                                                                                                               │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_currentPoolStatus == LoanStatus.ACTIVE, 'LP1');                                                                                                                                                │
│         require(IRepayment(_poolFactory.repaymentImpl()).didBorrowerDefault(address(this)), 'LP2');                                                                                                             │
│         poolVariables.loanStatus = LoanStatus.DEFAULTED;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                          │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _collateralTokens = _collateralLiquidityShare;                                                                                                                                                  │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralLiquidityShare, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _poolBorrowTokens = correspondingBorrowTokens(                                                                                                                                                  │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│         delete poolVariables.baseLiquidityShares;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _poolBorrowTokens, _poolFactory.noStrategyAddress(), msg.sender, address(this));                                                                     │
│         _withdraw(_toSavingsAccount, _recieveLiquidityShare, _collateralAsset, _poolSavingsStrategy, _collateralTokens);                                                                                        │
│         emit PoolLiquidated(msg.sender);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawAllCollateral(address _receiver, uint256 _penalty) internal {                                                                                                                             │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         uint256 _collateralShares = 0;                                                                                                                                                                          │
│         if (poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares) > _penalty) {                                                                                                             │
│             _collateralShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares).sub(_penalty);                                                                                        │
│         }                                                                                                                                                                                                       │
│         // uint256 _collateralTokens = _collateralShares;                                                                                                                                                       │
│         uint256 _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralShares, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         poolVariables.baseLiquidityShares = _penalty;                                                                                                                                                           │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived;                                                                                                                                                                                │
│         if (_collateralShares != 0) {                                                                                                                                                                           │
│             ISavingsAccount _savingsAccount = ISavingsAccount(IPoolFactory(poolFactory).savingsAccount());                                                                                                      │
│             _sharesReceived = SavingsAccountUtil.savingsAccountTransfer(                                                                                                                                        │
│                 _savingsAccount,                                                                                                                                                                                │
│                 address(this),                                                                                                                                                                                  │
│                 _receiver,                                                                                                                                                                                      │
│                 _collateralTokens,                                                                                                                                                                              │
│                 _collateralAsset,                                                                                                                                                                               │
│                 _poolSavingsStrategy                                                                                                                                                                            │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         emit CollateralWithdrawn(_receiver, _sharesReceived);                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawAllCollateral(address _receiver, uint256 _penalty) internal {                                                                                                                             │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         uint256 _collateralShares = 0;                                                                                                                                                                          │
│         if (poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares) > _penalty) {                                                                                                             │
│             _collateralShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares).sub(_penalty);                                                                                        │
│         }                                                                                                                                                                                                       │
│         // uint256 _collateralTokens = _collateralShares;                                                                                                                                                       │
│         uint256 _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralShares, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         poolVariables.baseLiquidityShares = _penalty;                                                                                                                                                           │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived;                                                                                                                                                                                │
│         if (_collateralShares != 0) {                                                                                                                                                                           │
│             ISavingsAccount _savingsAccount = ISavingsAccount(IPoolFactory(poolFactory).savingsAccount());                                                                                                      │
│             _sharesReceived = SavingsAccountUtil.savingsAccountTransfer(                                                                                                                                        │
│                 _savingsAccount,                                                                                                                                                                                │
│                 address(this),                                                                                                                                                                                  │
│                 _receiver,                                                                                                                                                                                      │
│                 _collateralTokens,                                                                                                                                                                              │
│                 _collateralAsset,                                                                                                                                                                               │
│                 _poolSavingsStrategy                                                                                                                                                                            │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         emit CollateralWithdrawn(_receiver, _sharesReceived);                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getTotalTokens(address _user, address _token) external override returns (uint256 _totalTokens) {                                                                                                   │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│                                                                                                                                                                                                                 │
│         for (uint256 i = 0; i < _strategyList.length; i++) {                                                                                                                                                    │
│             uint256 _liquidityShares = balanceInShares[_user][_token][_strategyList];                                                                                                                           │
│                                                                                                                                                                                                                 │
│             if (_liquidityShares != 0) {                                                                                                                                                                        │
│                 uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                    │
│                 if (_strategyList != address(0)) {                                                                                                                                                              │
│                     _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _token);                                                                                                      │
│                 }                                                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│                 _totalTokens = _totalTokens.add(_tokenInStrategy);                                                                                                                                              │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getTokensForShares(uint256 shares, address asset) public override returns (uint256 amount) {                                                                                                       │
│         //balanceOfUnderlying returns underlying balance for total shares                                                                                                                                       │
│         if (shares == 0) return 0;                                                                                                                                                                              │
│         address cToken = liquidityToken;                                                                                                                                                                        │
│         amount = ICToken(cToken).balanceOfUnderlying(address(this)).mul(shares).div(IERC20(cToken).balanceOf(address(this)));                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositETH(address cToken, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                            │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         ICEther(cToken).mint{value: amount}();                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address cToken, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                            │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         ICEther(cToken).mint{value: amount}();                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address cToken, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                            │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         ICEther(cToken).mint{value: amount}();                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address cToken, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                            │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         ICEther(cToken).mint{value: amount}();                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         IERC20(asset).approve(cToken, 0);                                                                                                                                                                       │
│         IERC20(asset).approve(cToken, amount);                                                                                                                                                                  │
│         require(ICToken(cToken).mint(amount) == 0, 'Error in minting tokens');                                                                                                                                  │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         IERC20(asset).approve(cToken, 0);                                                                                                                                                                       │
│         IERC20(asset).approve(cToken, amount);                                                                                                                                                                  │
│         require(ICToken(cToken).mint(amount) == 0, 'Error in minting tokens');                                                                                                                                  │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         IERC20(asset).approve(cToken, 0);                                                                                                                                                                       │
│         IERC20(asset).approve(cToken, amount);                                                                                                                                                                  │
│         require(ICToken(cToken).mint(amount) == 0, 'Error in minting tokens');                                                                                                                                  │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         IERC20(asset).approve(cToken, 0);                                                                                                                                                                       │
│         IERC20(asset).approve(cToken, amount);                                                                                                                                                                  │
│         require(ICToken(cToken).mint(amount) == 0, 'Error in minting tokens');                                                                                                                                  │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 initialCTokenBalance = IERC20(cToken).balanceOf(address(this));                                                                                                                                 │
│         //mint cToken                                                                                                                                                                                           │
│         IERC20(asset).approve(cToken, 0);                                                                                                                                                                       │
│         IERC20(asset).approve(cToken, amount);                                                                                                                                                                  │
│         require(ICToken(cToken).mint(amount) == 0, 'Error in minting tokens');                                                                                                                                  │
│         sharesReceived = IERC20(cToken).balanceOf(address(this)).sub(initialCTokenBalance);                                                                                                                     │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│         require(ICToken(cToken).redeem(amount) == 0, 'Error in unwrapping');                                                                                                                                    │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│         require(ICToken(cToken).redeem(amount) == 0, 'Error in unwrapping');                                                                                                                                    │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(amount);                                                                                                                                                                    │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, amount);                                                                                                                                                             │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│         require(ICToken(cToken).redeem(amount) == 0, 'Error in unwrapping');                                                                                                                                    │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address cToken,                                                                                                                                                                                         │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│         require(ICToken(cToken).redeem(amount) == 0, 'Error in unwrapping');                                                                                                                                    │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function initialize(address _owner, uint256 _maxStrategies) external initializer {                                                                                                                          │
│         require(_maxStrategies != 0, 'StrategyRegistry::initialize maxStrategies cannot be zero');                                                                                                              │
│         __Ownable_init();                                                                                                                                                                                       │
│         super.transferOwnership(_owner);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         _updateMaxStrategies(_maxStrategies);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _updateMaxStrategies(uint256 _maxStrategies) internal {                                                                                                                                            │
│         require(_maxStrategies != 0, 'StrategyRegistry::updateMaxStrategies should be more than zero');                                                                                                         │
│         maxStrategies = _maxStrategies;                                                                                                                                                                         │
│         emit MaxStrategiesUpdated(_maxStrategies);                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositETH(address vault, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                             │
│         uint256 initialTokenBalance = IERC20(vault).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         //mint vault                                                                                                                                                                                            │
│         IyVault(vault).depositETH{value: amount}();                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(initialTokenBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address vault, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                             │
│         uint256 initialTokenBalance = IERC20(vault).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         //mint vault                                                                                                                                                                                            │
│         IyVault(vault).depositETH{value: amount}();                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(initialTokenBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address vault, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                             │
│         uint256 initialTokenBalance = IERC20(vault).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         //mint vault                                                                                                                                                                                            │
│         IyVault(vault).depositETH{value: amount}();                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(initialTokenBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositETH(address vault, uint256 amount) internal returns (uint256 sharesReceived) {                                                                                                             │
│         uint256 initialTokenBalance = IERC20(vault).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         //mint vault                                                                                                                                                                                            │
│         IyVault(vault).depositETH{value: amount}();                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(initialTokenBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         address investedTo;                                                                                                                                                                                     │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             (investedTo, sharesReceived) = _depositETH(amount);                                                                                                                                                 │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             (investedTo, sharesReceived) = _depositERC20(asset, amount);                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function lockTokens(                                                                                                                                                                                        │
│         address user,                                                                                                                                                                                           │
│         address asset,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) external payable override onlySavingsAccount nonReentrant returns (uint256 sharesReceived) {                                                                                                              │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             require(msg.value == amount, 'Invest: ETH amount');                                                                                                                                                 │
│             sharesReceived = _depositETH(investedTo, amount);                                                                                                                                                   │
│         } else {                                                                                                                                                                                                │
│             IERC20(asset).safeTransferFrom(user, address(this), amount);                                                                                                                                        │
│             sharesReceived = _depositERC20(asset, investedTo, amount);                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         emit LockedTokens(user, investedTo, sharesReceived);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│     function _depositERC20(                                                                                                                                                                                     │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 sharesReceived) {                                                                                                                                                               │
│         uint256 sharesBefore = IERC20(vault).balanceOf(address(this));                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //lock collateral in vault                                                                                                                                                                              │
│         IERC20(asset).approve(vault, 0);                                                                                                                                                                        │
│         IERC20(asset).approve(vault, amount);                                                                                                                                                                   │
│         IyVault(vault).deposit(amount);                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         sharesReceived = IERC20(vault).balanceOf(address(this)).sub(sharesBefore);                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(amount);                                                                                                                                                                    │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, amount);                                                                                                                                                             │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function unlockTokens(address asset, uint256 amount) external override onlySavingsAccount nonReentrant returns (uint256 received) {                                                                         │
│         require(amount != 0, 'Invest: amount');                                                                                                                                                                 │
│         address investedTo = liquidityToken;                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (asset == address(0)) {                                                                                                                                                                              │
│             received = _withdrawETH(investedTo, amount);                                                                                                                                                        │
│             (bool success, ) = savingsAccount.call{value: received}('');                                                                                                                                        │
│             require(success, 'Transfer failed');                                                                                                                                                                │
│         } else {                                                                                                                                                                                                │
│             received = _withdrawERC(asset, investedTo, amount);                                                                                                                                                 │
│             IERC20(asset).safeTransfer(savingsAccount, received);                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit UnlockedTokens(asset, received);                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function _withdrawERC(                                                                                                                                                                                      │
│         address asset,                                                                                                                                                                                          │
│         address vault,                                                                                                                                                                                          │
│         uint256 amount                                                                                                                                                                                          │
│     ) internal returns (uint256 tokensReceived) {                                                                                                                                                               │
│         uint256 initialAssetBalance = IERC20(asset).balanceOf(address(this));                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         IyVault(vault).withdraw(amount);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         tokensReceived = IERC20(asset).balanceOf(address(this)).sub(initialAssetBalance);                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function initialize(                                                                                                                                                                                        │
│         address _owner,                                                                                                                                                                                         │
│         address _strategyRegistry,                                                                                                                                                                              │
│         address _creditLine                                                                                                                                                                                     │
│     ) external initializer {                                                                                                                                                                                    │
│         __Ownable_init();                                                                                                                                                                                       │
│         super.transferOwnership(_owner);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         _updateCreditLine(_creditLine);                                                                                                                                                                         │
│         _updateStrategyRegistry(_strategyRegistry);                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _updateStrategyRegistry(address _strategyRegistry) internal {                                                                                                                                      │
│         require(_strategyRegistry != address(0), 'SavingsAccount::updateStrategyRegistry zero address');                                                                                                        │
│         strategyRegistry = _strategyRegistry;                                                                                                                                                                   │
│         emit StrategyRegistryUpdated(_strategyRegistry);                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function deposit(                                                                                                                                                                                           │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _token,                                                                                                                                                                                         │
│         address _strategy,                                                                                                                                                                                      │
│         address _to                                                                                                                                                                                             │
│     ) external payable override nonReentrant returns (uint256) {                                                                                                                                                │
│         require(_to != address(0), 'SavingsAccount::deposit receiver address should not be zero address');                                                                                                      │
│         uint256 _sharesReceived = _deposit(_amount, _token, _strategy);                                                                                                                                         │
│         balanceInShares[_to][_token][_strategy] = balanceInShares[_to][_token][_strategy].add(_sharesReceived);                                                                                                 │
│         emit Deposited(_to, _sharesReceived, _token, _strategy);                                                                                                                                                │
│         return _sharesReceived;                                                                                                                                                                                 │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function switchStrategy(                                                                                                                                                                                    │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _token,                                                                                                                                                                                         │
│         address _currentStrategy,                                                                                                                                                                               │
│         address _newStrategy                                                                                                                                                                                    │
│     ) external override nonReentrant {                                                                                                                                                                          │
│         require(_currentStrategy != _newStrategy, 'SavingsAccount::switchStrategy Same strategy');                                                                                                              │
│         require(IStrategyRegistry(strategyRegistry).registry(_newStrategy), 'SavingsAccount::_newStrategy do not exist');                                                                                       │
│         require(_amount != 0, 'SavingsAccount::switchStrategy Amount must be greater than zero');                                                                                                               │
│                                                                                                                                                                                                                 │
│         _amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(                                                                                                              │
│             _amount,                                                                                                                                                                                            │
│             'SavingsAccount::switchStrategy Insufficient balance'                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 _tokensReceived = IYield(_currentStrategy).unlockTokens(_token, _amount);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _ethValue;                                                                                                                                                                                      │
│         if (_token != address(0)) {                                                                                                                                                                             │
│             IERC20(_token).safeApprove(_newStrategy, _tokensReceived);                                                                                                                                          │
│         } else {                                                                                                                                                                                                │
│             _ethValue = _tokensReceived;                                                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│         _amount = _tokensReceived;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = IYield(_newStrategy).lockTokens{value: _ethValue}(address(this), _token, _tokensReceived);                                                                                    │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_newStrategy] = balanceInShares[_token][_newStrategy].add(_sharesReceived);                                                                                                     │
│         emit StrategySwitched(msg.sender, _token, _amount, _sharesReceived, _currentStrategy, _newStrategy);                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "Yes"                                                                                                                                                                                                            │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                                │
│ Code:                                                                                                                                                                                                                     │
│     function switchStrategy(                                                                                                                                                                                              │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _currentStrategy,                                                                                                                                                                                         │
│         address _newStrategy                                                                                                                                                                                              │
│     ) external override nonReentrant {                                                                                                                                                                                    │
│         require(_currentStrategy != _newStrategy, 'SavingsAccount::switchStrategy Same strategy');                                                                                                                        │
│         require(IStrategyRegistry(strategyRegistry).registry(_newStrategy), 'SavingsAccount::_newStrategy do not exist');                                                                                                 │
│         require(_amount != 0, 'SavingsAccount::switchStrategy Amount must be greater than zero');                                                                                                                         │
│                                                                                                                                                                                                                           │
│         _amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);                                                                                                                                           │
│                                                                                                                                                                                                                           │
│         balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(                                                                                                                        │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::switchStrategy Insufficient balance'                                                                                                                                                         │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         uint256 _tokensReceived = IYield(_currentStrategy).unlockTokens(_token, _amount);                                                                                                                                 │
│                                                                                                                                                                                                                           │
│         uint256 _ethValue;                                                                                                                                                                                                │
│         if (_token != address(0)) {                                                                                                                                                                                       │
│             IERC20(_token).safeApprove(_newStrategy, _tokensReceived);                                                                                                                                                    │
│         } else {                                                                                                                                                                                                          │
│             _ethValue = _tokensReceived;                                                                                                                                                                                  │
│         }                                                                                                                                                                                                                 │
│         _amount = _tokensReceived;                                                                                                                                                                                        │
│                                                                                                                                                                                                                           │
│         uint256 _sharesReceived = IYield(_newStrategy).lockTokens{value: _ethValue}(address(this), _token, _tokensReceived);                                                                                              │
│                                                                                                                                                                                                                           │
│         balanceInShares[_token][_newStrategy] = balanceInShares[_token][_newStrategy].add(_sharesReceived);                                                                                                               │
│         emit StrategySwitched(msg.sender, _token, _amount, _sharesReceived, _currentStrategy, _newStrategy);                                                                                                              │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                                       │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function withdraw(                                                                                                                                                                                                    │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _strategy,                                                                                                                                                                                                │
│         address payable _to,                                                                                                                                                                                              │
│         bool _withdrawShares                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256) {                                                                                                                                                                  │
│         require(_amount != 0, 'SavingsAccount::withdraw Amount must be greater than zero');                                                                                                                               │
│                                                                                                                                                                                                                           │
│         _amount = IYield(_strategy).getSharesForTokens(_amount, _token);                                                                                                                                                  │
│                                                                                                                                                                                                                           │
│         balanceInShares[_token][_strategy] = balanceInShares[_token][_strategy].sub(                                                                                                                                      │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::withdraw Insufficient amount'                                                                                                                                                                │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         (address _receivedToken, uint256 _amountReceived) = _withdraw(_amount, _token, _strategy, _to, _withdrawShares);                                                                                                  │
│                                                                                                                                                                                                                           │
│         emit Withdrawn(msg.sender, _to, _amount, _token, _strategy, _withdrawShares);                                                                                                                                     │
│         return _amountReceived;                                                                                                                                                                                           │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function withdrawFrom(                                                                                                                                                                                                │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _strategy,                                                                                                                                                                                                │
│         address _from,                                                                                                                                                                                                    │
│         address payable _to,                                                                                                                                                                                              │
│         bool _withdrawShares                                                                                                                                                                                              │
│     ) external override nonReentrant returns (uint256) {                                                                                                                                                                  │
│         require(_amount != 0, 'SavingsAccount::withdrawFrom Amount must be greater than zero');                                                                                                                           │
│                                                                                                                                                                                                                           │
│         allowance[_from][_token] = allowance[_from][_token].sub(                                                                                                                                                          │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::withdrawFrom allowance limit exceeding'                                                                                                                                                      │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         _amount = IYield(_strategy).getSharesForTokens(_amount, _token);                                                                                                                                                  │
│                                                                                                                                                                                                                           │
│         balanceInShares[_from][_token][_strategy] = balanceInShares[_from][_token][_strategy].sub(                                                                                                                        │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::withdrawFrom insufficient balance'                                                                                                                                                           │
│         );                                                                                                                                                                                                                │
│         (address _receivedToken, uint256 _amountReceived) = _withdraw(_amount, _token, _strategy, _to, _withdrawShares);                                                                                                  │
│         emit Withdrawn(_from, msg.sender, _amount, _token, _strategy, _withdrawShares);                                                                                                                                   │
│         return _amountReceived;                                                                                                                                                                                           │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function _withdraw(                                                                                                                                                                                                   │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _strategy,                                                                                                                                                                                                │
│         address payable _to,                                                                                                                                                                                              │
│         bool _withdrawShares                                                                                                                                                                                              │
│     ) internal returns (address _tokenReceived, uint256 _amountReceived) {                                                                                                                                                │
│         if (_withdrawShares) {                                                                                                                                                                                            │
│             _tokenReceived = IYield(_strategy).liquidityToken(_token);                                                                                                                                                    │
│             require(_tokenReceived != address(0), 'Liquidity Tokens address cannot be address(0)');                                                                                                                       │
│             _amountReceived = IYield(_strategy).unlockShares(_tokenReceived, _amount);                                                                                                                                    │
│         } else {                                                                                                                                                                                                          │
│             _tokenReceived = _token;                                                                                                                                                                                      │
│             _amountReceived = IYield(_strategy).unlockTokens(_token, _amount);                                                                                                                                            │
│         }                                                                                                                                                                                                                 │
│         _transfer(_amountReceived, _tokenReceived, _to);                                                                                                                                                                  │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function withdrawAll(address _token, address _strategy) external override nonReentrant returns (uint256 _tokenReceived) {                                                                                             │
│         uint256 _sharesBalance = balanceInShares[_token][_strategy];                                                                                                                                                      │
│                                                                                                                                                                                                                           │
│         if(_sharesBalance == 0) return 0;                                                                                                                                                                                 │
│                                                                                                                                                                                                                           │
│         uint256 _amount = IYield(_strategy).unlockTokens(_token, _sharesBalance);                                                                                                                                         │
│                                                                                                                                                                                                                           │
│         delete balanceInShares[_token][_strategy];                                                                                                                                                                        │
│                                                                                                                                                                                                                           │
│         _transfer(_amount, _token, payable(msg.sender));                                                                                                                                                                  │
│                                                                                                                                                                                                                           │
│         emit Withdrawn(msg.sender, msg.sender, _amount, _token, _strategy, false);                                                                                                                                        │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: involve transfering token from an address different from message sender                                                                                                                                        │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                                    │
│ Code:                                                                                                                                                                                                                     │
│     function transfer(                                                                                                                                                                                                    │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _strategy,                                                                                                                                                                                                │
│         address _to                                                                                                                                                                                                       │
│     ) external override returns (uint256) {                                                                                                                                                                               │
│         require(_amount != 0, 'SavingsAccount::transfer zero amount');                                                                                                                                                    │
│                                                                                                                                                                                                                           │
│         if (_strategy != address(0)) {                                                                                                                                                                                    │
│             _amount = IYield(_strategy).getSharesForTokens(_amount, _token);                                                                                                                                              │
│         }                                                                                                                                                                                                                 │
│                                                                                                                                                                                                                           │
│         balanceInShares[_token][_strategy] = balanceInShares[_token][_strategy].sub(                                                                                                                                      │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::transfer insufficient funds'                                                                                                                                                                 │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         //update receiver's balance                                                                                                                                                                                       │
│         balanceInShares[_to][_token][_strategy] = balanceInShares[_to][_token][_strategy].add(_amount);                                                                                                                   │
│                                                                                                                                                                                                                           │
│         emit Transfer(_token, _strategy, msg.sender, _to, _amount);                                                                                                                                                       │
│                                                                                                                                                                                                                           │
│         return _amount;                                                                                                                                                                                                   │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No",                                                                                                                                                                                                            │
│     "2": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function transferFrom(                                                                                                                                                                                                │
│         uint256 _amount,                                                                                                                                                                                                  │
│         address _token,                                                                                                                                                                                                   │
│         address _strategy,                                                                                                                                                                                                │
│         address _from,                                                                                                                                                                                                    │
│         address _to                                                                                                                                                                                                       │
│     ) external override returns (uint256) {                                                                                                                                                                               │
│         require(_amount != 0, 'SavingsAccount::transferFrom zero amount');                                                                                                                                                │
│         //update allowance                                                                                                                                                                                                │
│         allowance[_from][_token] = allowance[_from][_token].sub(                                                                                                                                                          │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::transferFrom allowance limit exceeding'                                                                                                                                                      │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         if (_strategy != address(0)) {                                                                                                                                                                                    │
│             _amount = IYield(_strategy).getSharesForTokens(_amount, _token);                                                                                                                                              │
│         }                                                                                                                                                                                                                 │
│                                                                                                                                                                                                                           │
│         //reduce sender's balance                                                                                                                                                                                         │
│         balanceInShares[_from][_token][_strategy] = balanceInShares[_from][_token][_strategy].sub(                                                                                                                        │
│             _amount,                                                                                                                                                                                                      │
│             'SavingsAccount::transferFrom insufficient allowance'                                                                                                                                                         │
│         );                                                                                                                                                                                                                │
│                                                                                                                                                                                                                           │
│         //update receiver's balance                                                                                                                                                                                       │
│         balanceInShares[_to][_token][_strategy] = (balanceInShares[_to][_token][_strategy]).add(_amount);                                                                                                                 │
│                                                                                                                                                                                                                           │
│         emit Transfer(_token, _strategy, _from, _to, _amount);                                                                                                                                                            │
│                                                                                                                                                                                                                           │
│         return _amount;                                                                                                                                                                                                   │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                          │
│ Code:                                                                                                                                                                                                                     │
│     function getTotalTokens(address _user, address _token) external override returns (uint256 _totalTokens) {                                                                                                             │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                             │
│                                                                                                                                                                                                                           │
│         for (uint256 i = 0; i < _strategyList.length; i++) {                                                                                                                                                              │
│             uint256 _liquidityShares = balanceInShares[_user][_token][_strategyList];                                                                                                                                     │
│                                                                                                                                                                                                                           │
│             if (_liquidityShares != 0) {                                                                                                                                                                                  │
│                 uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                              │
│                 if (_strategyList != address(0)) {                                                                                                                                                                        │
│                     _tokenInStrategy = IYield(_strategyList).getTokensForShares(_liquidityShares, _token);                                                                                                                │
│                 }                                                                                                                                                                                                         │
│                                                                                                                                                                                                                           │
│                 _totalTokens = _totalTokens.add(_tokenInStrategy);                                                                                                                                                        │
│             }                                                                                                                                                                                                             │
│         }                                                                                                                                                                                                                 │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No",                                                                                                                                                                                                            │
│     "2": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function initialize(                                                                                                                                                                                                  │
│         address _admin,                                                                                                                                                                                                   │
│         uint256 _collectionPeriod,                                                                                                                                                                                        │
│         uint256 _loanWithdrawalDuration,                                                                                                                                                                                  │
│         uint256 _marginCallDuration,                                                                                                                                                                                      │
│         bytes4 _poolInitFuncSelector,                                                                                                                                                                                     │
│         uint256 _liquidatorRewardFraction,                                                                                                                                                                                │
│         uint256 _poolCancelPenaltyMultiple,                                                                                                                                                                               │
│         uint256 _minBorrowFraction,                                                                                                                                                                                       │
│         uint256 _protocolFeeFraction,                                                                                                                                                                                     │
│         address _protocolFeeCollector,                                                                                                                                                                                    │
│         address _noStrategy                                                                                                                                                                                               │
│     ) external initializer {                                                                                                                                                                                              │
│         {                                                                                                                                                                                                                 │
│             OwnableUpgradeable.__Ownable_init();                                                                                                                                                                          │
│             OwnableUpgradeable.transferOwnership(_admin);                                                                                                                                                                 │
│         }                                                                                                                                                                                                                 │
│         _updateCollectionPeriod(_collectionPeriod);                                                                                                                                                                       │
│         _updateLoanWithdrawalDuration(_loanWithdrawalDuration);                                                                                                                                                           │
│         _updateMarginCallDuration(_marginCallDuration);                                                                                                                                                                   │
│         _updatepoolInitFuncSelector(_poolInitFuncSelector);                                                                                                                                                               │
│         _updateLiquidatorRewardFraction(_liquidatorRewardFraction);                                                                                                                                                       │
│         _updatePoolCancelPenaltyMultiple(_poolCancelPenaltyMultiple);                                                                                                                                                     │
│         _updateMinBorrowFraction(_minBorrowFraction);                                                                                                                                                                     │
│         _updateProtocolFeeFraction(_protocolFeeFraction);                                                                                                                                                                 │
│         _updateProtocolFeeCollector(_protocolFeeCollector);                                                                                                                                                               │
│         _updateNoStrategy(_noStrategy);                                                                                                                                                                                   │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function createPool(                                                                                                                                                                                                  │
│         uint256 _poolSize,                                                                                                                                                                                                │
│         uint256 _borrowRate,                                                                                                                                                                                              │
│         address _borrowToken,                                                                                                                                                                                             │
│         address _collateralToken,                                                                                                                                                                                         │
│         uint256 _idealCollateralRatio,                                                                                                                                                                                    │
│         uint256 _repaymentInterval,                                                                                                                                                                                       │
│         uint256 _noOfRepaymentIntervals,                                                                                                                                                                                  │
│         address _poolSavingsStrategy,                                                                                                                                                                                     │
│         uint256 _collateralAmount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount,                                                                                                                                                                                 │
│         bytes32 _salt,                                                                                                                                                                                                    │
│         address _verifier,                                                                                                                                                                                                │
│         address _lenderVerifier                                                                                                                                                                                           │
│     ) external payable onlyBorrower(_verifier) {                                                                                                                                                                          │
│         if (_collateralToken == address(0)) {                                                                                                                                                                             │
│             require(msg.value == _collateralAmount, 'PoolFactory::createPool - Ether send is different from collateral amount specified');                                                                                │
│         }                                                                                                                                                                                                                 │
│         require(_borrowToken != _collateralToken, 'PoolFactory::createPool - cant borrow the asset put in as collateralToken');                                                                                           │
│         require(isBorrowToken[_borrowToken], 'PoolFactory::createPool - Invalid borrow token type');                                                                                                                      │
│         require(isCollateralToken[_collateralToken], 'PoolFactory::createPool - Invalid collateral token type');                                                                                                          │
│         require(                                                                                                                                                                                                          │
│             IPriceOracle(priceOracle).doesFeedExist(_collateralToken, _borrowToken),                                                                                                                                      │
│             "PoolFactory::createPool - Price feed doesn't support token pair"                                                                                                                                             │
│         );                                                                                                                                                                                                                │
│         require(IStrategyRegistry(strategyRegistry).registry(_poolSavingsStrategy), 'PoolFactory::createPool - Invalid strategy');                                                                                        │
│         require(isWithinLimits(_poolSize, poolSizeLimit.min, poolSizeLimit.max), 'PoolFactory::createPool - PoolSize not within limits');                                                                                 │
│         require(                                                                                                                                                                                                          │
│             isWithinLimits(_idealCollateralRatio, idealCollateralRatioLimit.min, idealCollateralRatioLimit.max),                                                                                                          │
│             'PoolFactory::createPool - Collateral Ratio not within limits'                                                                                                                                                │
│         );                                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                          │
│             isWithinLimits(_borrowRate, borrowRateLimit.min, borrowRateLimit.max),                                                                                                                                        │
│             'PoolFactory::createPool - Borrow rate not within limits'                                                                                                                                                     │
│         );                                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                          │
│             isWithinLimits(_noOfRepaymentIntervals, noOfRepaymentIntervalsLimit.min, noOfRepaymentIntervalsLimit.max),                                                                                                    │
│             'PoolFactory::createPool - Loan duration not within limits'                                                                                                                                                   │
│         );                                                                                                                                                                                                                │
│         require(                                                                                                                                                                                                          │
│             isWithinLimits(_repaymentInterval, repaymentIntervalLimit.min, repaymentIntervalLimit.max),                                                                                                                   │
│             'PoolFactory::createPool - Repayment interval not within limits'                                                                                                                                              │
│         );                                                                                                                                                                                                                │
│         _createPool(                                                                                                                                                                                                      │
│             _poolSize,                                                                                                                                                                                                    │
│             _borrowRate,                                                                                                                                                                                                  │
│             _borrowToken,                                                                                                                                                                                                 │
│             _collateralToken,                                                                                                                                                                                             │
│             _idealCollateralRatio,                                                                                                                                                                                        │
│             _repaymentInterval,                                                                                                                                                                                           │
│             _noOfRepaymentIntervals,                                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                                         │
│             _collateralAmount,                                                                                                                                                                                            │
│             _transferFromSavingsAccount,                                                                                                                                                                                  │
│             _salt,                                                                                                                                                                                                        │
│             _lenderVerifier                                                                                                                                                                                               │
│         );                                                                                                                                                                                                                │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function _createPool(                                                                                                                                                                                                 │
│         uint256 _poolSize,                                                                                                                                                                                                │
│         uint256 _borrowRate,                                                                                                                                                                                              │
│         address _borrowToken,                                                                                                                                                                                             │
│         address _collateralToken,                                                                                                                                                                                         │
│         uint256 _idealCollateralRatio,                                                                                                                                                                                    │
│         uint256 _repaymentInterval,                                                                                                                                                                                       │
│         uint256 _noOfRepaymentIntervals,                                                                                                                                                                                  │
│         address _poolSavingsStrategy,                                                                                                                                                                                     │
│         uint256 _collateralAmount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount,                                                                                                                                                                                 │
│         bytes32 _salt,                                                                                                                                                                                                    │
│         address _lenderVerifier                                                                                                                                                                                           │
│     ) internal {                                                                                                                                                                                                          │
│         bytes memory data = _encodePoolInitCall(                                                                                                                                                                          │
│             _poolSize,                                                                                                                                                                                                    │
│             _borrowRate,                                                                                                                                                                                                  │
│             _borrowToken,                                                                                                                                                                                                 │
│             _collateralToken,                                                                                                                                                                                             │
│             _idealCollateralRatio,                                                                                                                                                                                        │
│             _repaymentInterval,                                                                                                                                                                                           │
│             _noOfRepaymentIntervals,                                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                                         │
│             _collateralAmount,                                                                                                                                                                                            │
│             _transferFromSavingsAccount,                                                                                                                                                                                  │
│             _lenderVerifier                                                                                                                                                                                               │
│         );                                                                                                                                                                                                                │
│         bytes32 salt = keccak256(abi.encodePacked(_salt, msg.sender));                                                                                                                                                    │
│         bytes memory bytecode = abi.encodePacked(type(SublimeProxy).creationCode, abi.encode(poolImpl, address(0x01), data));                                                                                             │
│         uint256 amount = _collateralToken == address(0) ? _collateralAmount : 0;                                                                                                                                          │
│                                                                                                                                                                                                                           │
│         address pool = _deploy(amount, salt, bytecode);                                                                                                                                                                   │
│                                                                                                                                                                                                                           │
│         poolRegistry = true;                                                                                                                                                                                              │
│         emit PoolCreated(pool, msg.sender);                                                                                                                                                                               │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function initialize(                                                                                                                                                                                                  │
│         uint256 _borrowAmountRequested,                                                                                                                                                                                   │
│         uint256 _borrowRate,                                                                                                                                                                                              │
│         address _borrower,                                                                                                                                                                                                │
│         address _borrowAsset,                                                                                                                                                                                             │
│         address _collateralAsset,                                                                                                                                                                                         │
│         uint256 _idealCollateralRatio,                                                                                                                                                                                    │
│         uint256 _repaymentInterval,                                                                                                                                                                                       │
│         uint256 _noOfRepaymentIntervals,                                                                                                                                                                                  │
│         address _poolSavingsStrategy,                                                                                                                                                                                     │
│         uint256 _collateralAmount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount,                                                                                                                                                                                 │
│         address _lenderVerifier,                                                                                                                                                                                          │
│         uint256 _loanWithdrawalDuration,                                                                                                                                                                                  │
│         uint256 _collectionPeriod                                                                                                                                                                                         │
│     ) external payable initializer {                                                                                                                                                                                      │
│         poolFactory = msg.sender;                                                                                                                                                                                         │
│         poolConstants.borrowAsset = _borrowAsset;                                                                                                                                                                         │
│         poolConstants.idealCollateralRatio = _idealCollateralRatio;                                                                                                                                                       │
│         poolConstants.collateralAsset = _collateralAsset;                                                                                                                                                                 │
│         poolConstants.poolSavingsStrategy = _poolSavingsStrategy;                                                                                                                                                         │
│         poolConstants.borrowAmountRequested = _borrowAmountRequested;                                                                                                                                                     │
│         _initialDeposit(_borrower, _collateralAmount, _transferFromSavingsAccount);                                                                                                                                       │
│         poolConstants.borrower = _borrower;                                                                                                                                                                               │
│         poolConstants.borrowRate = _borrowRate;                                                                                                                                                                           │
│         poolConstants.noOfRepaymentIntervals = _noOfRepaymentIntervals;                                                                                                                                                   │
│         poolConstants.repaymentInterval = _repaymentInterval;                                                                                                                                                             │
│         poolConstants.lenderVerifier = _lenderVerifier;                                                                                                                                                                   │
│                                                                                                                                                                                                                           │
│         poolConstants.loanStartTime = block.timestamp.add(_collectionPeriod);                                                                                                                                             │
│         poolConstants.loanWithdrawalDeadline = block.timestamp.add(_collectionPeriod).add(_loanWithdrawalDuration);                                                                                                       │
│         __ERC20_init('Pool Tokens', 'PT');                                                                                                                                                                                │
│         try ERC20Upgradeable(_borrowAsset).decimals() returns(uint8 _decimals) {                                                                                                                                          │
│             _setupDecimals(_decimals);                                                                                                                                                                                    │
│         } catch(bytes memory) {}                                                                                                                                                                                          │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                              │
│ Code:                                                                                                                                                                                                                     │
│     function depositCollateral(uint256 _amount, bool _transferFromSavingsAccount) external payable override {                                                                                                             │
│         require(_amount != 0, 'DC1');                                                                                                                                                                                     │
│         require(balanceOf(msg.sender) == 0, 'DC2');                                                                                                                                                                       │
│         _depositCollateral(msg.sender, _amount, _transferFromSavingsAccount);                                                                                                                                             │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────────────── Response ─────────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                                         │
│     "1": "No"                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                                         │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                                         │
│ Code:                                                                                                                                                                                                                     │
│     function _depositCollateral(                                                                                                                                                                                          │
│         address _depositor,                                                                                                                                                                                               │
│         uint256 _amount,                                                                                                                                                                                                  │
│         bool _transferFromSavingsAccount                                                                                                                                                                                  │
│     ) internal nonReentrant {                                                                                                                                                                                             │
│         uint256 _sharesReceived = _deposit(                                                                                                                                                                               │
│             _transferFromSavingsAccount,                                                                                                                                                                                  │
│             true,                                                                                                                                                                                                         │
│             poolConstants.collateralAsset,                                                                                                                                                                                │
│             _amount,                                                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                            │
│             _depositor,                                                                                                                                                                                                   │
│             address(this)                                                                                                                                                                                                 │
│         );                                                                                                                                                                                                                │
│         poolVariables.baseLiquidityShares = poolVariables.baseLiquidityShares.add(_sharesReceived);                                                                                                                       │
│         emit CollateralAdded(_depositor, _amount, _sharesReceived);                                                                                                                                                       │
│     }                                                                                                                                                                                                                     │
╰───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ Code:                                                                                                                                                                                                           │
│     function addCollateralInMarginCall(                                                                                                                                                                         │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount                                                                                                                                                                        │
│     ) external payable override nonReentrant {                                                                                                                                                                  │
│         require(poolVariables.loanStatus == LoanStatus.ACTIVE, 'ACMC1');                                                                                                                                        │
│         require(balanceOf(msg.sender) == 0, 'ACMC2');                                                                                                                                                           │
│         require(getMarginCallEndTime(_lender) >= block.timestamp, 'ACMC3');                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         require(_amount != 0, 'ACMC4');                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = _deposit(                                                                                                                                                                     │
│             _transferFromSavingsAccount,                                                                                                                                                                        │
│             true,                                                                                                                                                                                               │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _amount,                                                                                                                                                                                            │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.add(_sharesReceived);                                                                                                           │
│                                                                                                                                                                                                                 │
│         lenders[_lender].extraLiquidityShares = lenders[_lender].extraLiquidityShares.add(_sharesReceived);                                                                                                     │
│                                                                                                                                                                                                                 │
│         if (getCurrentCollateralRatio(_lender) >= poolConstants.idealCollateralRatio) {                                                                                                                         │
│             delete lenders[_lender].marginCallEndTime;                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit MarginCallCollateralAdded(msg.sender, _lender, _amount, _sharesReceived);                                                                                                                          │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawBorrowedAmount() external override onlyBorrower(msg.sender) nonReentrant {                                                                                                                 │
│         LoanStatus _poolStatus = poolVariables.loanStatus;                                                                                                                                                      │
│         uint256 _tokensLent = totalSupply();                                                                                                                                                                    │
│         require(                                                                                                                                                                                                │
│             _poolStatus == LoanStatus.COLLECTION &&                                                                                                                                                             │
│                 poolConstants.loanStartTime < block.timestamp &&                                                                                                                                                │
│                 block.timestamp < poolConstants.loanWithdrawalDeadline,                                                                                                                                         │
│             'WBA1'                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_tokensLent >= _poolFactory.minBorrowFraction().mul(poolConstants.borrowAmountRequested).div(10**30), 'WBA2');                                                                                  │
│                                                                                                                                                                                                                 │
│         poolVariables.loanStatus = LoanStatus.ACTIVE;                                                                                                                                                           │
│         uint256 _currentCollateralRatio = getCurrentCollateralRatio();                                                                                                                                          │
│         require(_currentCollateralRatio >= poolConstants.idealCollateralRatio, 'WBA3');                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _noOfRepaymentIntervals = poolConstants.noOfRepaymentIntervals;                                                                                                                                 │
│         uint256 _repaymentInterval = poolConstants.repaymentInterval;                                                                                                                                           │
│         IRepayment(_poolFactory.repaymentImpl()).initializeRepayment(                                                                                                                                           │
│             _noOfRepaymentIntervals,                                                                                                                                                                            │
│             _repaymentInterval,                                                                                                                                                                                 │
│             poolConstants.borrowRate,                                                                                                                                                                           │
│             poolConstants.loanStartTime,                                                                                                                                                                        │
│             poolConstants.borrowAsset                                                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│         IExtension(_poolFactory.extension()).initializePoolExtension(_repaymentInterval);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         (uint256 _protocolFeeFraction, address _collector) = _poolFactory.getProtocolFeeData();                                                                                                                 │
│         uint256 _protocolFee = _tokensLent.mul(_protocolFeeFraction).div(10**30);                                                                                                                               │
│         delete poolConstants.loanWithdrawalDeadline;                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _feeAdjustedWithdrawalAmount = _tokensLent.sub(_protocolFee);                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _protocolFee, address(this), _collector);                                                                                                               │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _feeAdjustedWithdrawalAmount, address(this), msg.sender);                                                                                               │
│                                                                                                                                                                                                                 │
│         emit AmountBorrowed(_feeAdjustedWithdrawalAmount, _protocolFee);                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function withdrawBorrowedAmount() external override onlyBorrower(msg.sender) nonReentrant {                                                                                                                 │
│         LoanStatus _poolStatus = poolVariables.loanStatus;                                                                                                                                                      │
│         uint256 _tokensLent = totalSupply();                                                                                                                                                                    │
│         require(                                                                                                                                                                                                │
│             _poolStatus == LoanStatus.COLLECTION &&                                                                                                                                                             │
│                 poolConstants.loanStartTime < block.timestamp &&                                                                                                                                                │
│                 block.timestamp < poolConstants.loanWithdrawalDeadline,                                                                                                                                         │
│             'WBA1'                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_tokensLent >= _poolFactory.minBorrowFraction().mul(poolConstants.borrowAmountRequested).div(10**30), 'WBA2');                                                                                  │
│                                                                                                                                                                                                                 │
│         poolVariables.loanStatus = LoanStatus.ACTIVE;                                                                                                                                                           │
│         uint256 _currentCollateralRatio = getCurrentCollateralRatio();                                                                                                                                          │
│         require(_currentCollateralRatio >= poolConstants.idealCollateralRatio, 'WBA3');                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _noOfRepaymentIntervals = poolConstants.noOfRepaymentIntervals;                                                                                                                                 │
│         uint256 _repaymentInterval = poolConstants.repaymentInterval;                                                                                                                                           │
│         IRepayment(_poolFactory.repaymentImpl()).initializeRepayment(                                                                                                                                           │
│             _noOfRepaymentIntervals,                                                                                                                                                                            │
│             _repaymentInterval,                                                                                                                                                                                 │
│             poolConstants.borrowRate,                                                                                                                                                                           │
│             poolConstants.loanStartTime,                                                                                                                                                                        │
│             poolConstants.borrowAsset                                                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│         IExtension(_poolFactory.extension()).initializePoolExtension(_repaymentInterval);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         (uint256 _protocolFeeFraction, address _collector) = _poolFactory.getProtocolFeeData();                                                                                                                 │
│         uint256 _protocolFee = _tokensLent.mul(_protocolFeeFraction).div(10**30);                                                                                                                               │
│         delete poolConstants.loanWithdrawalDeadline;                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _feeAdjustedWithdrawalAmount = _tokensLent.sub(_protocolFee);                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _protocolFee, address(this), _collector);                                                                                                               │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _feeAdjustedWithdrawalAmount, address(this), msg.sender);                                                                                               │
│                                                                                                                                                                                                                 │
│         emit AmountBorrowed(_feeAdjustedWithdrawalAmount, _protocolFee);                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawAllCollateral(address _receiver, uint256 _penalty) internal {                                                                                                                             │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         uint256 _collateralShares = 0;                                                                                                                                                                          │
│         if (poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares) > _penalty) {                                                                                                             │
│             _collateralShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares).sub(_penalty);                                                                                        │
│         }                                                                                                                                                                                                       │
│         // uint256 _collateralTokens = _collateralShares;                                                                                                                                                       │
│         uint256 _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralShares, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         poolVariables.baseLiquidityShares = _penalty;                                                                                                                                                           │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived;                                                                                                                                                                                │
│         if (_collateralShares != 0) {                                                                                                                                                                           │
│             ISavingsAccount _savingsAccount = ISavingsAccount(IPoolFactory(poolFactory).savingsAccount());                                                                                                      │
│             _sharesReceived = SavingsAccountUtil.savingsAccountTransfer(                                                                                                                                        │
│                 _savingsAccount,                                                                                                                                                                                │
│                 address(this),                                                                                                                                                                                  │
│                 _receiver,                                                                                                                                                                                      │
│                 _collateralTokens,                                                                                                                                                                              │
│                 _collateralAsset,                                                                                                                                                                               │
│                 _poolSavingsStrategy                                                                                                                                                                            │
│             );                                                                                                                                                                                                  │
│         }                                                                                                                                                                                                       │
│         emit CollateralWithdrawn(_receiver, _sharesReceived);                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function lend(                                                                                                                                                                                              │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy                                                                                                                                                                                       │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         address _lenderVerifier = poolConstants.lenderVerifier;                                                                                                                                                 │
│         address _borrower = poolConstants.borrower;                                                                                                                                                             │
│         require(_lender != _borrower && _borrower != msg.sender, 'L1');                                                                                                                                         │
│         if (_lenderVerifier != address(0)) {                                                                                                                                                                    │
│             require(IVerification(IPoolFactory(poolFactory).userRegistry()).isUser(_lender, _lenderVerifier), 'L2');                                                                                            │
│         }                                                                                                                                                                                                       │
│         require(poolVariables.loanStatus == LoanStatus.COLLECTION && block.timestamp < poolConstants.loanStartTime, 'L3');                                                                                      │
│         uint256 _borrowAmountNeeded = poolConstants.borrowAmountRequested;                                                                                                                                      │
│         uint256 _lentAmount = totalSupply();                                                                                                                                                                    │
│         if (_amount.add(_lentAmount) > _borrowAmountNeeded) {                                                                                                                                                   │
│             _amount = _borrowAmountNeeded.sub(_lentAmount);                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowToken = poolConstants.borrowAsset;                                                                                                                                                       │
│         bool _fromSavingsAccount;                                                                                                                                                                               │
│         if(_strategy != address(0)) {                                                                                                                                                                           │
│             _fromSavingsAccount = true;                                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│         _deposit(                                                                                                                                                                                               │
│             _fromSavingsAccount,                                                                                                                                                                                │
│             false,                                                                                                                                                                                              │
│             _borrowToken,                                                                                                                                                                                       │
│             _amount,                                                                                                                                                                                            │
│             _strategy,                                                                                                                                                                                          │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         _mint(_lender, _amount);                                                                                                                                                                                │
│         emit LiquiditySupplied(_amount, _lender);                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function lend(                                                                                                                                                                                              │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _strategy                                                                                                                                                                                       │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         address _lenderVerifier = poolConstants.lenderVerifier;                                                                                                                                                 │
│         address _borrower = poolConstants.borrower;                                                                                                                                                             │
│         require(_lender != _borrower && _borrower != msg.sender, 'L1');                                                                                                                                         │
│         if (_lenderVerifier != address(0)) {                                                                                                                                                                    │
│             require(IVerification(IPoolFactory(poolFactory).userRegistry()).isUser(_lender, _lenderVerifier), 'L2');                                                                                            │
│         }                                                                                                                                                                                                       │
│         require(poolVariables.loanStatus == LoanStatus.COLLECTION && block.timestamp < poolConstants.loanStartTime, 'L3');                                                                                      │
│         uint256 _borrowAmountNeeded = poolConstants.borrowAmountRequested;                                                                                                                                      │
│         uint256 _lentAmount = totalSupply();                                                                                                                                                                    │
│         if (_amount.add(_lentAmount) > _borrowAmountNeeded) {                                                                                                                                                   │
│             _amount = _borrowAmountNeeded.sub(_lentAmount);                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowToken = poolConstants.borrowAsset;                                                                                                                                                       │
│         bool _fromSavingsAccount;                                                                                                                                                                               │
│         if(_strategy != address(0)) {                                                                                                                                                                           │
│             _fromSavingsAccount = true;                                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│         _deposit(                                                                                                                                                                                               │
│             _fromSavingsAccount,                                                                                                                                                                                │
│             false,                                                                                                                                                                                              │
│             _borrowToken,                                                                                                                                                                                       │
│             _amount,                                                                                                                                                                                            │
│             _strategy,                                                                                                                                                                                          │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         _mint(_lender, _amount);                                                                                                                                                                                │
│         emit LiquiditySupplied(_amount, _lender);                                                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _beforeTokenTransfer(                                                                                                                                                                              │
│         address _from,                                                                                                                                                                                          │
│         address _to,                                                                                                                                                                                            │
│         uint256 _amount                                                                                                                                                                                         │
│     ) internal override {                                                                                                                                                                                       │
│         if (_to != address(0)) {                                                                                                                                                                                │
│             require(!paused(), 'TT1');                                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│         require(_to != poolConstants.borrower, 'TT2');                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         if (_from == address(0) || _to == address(0)) {                                                                                                                                                         │
│             return;                                                                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _lenderVerifier = poolConstants.lenderVerifier;                                                                                                                                                 │
│         if (_lenderVerifier != address(0)) {                                                                                                                                                                    │
│             require(IVerification(_poolFactory.userRegistry()).isUser(_to, _lenderVerifier), 'TT5');                                                                                                            │
│         }                                                                                                                                                                                                       │
│         require(getMarginCallEndTime(_from) == 0, 'TT3');                                                                                                                                                       │
│         require(getMarginCallEndTime(_to) == 0, 'TT4');                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         //Withdraw repayments for user                                                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //We enforce pending interest withdrawals before the transfers                                                                                                                                          │
│                                                                                                                                                                                                                 │
│         //effectiveInterestWithdrawn stores the interest we assume addresses have withdrawn to simplify future interest withdrawals.                                                                            │
│         // For eg, if _from has 100 pool tokens, _to has 50 pool tokens, and _amount is 50, the effectiveInterestWithdrawn for                                                                                  │
│         // _from is done using 50 pool tokens, since future interest repayment withdrawals are done with respect to 50 tokens for _from                                                                         │
│         // Similarly, we use 100 for _to's effectiveInterestWithdrawn calculation since their future interest withdrawals are calculated                                                                        │
│         // based on 100 pool tokens. Refer calculateRepaymentWithdrawable()                                                                                                                                     │
│         _withdrawRepayment(_from);                                                                                                                                                                              │
│         _withdrawRepayment(_to);                                                                                                                                                                                │
│         uint256 _totalRepaidAmount = IRepayment(IPoolFactory(poolFactory).repaymentImpl()).getTotalRepaidAmount(address(this));                                                                                 │
│         uint256 _totalSupply = totalSupply();                                                                                                                                                                   │
│         uint256 _fromBalance = balanceOf(_from);                                                                                                                                                                │
│         uint256 _toBalance = balanceOf(_to);                                                                                                                                                                    │
│         lenders[_from].effectiveInterestWithdrawn = (_fromBalance.sub(_amount)).mul(_totalRepaidAmount).div(_totalSupply);                                                                                      │
│         lenders[_to].effectiveInterestWithdrawn = (_toBalance.add(_amount)).mul(_totalRepaidAmount).div(_totalSupply);                                                                                          │
│                                                                                                                                                                                                                 │
│         IExtension(_poolFactory.extension()).removeVotes(_from, _to, _amount);                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         //transfer extra liquidity shares                                                                                                                                                                       │
│         uint256 _liquidityShare = lenders[_from].extraLiquidityShares;                                                                                                                                          │
│         if (_liquidityShare == 0) return;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 toTransfer = _liquidityShare;                                                                                                                                                                   │
│         if (_amount != _fromBalance) {                                                                                                                                                                          │
│             toTransfer = (_amount.mul(_liquidityShare)).div(_fromBalance);                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         lenders[_from].extraLiquidityShares = lenders[_from].extraLiquidityShares.sub(toTransfer);                                                                                                              │
│         lenders[_to].extraLiquidityShares = lenders[_to].extraLiquidityShares.add(toTransfer);                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function cancelPool() external {                                                                                                                                                                            │
│         LoanStatus _poolStatus = poolVariables.loanStatus;                                                                                                                                                      │
│         require(_poolStatus == LoanStatus.COLLECTION, 'CP1');                                                                                                                                                   │
│         uint256 _loanStartTime = poolConstants.loanStartTime;                                                                                                                                                   │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         if (                                                                                                                                                                                                    │
│             _loanStartTime < block.timestamp &&                                                                                                                                                                 │
│             totalSupply() < _poolFactory.minBorrowFraction().mul(poolConstants.borrowAmountRequested).div(10**30)                                                                                               │
│         ) {                                                                                                                                                                                                     │
│             return _cancelPool(0);                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _loanWithdrawalDeadline = poolConstants.loanWithdrawalDeadline;                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         if (_loanWithdrawalDeadline > block.timestamp) {                                                                                                                                                        │
│             require(msg.sender == poolConstants.borrower, 'CP2');                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares;                                                                                                                                  │
│         uint256 _penaltyTime = _calculatePenaltyTime(_loanStartTime, _loanWithdrawalDeadline);                                                                                                                  │
│         uint256 _cancelPenaltyMultiple = _poolFactory.poolCancelPenaltyMultiple();                                                                                                                              │
│         uint256 penalty = _cancelPenaltyMultiple                                                                                                                                                                │
│             .mul(poolConstants.borrowRate)                                                                                                                                                                      │
│             .div(10**30)                                                                                                                                                                                        │
│             .mul(_collateralLiquidityShare)                                                                                                                                                                     │
│             .div(10**30)                                                                                                                                                                                        │
│             .mul(_penaltyTime)                                                                                                                                                                                  │
│             .div(365 days);                                                                                                                                                                                     │
│         _cancelPool(penalty);                                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawLiquidity() external isLender(msg.sender) nonReentrant {                                                                                                                                   │
│         LoanStatus _loanStatus = poolVariables.loanStatus;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _loanStatus == LoanStatus.CLOSED ||                                                                                                                                                                 │
│                 _loanStatus == LoanStatus.CANCELLED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.DEFAULTED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.TERMINATED,                                                                                                                                                           │
│             'WL1'                                                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //gets amount through liquidity shares                                                                                                                                                                  │
│         uint256 _actualBalance = balanceOf(msg.sender);                                                                                                                                                         │
│         uint256 _toTransfer = _actualBalance;                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.DEFAULTED || _loanStatus == LoanStatus.TERMINATED) {                                                                                                                      │
│             uint256 _totalAsset;                                                                                                                                                                                │
│             if (poolConstants.borrowAsset != address(0)) {                                                                                                                                                      │
│                 _totalAsset = IERC20(poolConstants.borrowAsset).balanceOf(address(this));                                                                                                                       │
│             } else {                                                                                                                                                                                            │
│                 _totalAsset = address(this).balance;                                                                                                                                                            │
│             }                                                                                                                                                                                                   │
│             //assuming their will be no tokens in pool in any case except liquidation (to be checked) or we should store the amount in liquidate()                                                              │
│             _toTransfer = _toTransfer.mul(_totalAsset).div(totalSupply());                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CANCELLED) {                                                                                                                                                              │
│             _toTransfer = _toTransfer.add(_toTransfer.mul(poolVariables.penaltyLiquidityAmount).div(totalSupply()));                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CLOSED) {                                                                                                                                                                 │
│             //transfer repayment                                                                                                                                                                                │
│             _withdrawRepayment(msg.sender);                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│         //to add transfer if not included in above (can be transferred with liquidity)                                                                                                                          │
│         _burn(msg.sender, _actualBalance);                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //transfer liquidity provided                                                                                                                                                                           │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _toTransfer, address(this), msg.sender);                                                                                                   │
│                                                                                                                                                                                                                 │
│         emit LiquidityWithdrawn(_toTransfer, msg.sender);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function withdrawLiquidity() external isLender(msg.sender) nonReentrant {                                                                                                                                   │
│         LoanStatus _loanStatus = poolVariables.loanStatus;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             _loanStatus == LoanStatus.CLOSED ||                                                                                                                                                                 │
│                 _loanStatus == LoanStatus.CANCELLED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.DEFAULTED ||                                                                                                                                                          │
│                 _loanStatus == LoanStatus.TERMINATED,                                                                                                                                                           │
│             'WL1'                                                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //gets amount through liquidity shares                                                                                                                                                                  │
│         uint256 _actualBalance = balanceOf(msg.sender);                                                                                                                                                         │
│         uint256 _toTransfer = _actualBalance;                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.DEFAULTED || _loanStatus == LoanStatus.TERMINATED) {                                                                                                                      │
│             uint256 _totalAsset;                                                                                                                                                                                │
│             if (poolConstants.borrowAsset != address(0)) {                                                                                                                                                      │
│                 _totalAsset = IERC20(poolConstants.borrowAsset).balanceOf(address(this));                                                                                                                       │
│             } else {                                                                                                                                                                                            │
│                 _totalAsset = address(this).balance;                                                                                                                                                            │
│             }                                                                                                                                                                                                   │
│             //assuming their will be no tokens in pool in any case except liquidation (to be checked) or we should store the amount in liquidate()                                                              │
│             _toTransfer = _toTransfer.mul(_totalAsset).div(totalSupply());                                                                                                                                      │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CANCELLED) {                                                                                                                                                              │
│             _toTransfer = _toTransfer.add(_toTransfer.mul(poolVariables.penaltyLiquidityAmount).div(totalSupply()));                                                                                            │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_loanStatus == LoanStatus.CLOSED) {                                                                                                                                                                 │
│             //transfer repayment                                                                                                                                                                                │
│             _withdrawRepayment(msg.sender);                                                                                                                                                                     │
│         }                                                                                                                                                                                                       │
│         //to add transfer if not included in above (can be transferred with liquidity)                                                                                                                          │
│         _burn(msg.sender, _actualBalance);                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         //transfer liquidity provided                                                                                                                                                                           │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _toTransfer, address(this), msg.sender);                                                                                                   │
│                                                                                                                                                                                                                 │
│         emit LiquidityWithdrawn(_toTransfer, msg.sender);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function interestToPay() public view returns (uint256) {                                                                                                                                                    │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         (uint256 _loanDurationCovered, uint256 _interestPerSecond) = IRepayment(_poolFactory.repaymentImpl()).getInterestCalculationVars(                                                                       │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _currentBlockTime = block.timestamp.mul(10**30);                                                                                                                                                │
│         uint256 _loanDurationTillNow = _currentBlockTime.sub(poolConstants.loanStartTime.mul(10**30));                                                                                                          │
│         if (_loanDurationTillNow <= _loanDurationCovered) {                                                                                                                                                     │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│         uint256 _interestAccrued = _interestPerSecond.mul(_loanDurationTillNow.sub(_loanDurationCovered)).div(10**60);                                                                                          │
│                                                                                                                                                                                                                 │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function interestToPay() public view returns (uint256) {                                                                                                                                                    │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         (uint256 _loanDurationCovered, uint256 _interestPerSecond) = IRepayment(_poolFactory.repaymentImpl()).getInterestCalculationVars(                                                                       │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _currentBlockTime = block.timestamp.mul(10**30);                                                                                                                                                │
│         uint256 _loanDurationTillNow = _currentBlockTime.sub(poolConstants.loanStartTime.mul(10**30));                                                                                                          │
│         if (_loanDurationTillNow <= _loanDurationCovered) {                                                                                                                                                     │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│         uint256 _interestAccrued = _interestPerSecond.mul(_loanDurationTillNow.sub(_loanDurationCovered)).div(10**60);                                                                                          │
│                                                                                                                                                                                                                 │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes",                                                                                                                                                                                                 │
│     "3": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio() public returns (uint256 _ratio) {                                                                                                                                      │
│         uint256 _liquidityShares = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                                   │
│                                                                                                                                                                                                                 │
│         _ratio = calculateCollateralRatio(totalSupply(), _liquidityShares);                                                                                                                                     │
│     }                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function withdrawBorrowedAmount() external override onlyBorrower(msg.sender) nonReentrant {                                                                                                                 │
│         LoanStatus _poolStatus = poolVariables.loanStatus;                                                                                                                                                      │
│         uint256 _tokensLent = totalSupply();                                                                                                                                                                    │
│         require(                                                                                                                                                                                                │
│             _poolStatus == LoanStatus.COLLECTION &&                                                                                                                                                             │
│                 poolConstants.loanStartTime < block.timestamp &&                                                                                                                                                │
│                 block.timestamp < poolConstants.loanWithdrawalDeadline,                                                                                                                                         │
│             'WBA1'                                                                                                                                                                                              │
│         );                                                                                                                                                                                                      │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_tokensLent >= _poolFactory.minBorrowFraction().mul(poolConstants.borrowAmountRequested).div(10**30), 'WBA2');                                                                                  │
│                                                                                                                                                                                                                 │
│         poolVariables.loanStatus = LoanStatus.ACTIVE;                                                                                                                                                           │
│         uint256 _currentCollateralRatio = getCurrentCollateralRatio();                                                                                                                                          │
│         require(_currentCollateralRatio >= poolConstants.idealCollateralRatio, 'WBA3');                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _noOfRepaymentIntervals = poolConstants.noOfRepaymentIntervals;                                                                                                                                 │
│         uint256 _repaymentInterval = poolConstants.repaymentInterval;                                                                                                                                           │
│         IRepayment(_poolFactory.repaymentImpl()).initializeRepayment(                                                                                                                                           │
│             _noOfRepaymentIntervals,                                                                                                                                                                            │
│             _repaymentInterval,                                                                                                                                                                                 │
│             poolConstants.borrowRate,                                                                                                                                                                           │
│             poolConstants.loanStartTime,                                                                                                                                                                        │
│             poolConstants.borrowAsset                                                                                                                                                                           │
│         );                                                                                                                                                                                                      │
│         IExtension(_poolFactory.extension()).initializePoolExtension(_repaymentInterval);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         (uint256 _protocolFeeFraction, address _collector) = _poolFactory.getProtocolFeeData();                                                                                                                 │
│         uint256 _protocolFee = _tokensLent.mul(_protocolFeeFraction).div(10**30);                                                                                                                               │
│         delete poolConstants.loanWithdrawalDeadline;                                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _feeAdjustedWithdrawalAmount = _tokensLent.sub(_protocolFee);                                                                                                                                   │
│                                                                                                                                                                                                                 │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _protocolFee, address(this), _collector);                                                                                                               │
│         SavingsAccountUtil.transferTokens(_borrowAsset, _feeAdjustedWithdrawalAmount, address(this), msg.sender);                                                                                               │
│                                                                                                                                                                                                                 │
│         emit AmountBorrowed(_feeAdjustedWithdrawalAmount, _protocolFee);                                                                                                                                        │
│     }                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function addCollateralInMarginCall(                                                                                                                                                                         │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount                                                                                                                                                                        │
│     ) external payable override nonReentrant {                                                                                                                                                                  │
│         require(poolVariables.loanStatus == LoanStatus.ACTIVE, 'ACMC1');                                                                                                                                        │
│         require(balanceOf(msg.sender) == 0, 'ACMC2');                                                                                                                                                           │
│         require(getMarginCallEndTime(_lender) >= block.timestamp, 'ACMC3');                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         require(_amount != 0, 'ACMC4');                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = _deposit(                                                                                                                                                                     │
│             _transferFromSavingsAccount,                                                                                                                                                                        │
│             true,                                                                                                                                                                                               │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _amount,                                                                                                                                                                                            │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.add(_sharesReceived);                                                                                                           │
│                                                                                                                                                                                                                 │
│         lenders[_lender].extraLiquidityShares = lenders[_lender].extraLiquidityShares.add(_sharesReceived);                                                                                                     │
│                                                                                                                                                                                                                 │
│         if (getCurrentCollateralRatio(_lender) >= poolConstants.idealCollateralRatio) {                                                                                                                         │
│             delete lenders[_lender].marginCallEndTime;                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit MarginCallCollateralAdded(msg.sender, _lender, _amount, _sharesReceived);                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function addCollateralInMarginCall(                                                                                                                                                                         │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _transferFromSavingsAccount                                                                                                                                                                        │
│     ) external payable override nonReentrant {                                                                                                                                                                  │
│         require(poolVariables.loanStatus == LoanStatus.ACTIVE, 'ACMC1');                                                                                                                                        │
│         require(balanceOf(msg.sender) == 0, 'ACMC2');                                                                                                                                                           │
│         require(getMarginCallEndTime(_lender) >= block.timestamp, 'ACMC3');                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         require(_amount != 0, 'ACMC4');                                                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = _deposit(                                                                                                                                                                     │
│             _transferFromSavingsAccount,                                                                                                                                                                        │
│             true,                                                                                                                                                                                               │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _amount,                                                                                                                                                                                            │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             msg.sender,                                                                                                                                                                                         │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.add(_sharesReceived);                                                                                                           │
│                                                                                                                                                                                                                 │
│         lenders[_lender].extraLiquidityShares = lenders[_lender].extraLiquidityShares.add(_sharesReceived);                                                                                                     │
│                                                                                                                                                                                                                 │
│         if (getCurrentCollateralRatio(_lender) >= poolConstants.idealCollateralRatio) {                                                                                                                         │
│             delete lenders[_lender].marginCallEndTime;                                                                                                                                                          │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         emit MarginCallCollateralAdded(msg.sender, _lender, _amount, _sharesReceived);                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _canLenderBeLiquidated(address _lender) internal {                                                                                                                                                 │
│         require((poolVariables.loanStatus == LoanStatus.ACTIVE) && (block.timestamp > poolConstants.loanWithdrawalDeadline), 'CLBL1');                                                                          │
│         uint256 _marginCallEndTime = lenders[_lender].marginCallEndTime;                                                                                                                                        │
│         require(getMarginCallEndTime(_lender) != 0, 'CLBL2');                                                                                                                                                   │
│         require(_marginCallEndTime < block.timestamp, 'CLBL3');                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         require(poolConstants.idealCollateralRatio > getCurrentCollateralRatio(_lender), 'CLBL4');                                                                                                              │
│         require(balanceOf(_lender) != 0, 'CLBL5');                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function requestMarginCall() external isLender(msg.sender) {                                                                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.ACTIVE, 'RMC1');                                                                                                                                         │
│                                                                                                                                                                                                                 │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(getMarginCallEndTime(msg.sender) == 0, 'RMC2');                                                                                                                                                 │
│         require(poolConstants.idealCollateralRatio > getCurrentCollateralRatio(msg.sender), 'RMC3');                                                                                                            │
│                                                                                                                                                                                                                 │
│         lenders.marginCallEndTime = block.timestamp.add(_poolFactory.marginCallDuration());                                                                                                                     │
│                                                                                                                                                                                                                 │
│         emit MarginCalled(msg.sender);                                                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│     function getCurrentCollateralRatio(address _lender) public returns (uint256 _ratio) {                                                                                                                       │
│         uint256 _balanceOfLender = balanceOf(_lender);                                                                                                                                                          │
│         uint256 _liquidityShares = (poolVariables.baseLiquidityShares.mul(_balanceOfLender).div(totalSupply())).add(                                                                                            │
│             lenders[_lender].extraLiquidityShares                                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return (calculateCollateralRatio(_balanceOfLender, _liquidityShares));                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidatePool(                                                                                                                                                                                     │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         LoanStatus _currentPoolStatus = poolVariables.loanStatus;                                                                                                                                               │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         require(_currentPoolStatus == LoanStatus.ACTIVE, 'LP1');                                                                                                                                                │
│         require(IRepayment(_poolFactory.repaymentImpl()).didBorrowerDefault(address(this)), 'LP2');                                                                                                             │
│         poolVariables.loanStatus = LoanStatus.DEFAULTED;                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         uint256 _collateralLiquidityShare = poolVariables.baseLiquidityShares.add(poolVariables.extraLiquidityShares);                                                                                          │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _collateralTokens = _collateralLiquidityShare;                                                                                                                                                  │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralLiquidityShare, _collateralAsset);                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _poolBorrowTokens = correspondingBorrowTokens(                                                                                                                                                  │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         delete poolVariables.extraLiquidityShares;                                                                                                                                                              │
│         delete poolVariables.baseLiquidityShares;                                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _poolBorrowTokens, _poolFactory.noStrategyAddress(), msg.sender, address(this));                                                                     │
│         _withdraw(_toSavingsAccount, _recieveLiquidityShare, _collateralAsset, _poolSavingsStrategy, _collateralTokens);                                                                                        │
│         emit PoolLiquidated(msg.sender);                                                                                                                                                                        │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function _canLenderBeLiquidated(address _lender) internal {                                                                                                                                                 │
│         require((poolVariables.loanStatus == LoanStatus.ACTIVE) && (block.timestamp > poolConstants.loanWithdrawalDeadline), 'CLBL1');                                                                          │
│         uint256 _marginCallEndTime = lenders[_lender].marginCallEndTime;                                                                                                                                        │
│         require(getMarginCallEndTime(_lender) != 0, 'CLBL2');                                                                                                                                                   │
│         require(_marginCallEndTime < block.timestamp, 'CLBL3');                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         require(poolConstants.idealCollateralRatio > getCurrentCollateralRatio(_lender), 'CLBL4');                                                                                                              │
│         require(balanceOf(_lender) != 0, 'CLBL5');                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _canLenderBeLiquidated(address _lender) internal {                                                                                                                                                 │
│         require((poolVariables.loanStatus == LoanStatus.ACTIVE) && (block.timestamp > poolConstants.loanWithdrawalDeadline), 'CLBL1');                                                                          │
│         uint256 _marginCallEndTime = lenders[_lender].marginCallEndTime;                                                                                                                                        │
│         require(getMarginCallEndTime(_lender) != 0, 'CLBL2');                                                                                                                                                   │
│         require(_marginCallEndTime < block.timestamp, 'CLBL3');                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         require(poolConstants.idealCollateralRatio > getCurrentCollateralRatio(_lender), 'CLBL4');                                                                                                              │
│         require(balanceOf(_lender) != 0, 'CLBL5');                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _canLenderBeLiquidated(address _lender) internal {                                                                                                                                                 │
│         require((poolVariables.loanStatus == LoanStatus.ACTIVE) && (block.timestamp > poolConstants.loanWithdrawalDeadline), 'CLBL1');                                                                          │
│         uint256 _marginCallEndTime = lenders[_lender].marginCallEndTime;                                                                                                                                        │
│         require(getMarginCallEndTime(_lender) != 0, 'CLBL2');                                                                                                                                                   │
│         require(_marginCallEndTime < block.timestamp, 'CLBL3');                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         require(poolConstants.idealCollateralRatio > getCurrentCollateralRatio(_lender), 'CLBL4');                                                                                                              │
│         require(balanceOf(_lender) != 0, 'CLBL5');                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _updateLenderSharesDuringLiquidation(address _lender)                                                                                                                                              │
│         internal                                                                                                                                                                                                │
│         returns (uint256 _lenderCollateralLPShare, uint256 _lenderBalance)                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         uint256 _poolBaseLPShares = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _lenderBalance = balanceOf(_lender);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _lenderBaseLPShares = (_poolBaseLPShares.mul(_lenderBalance)).div(totalSupply());                                                                                                               │
│         uint256 _lenderExtraLPShares = lenders[_lender].extraLiquidityShares;                                                                                                                                   │
│         poolVariables.baseLiquidityShares = _poolBaseLPShares.sub(_lenderBaseLPShares);                                                                                                                         │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.sub(_lenderExtraLPShares);                                                                                                      │
│                                                                                                                                                                                                                 │
│         _lenderCollateralLPShare = _lenderBaseLPShares.add(_lenderExtraLPShares);                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _updateLenderSharesDuringLiquidation(address _lender)                                                                                                                                              │
│         internal                                                                                                                                                                                                │
│         returns (uint256 _lenderCollateralLPShare, uint256 _lenderBalance)                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         uint256 _poolBaseLPShares = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _lenderBalance = balanceOf(_lender);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _lenderBaseLPShares = (_poolBaseLPShares.mul(_lenderBalance)).div(totalSupply());                                                                                                               │
│         uint256 _lenderExtraLPShares = lenders[_lender].extraLiquidityShares;                                                                                                                                   │
│         poolVariables.baseLiquidityShares = _poolBaseLPShares.sub(_lenderBaseLPShares);                                                                                                                         │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.sub(_lenderExtraLPShares);                                                                                                      │
│                                                                                                                                                                                                                 │
│         _lenderCollateralLPShare = _lenderBaseLPShares.add(_lenderExtraLPShares);                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _updateLenderSharesDuringLiquidation(address _lender)                                                                                                                                              │
│         internal                                                                                                                                                                                                │
│         returns (uint256 _lenderCollateralLPShare, uint256 _lenderBalance)                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         uint256 _poolBaseLPShares = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _lenderBalance = balanceOf(_lender);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _lenderBaseLPShares = (_poolBaseLPShares.mul(_lenderBalance)).div(totalSupply());                                                                                                               │
│         uint256 _lenderExtraLPShares = lenders[_lender].extraLiquidityShares;                                                                                                                                   │
│         poolVariables.baseLiquidityShares = _poolBaseLPShares.sub(_lenderBaseLPShares);                                                                                                                         │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.sub(_lenderExtraLPShares);                                                                                                      │
│                                                                                                                                                                                                                 │
│         _lenderCollateralLPShare = _lenderBaseLPShares.add(_lenderExtraLPShares);                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: deposit/mint/add the liquidity pool/amount/share and set the total share to the number of first deposit when the supply/liquidity is 0                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
│     function _updateLenderSharesDuringLiquidation(address _lender)                                                                                                                                              │
│         internal                                                                                                                                                                                                │
│         returns (uint256 _lenderCollateralLPShare, uint256 _lenderBalance)                                                                                                                                      │
│     {                                                                                                                                                                                                           │
│         uint256 _poolBaseLPShares = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _lenderBalance = balanceOf(_lender);                                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _lenderBaseLPShares = (_poolBaseLPShares.mul(_lenderBalance)).div(totalSupply());                                                                                                               │
│         uint256 _lenderExtraLPShares = lenders[_lender].extraLiquidityShares;                                                                                                                                   │
│         poolVariables.baseLiquidityShares = _poolBaseLPShares.sub(_lenderBaseLPShares);                                                                                                                         │
│         poolVariables.extraLiquidityShares = poolVariables.extraLiquidityShares.sub(_lenderExtraLPShares);                                                                                                      │
│                                                                                                                                                                                                                 │
│         _lenderCollateralLPShare = _lenderBaseLPShares.add(_lenderExtraLPShares);                                                                                                                               │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _liquidateForLender(                                                                                                                                                                               │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         address _lender,                                                                                                                                                                                        │
│         uint256 _lenderCollateralTokens                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         uint256 _lenderLiquidationTokens = correspondingBorrowTokens(                                                                                                                                           │
│             _lenderCollateralTokens,                                                                                                                                                                            │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         address _borrowAsset = poolConstants.borrowAsset;                                                                                                                                                       │
│         _deposit(_fromSavingsAccount, false, _borrowAsset, _lenderLiquidationTokens, _poolSavingsStrategy, msg.sender, _lender);                                                                                │
│         _withdrawRepayment(_lender);                                                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function calculateRepaymentWithdrawable(address _lender) public view returns (uint256) {                                                                                                                    │
│         uint256 _totalRepaidAmount = IRepayment(IPoolFactory(poolFactory).repaymentImpl()).getTotalRepaidAmount(address(this));                                                                                 │
│                                                                                                                                                                                                                 │
│         uint256 _amountWithdrawable = (balanceOf(_lender).mul(_totalRepaidAmount).div(totalSupply())).sub(                                                                                                      │
│             lenders[_lender].effectiveInterestWithdrawn                                                                                                                                                         │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return _amountWithdrawable;                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawRepayment(address _lender) internal {                                                                                                                                                     │
│         uint256 _amountToWithdraw = calculateRepaymentWithdrawable(_lender);                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (_amountToWithdraw == 0) {                                                                                                                                                                           │
│             return;                                                                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│         lenders[_lender].effectiveInterestWithdrawn = lenders[_lender].effectiveInterestWithdrawn.add(_amountToWithdraw);                                                                                       │
│                                                                                                                                                                                                                 │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _amountToWithdraw, address(this), _lender);                                                                                                │
│     }                                                                                                                                                                                                           │
│     function calculateRepaymentWithdrawable(address _lender) public view returns (uint256) {                                                                                                                    │
│         uint256 _totalRepaidAmount = IRepayment(IPoolFactory(poolFactory).repaymentImpl()).getTotalRepaidAmount(address(this));                                                                                 │
│                                                                                                                                                                                                                 │
│         uint256 _amountWithdrawable = (balanceOf(_lender).mul(_totalRepaidAmount).div(totalSupply())).sub(                                                                                                      │
│             lenders[_lender].effectiveInterestWithdrawn                                                                                                                                                         │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         return _amountWithdrawable;                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _withdrawRepayment(address _lender) internal {                                                                                                                                                     │
│         uint256 _amountToWithdraw = calculateRepaymentWithdrawable(_lender);                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         if (_amountToWithdraw == 0) {                                                                                                                                                                           │
│             return;                                                                                                                                                                                             │
│         }                                                                                                                                                                                                       │
│         lenders[_lender].effectiveInterestWithdrawn = lenders[_lender].effectiveInterestWithdrawn.add(_amountToWithdraw);                                                                                       │
│                                                                                                                                                                                                                 │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _amountToWithdraw, address(this), _lender);                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function initialize(                                                                                                                                                                                        │
│         address _poolFactory,                                                                                                                                                                                   │
│         uint256 _gracePenaltyRate,                                                                                                                                                                              │
│         uint256 _gracePeriodFraction                                                                                                                                                                            │
│     ) external initializer {                                                                                                                                                                                    │
│         _updatePoolFactory(_poolFactory);                                                                                                                                                                       │
│         _updateGracePenaltyRate(_gracePenaltyRate);                                                                                                                                                             │
│         _updateGracePeriodFraction(_gracePeriodFraction);                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function initializeRepayment(                                                                                                                                                                               │
│         uint256 numberOfTotalRepayments,                                                                                                                                                                        │
│         uint256 repaymentInterval,                                                                                                                                                                              │
│         uint256 borrowRate,                                                                                                                                                                                     │
│         uint256 loanStartTime,                                                                                                                                                                                  │
│         address lentAsset                                                                                                                                                                                       │
│     ) external override onlyValidPool {                                                                                                                                                                         │
│         repayConstants.gracePenaltyRate = gracePenaltyRate;                                                                                                                                                     │
│         repayConstants.gracePeriodFraction = gracePeriodFraction;                                                                                                                                               │
│         repayConstants.numberOfTotalRepayments = numberOfTotalRepayments;                                                                                                                                       │
│         repayConstants.loanDuration = repaymentInterval.mul(numberOfTotalRepayments).mul(10**30);                                                                                                               │
│         repayConstants.repaymentInterval = repaymentInterval.mul(10**30);                                                                                                                                       │
│         repayConstants.borrowRate = borrowRate;                                                                                                                                                                 │
│         repayConstants.loanStartTime = loanStartTime.mul(10**30);                                                                                                                                               │
│         repayConstants.repayAsset = lentAsset;                                                                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function _repayInterest(                                                                                                                                                                                    │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         uint256 _interestLeft = getInterestLeft(_poolID);                                                                                                                                                       │
│         require((_amount < _interestLeft) != _isLastRepayment, 'Repayments::repay complete interest must be repaid along with principal');                                                                      │
│                                                                                                                                                                                                                 │
│         if (_amount < _interestLeft) {                                                                                                                                                                          │
│             uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                         │
│             uint256 _newDurationRepaid = _amount.mul(10**30).div(_interestPerSecond); // dividing exponents                                                                                                     │
│             repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);                                                                                  │
│             emit InterestRepaid(_poolID, _amount);                                                                                                                                                              │
│             return _amount;                                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             repayVariables[_poolID].loanDurationCovered = repayConstants[_poolID].loanDuration; // full interest repaid                                                                                         │
│             emit InterestRepaymentComplete(_poolID, _interestLeft);                                                                                                                                             │
│             return _interestLeft;                                                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getInterestLeft(address _poolID) public view returns (uint256) {                                                                                                                                   │
│         uint256 _interestPerSecond = getInterestPerSecond((_poolID));                                                                                                                                           │
│         uint256 _loanDurationLeft = repayConstants[_poolID].loanDuration.sub(repayVariables[_poolID].loanDurationCovered);                                                                                      │
│         uint256 _interestLeft = _interestPerSecond.mul(_loanDurationLeft).div(10**30); // multiplying exponents                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _interestLeft;                                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function getInterestLeft(address _poolID) public view returns (uint256) {                                                                                                                                   │
│         uint256 _interestPerSecond = getInterestPerSecond((_poolID));                                                                                                                                           │
│         uint256 _loanDurationLeft = repayConstants[_poolID].loanDuration.sub(repayVariables[_poolID].loanDurationCovered);                                                                                      │
│         uint256 _interestLeft = _interestPerSecond.mul(_loanDurationLeft).div(10**30); // multiplying exponents                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _interestLeft;                                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes",                                                                                                                                                                                                 │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price based on the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation          │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│     function getInterestPerSecond(address _poolID) public view returns (uint256) {                                                                                                                              │
│         uint256 _activePrincipal = IPool(_poolID).totalSupply();                                                                                                                                                │
│         uint256 _interestPerSecond = _activePrincipal.mul(repayConstants[_poolID].borrowRate).div(YEAR_IN_SECONDS);                                                                                             │
│         return _interestPerSecond;                                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function getInterestLeft(address _poolID) public view returns (uint256) {                                                                                                                                   │
│         uint256 _interestPerSecond = getInterestPerSecond((_poolID));                                                                                                                                           │
│         uint256 _loanDurationLeft = repayConstants[_poolID].loanDuration.sub(repayVariables[_poolID].loanDurationCovered);                                                                                      │
│         uint256 _interestLeft = _interestPerSecond.mul(_loanDurationLeft).div(10**30); // multiplying exponents                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _interestLeft;                                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function getInterestLeft(address _poolID) public view returns (uint256) {                                                                                                                                   │
│         uint256 _interestPerSecond = getInterestPerSecond((_poolID));                                                                                                                                           │
│         uint256 _loanDurationLeft = repayConstants[_poolID].loanDuration.sub(repayVariables[_poolID].loanDurationCovered);                                                                                      │
│         uint256 _interestLeft = _interestPerSecond.mul(_loanDurationLeft).div(10**30); // multiplying exponents                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _interestLeft;                                                                                                                                                                                   │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ No                                                                                                                                                                                                              │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repayExtension(address _poolID) internal returns (uint256) {                                                                                                                                      │
│         if (repayVariables[_poolID].isLoanExtensionActive) {                                                                                                                                                    │
│             uint256 _interestOverdue = getInterestOverdue(_poolID);                                                                                                                                             │
│             repayVariables[_poolID].isLoanExtensionActive = false; // deactivate loan extension flag                                                                                                            │
│             repayVariables[_poolID].loanDurationCovered = (getInstalmentsCompleted(_poolID).add(10**30))                                                                                                        │
│                 .mul(repayConstants[_poolID].repaymentInterval)                                                                                                                                                 │
│                 .div(10**30);                                                                                                                                                                                   │
│             emit ExtensionRepaid(_poolID, _interestOverdue);                                                                                                                                                    │
│             return _interestOverdue;                                                                                                                                                                            │
│         } else {                                                                                                                                                                                                │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function _repayExtension(address _poolID) internal returns (uint256) {                                                                                                                                      │
│         if (repayVariables[_poolID].isLoanExtensionActive) {                                                                                                                                                    │
│             uint256 _interestOverdue = getInterestOverdue(_poolID);                                                                                                                                             │
│             repayVariables[_poolID].isLoanExtensionActive = false; // deactivate loan extension flag                                                                                                            │
│             repayVariables[_poolID].loanDurationCovered = (getInstalmentsCompleted(_poolID).add(10**30))                                                                                                        │
│                 .mul(repayConstants[_poolID].repaymentInterval)                                                                                                                                                 │
│                 .div(10**30);                                                                                                                                                                                   │
│             emit ExtensionRepaid(_poolID, _interestOverdue);                                                                                                                                                    │
│             return _interestOverdue;                                                                                                                                                                            │
│         } else {                                                                                                                                                                                                │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repayGracePenalty(address _poolID) internal returns (uint256) {                                                                                                                                   │
│         bool _isBorrowerLate = isGracePenaltyApplicable(_poolID);                                                                                                                                               │
│                                                                                                                                                                                                                 │
│         if (_isBorrowerLate) {                                                                                                                                                                                  │
│             uint256 _penalty = repayConstants[_poolID].gracePenaltyRate.mul(getInterestDueTillInstalmentDeadline(_poolID)).div(10**30);                                                                         │
│             emit GracePenaltyRepaid(_poolID, _penalty);                                                                                                                                                         │
│             return _penalty;                                                                                                                                                                                    │
│         } else {                                                                                                                                                                                                │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repayInterest(                                                                                                                                                                                    │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         uint256 _interestLeft = getInterestLeft(_poolID);                                                                                                                                                       │
│         require((_amount < _interestLeft) != _isLastRepayment, 'Repayments::repay complete interest must be repaid along with principal');                                                                      │
│                                                                                                                                                                                                                 │
│         if (_amount < _interestLeft) {                                                                                                                                                                          │
│             uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                         │
│             uint256 _newDurationRepaid = _amount.mul(10**30).div(_interestPerSecond); // dividing exponents                                                                                                     │
│             repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);                                                                                  │
│             emit InterestRepaid(_poolID, _amount);                                                                                                                                                              │
│             return _amount;                                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             repayVariables[_poolID].loanDurationCovered = repayConstants[_poolID].loanDuration; // full interest repaid                                                                                         │
│             emit InterestRepaymentComplete(_poolID, _interestLeft);                                                                                                                                             │
│             return _interestLeft;                                                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function _repayInterest(                                                                                                                                                                                    │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         uint256 _interestLeft = getInterestLeft(_poolID);                                                                                                                                                       │
│         require((_amount < _interestLeft) != _isLastRepayment, 'Repayments::repay complete interest must be repaid along with principal');                                                                      │
│                                                                                                                                                                                                                 │
│         if (_amount < _interestLeft) {                                                                                                                                                                          │
│             uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                         │
│             uint256 _newDurationRepaid = _amount.mul(10**30).div(_interestPerSecond); // dividing exponents                                                                                                     │
│             repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);                                                                                  │
│             emit InterestRepaid(_poolID, _amount);                                                                                                                                                              │
│             return _amount;                                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             repayVariables[_poolID].loanDurationCovered = repayConstants[_poolID].loanDuration; // full interest repaid                                                                                         │
│             emit InterestRepaymentComplete(_poolID, _interestLeft);                                                                                                                                             │
│             return _interestLeft;                                                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate,                                                                                                                               │
│ Code:                                                                                                                                                                                                           │
│     function _repay(                                                                                                                                                                                            │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         IPool _pool = IPool(_poolID);                                                                                                                                                                           │
│         _amount = _amount * 10**30;                                                                                                                                                                             │
│         uint256 _loanStatus = _pool.getLoanStatus();                                                                                                                                                            │
│         require(_loanStatus == uint(LoanStatus.ACTIVE) , 'Repayments:repayInterest Pool should be active.');                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _initialAmount = _amount;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // pay off grace penality                                                                                                                                                                               │
│         uint256 _gracePenaltyDue = _repayGracePenalty(_poolID);                                                                                                                                                 │
│         _amount = _amount.sub(_gracePenaltyDue, 'doesnt cover grace penality');                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         // pay off the overdue                                                                                                                                                                                  │
│         uint256 _interestOverdue = _repayExtension(_poolID);                                                                                                                                                    │
│         _amount = _amount.sub(_interestOverdue, 'doesnt cover overdue interest');                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // pay interest                                                                                                                                                                                         │
│         uint256 _interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);                                                                                                                           │
│         _amount = _amount.sub(_interestRepaid);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _updateRepaidAmount(_poolID, _initialAmount.sub(_amount));                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "Yes"                                                                                                                                                                                                  │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭──────────────────────────────────────────────────────────────────────────────────────────── Single Choice Scenario ─────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have inside code statements that update/accrue interest/exchange rate, and have inside code statements that calculate/assign/distribute the balance/share/stake/fee/loan/reward                      │
│ Code:                                                                                                                                                                                                           │
│     function _repay(                                                                                                                                                                                            │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         IPool _pool = IPool(_poolID);                                                                                                                                                                           │
│         _amount = _amount * 10**30;                                                                                                                                                                             │
│         uint256 _loanStatus = _pool.getLoanStatus();                                                                                                                                                            │
│         require(_loanStatus == uint(LoanStatus.ACTIVE) , 'Repayments:repayInterest Pool should be active.');                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _initialAmount = _amount;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // pay off grace penality                                                                                                                                                                               │
│         uint256 _gracePenaltyDue = _repayGracePenalty(_poolID);                                                                                                                                                 │
│         _amount = _amount.sub(_gracePenaltyDue, 'doesnt cover grace penality');                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         // pay off the overdue                                                                                                                                                                                  │
│         uint256 _interestOverdue = _repayExtension(_poolID);                                                                                                                                                    │
│         _amount = _amount.sub(_interestOverdue, 'doesnt cover overdue interest');                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // pay interest                                                                                                                                                                                         │
│         uint256 _interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);                                                                                                                           │
│         _amount = _amount.sub(_interestRepaid);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _updateRepaidAmount(_poolID, _initialAmount.sub(_amount));                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Yes                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ have inside code statements that update/accrue interest/exchange rate,                                                                                                                                          │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function repayPrincipal(address payable _poolID) external payable nonReentrant isPoolInitialized(_poolID) {                                                                                                 │
│         address _asset = repayConstants[_poolID].repayAsset;                                                                                                                                                    │
│         uint256 _interestToRepay = _repay(_poolID, MAX_INT, true);                                                                                                                                              │
│         IPool _pool = IPool(_poolID);                                                                                                                                                                           │
│                                                                                                                                                                                                                 │
│         require(!repayVariables[_poolID].isLoanExtensionActive, 'Repayments:repayPrincipal Repayment overdue unpaid');                                                                                          │
│                                                                                                                                                                                                                 │
│         require(                                                                                                                                                                                                │
│             repayConstants[_poolID].loanDuration == repayVariables[_poolID].loanDurationCovered,                                                                                                                │
│             'Repayments:repayPrincipal Unpaid interest'                                                                                                                                                         │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 _amount = _pool.totalSupply();                                                                                                                                                                  │
│         uint256 _amountToPay = _amount.add(_interestToRepay);                                                                                                                                                   │
│         _transferTokens(msg.sender, _poolID, _asset, _amountToPay);                                                                                                                                             │
│         emit PrincipalRepaid(_poolID, _amount);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         IPool(_poolID).closeLoan();                                                                                                                                                                             │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No",                                                                                                                                                                                                  │
│     "3": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────── Multiple Choice Scenarios ───────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: have code statements that get or calculate LP token's value/price                                                                                                                                    │
│ deposit/mint/add the liquidity pool/amount/share                                                                                                                                                                │
│ Code:                                                                                                                                                                                                           │
│     function voteOnExtension(address _pool) external {                                                                                                                                                          │
│         uint256 _extensionVoteEndTime = extensions[_pool].extensionVoteEndTime;                                                                                                                                 │
│         require(block.timestamp < _extensionVoteEndTime, 'Pool::voteOnExtension - Voting is over');                                                                                                             │
│                                                                                                                                                                                                                 │
│         (uint256 _balance, uint256 _totalSupply) = IPool(_pool).getBalanceDetails(msg.sender);                                                                                                                  │
│         require(_balance != 0, 'Pool::voteOnExtension - Not a valid lender for pool');                                                                                                                          │
│                                                                                                                                                                                                                 │
│         uint256 _votingPassRatio = votingPassRatio;                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lastVotedExtension = extensions[_pool].lastVotedExtension; //Lender last vote time need to store it as it checks that a lender only votes once                                                 │
│         require(_lastVotedExtension != _extensionVoteEndTime, 'Pool::voteOnExtension - you have already voted');                                                                                                │
│                                                                                                                                                                                                                 │
│         uint256 _extensionSupport = extensions[_pool].totalExtensionSupport;                                                                                                                                    │
│         _lastVotedExtension = _extensionVoteEndTime;                                                                                                                                                            │
│         _extensionSupport = _extensionSupport.add(_balance);                                                                                                                                                    │
│                                                                                                                                                                                                                 │
│         extensions[_pool].lastVotedExtension = _lastVotedExtension;                                                                                                                                             │
│         emit LenderVoted(msg.sender, _extensionSupport, _lastVotedExtension);                                                                                                                                   │
│         extensions[_pool].totalExtensionSupport = _extensionSupport;                                                                                                                                            │
│                                                                                                                                                                                                                 │
│         if (((_extensionSupport)) >= (_totalSupply.mul(_votingPassRatio)).div(10**30)) {                                                                                                                        │
│             grantExtension(_pool);                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "1": "No",                                                                                                                                                                                                  │
│     "2": "No"                                                                                                                                                                                                   │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterest(                                                                                                                                                                                 │
│         uint256 _principal,                                                                                                                                                                                     │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         uint256 _timeElapsed                                                                                                                                                                                    │
│     ) public pure returns (uint256) {                                                                                                                                                                           │
│         uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);                                                                                                     │
│                                                                                                                                                                                                                 │
│         return _interest;                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);`                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterest(                                                                                                                                                                                 │
│         uint256 _principal,                                                                                                                                                                                     │
│         uint256 _borrowRate,                                                                                                                                                                                    │
│         uint256 _timeElapsed                                                                                                                                                                                    │
│     ) public pure returns (uint256) {                                                                                                                                                                           │
│         uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);                                                                                                     │
│                                                                                                                                                                                                                 │
│         return _interest;                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);`                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                                   order_first_b                                                    
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                                 ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                                                                    │
│ arg[1]   │ [uint256 _interest = _principal.mul(_borrowRate).mul(_timeElapsed).div(10**30).div(YEAR_IN_SECONDS);] │
└──────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterestAccrued(uint256 _id) public view returns (uint256) {                                                                                                                              │
│         uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;                                                                                                                    │
│         if (_lastPrincipalUpdateTime == 0) return 0;                                                                                                                                                            │
│         uint256 _timeElapsed = (block.timestamp).sub(_lastPrincipalUpdateTime);                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterest(creditLineVariables[_id].principal, creditLineConstants[_id].borrowRate, _timeElapsed);                                                                    │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;`                                                                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateInterestAccrued(uint256 _id) public view returns (uint256) {                                                                                                                              │
│         uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;                                                                                                                    │
│         if (_lastPrincipalUpdateTime == 0) return 0;                                                                                                                                                            │
│         uint256 _timeElapsed = (block.timestamp).sub(_lastPrincipalUpdateTime);                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterest(creditLineVariables[_id].principal, creditLineConstants[_id].borrowRate, _timeElapsed);                                                                    │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uint256 _interestAccrued = calculateInterest(creditLineVariables[_id].principal, creditLineConstants[_id].borrowRate, _timeElapsed);`                                                                          │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                            order_first_b                                            
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                  ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                                                     │
│ arg[1]   │ [uint256 _lastPrincipalUpdateTime = creditLineVariables[_id].lastPrincipalUpdateTime;] │
└──────────┴────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateCurrentDebt(uint256 _id) public view returns (uint256) {                                                                                                                                  │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _currentDebt = (creditLineVariables[_id].principal)                                                                                                                                             │
│             .add(creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate)                                                                                                                               │
│             .add(_interestAccrued)                                                                                                                                                                              │
│             .sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                                                                 │
│         return _currentDebt;                                                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate`                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   order_first_b    
┏━━━━━━━━━━┳━━━━━━━┓
┃ Argument ┃ Value ┃
┡━━━━━━━━━━╇━━━━━━━┩
│ arg[0]   │ []    │
│ arg[1]   │ []    │
└──────────┴───────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function updateinterestAccruedTillLastPrincipalUpdate(uint256 _id) internal {                                                                                                                               │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│                                                                                                                                                                                                                 │
│         uint256 _interestAccrued = calculateInterestAccrued(_id);                                                                                                                                               │
│         uint256 _newInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(_interestAccrued);                                                                                  │
│         creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _newInterestAccrued;                                                                                                                  │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `ONE` statement                                                                                                                                                                                                 │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   order_first_b    
┏━━━━━━━━━━┳━━━━━━━┓
┃ Argument ┃ Value ┃
┡━━━━━━━━━━╇━━━━━━━┩
│ arg[0]   │ []    │
│ arg[1]   │ []    │
└──────────┴───────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `_tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);`                                                                                                                  │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _depositCollateralFromSavingsAccount(                                                                                                                                                              │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _sender                                                                                                                                                                                         │
│     ) internal {                                                                                                                                                                                                │
│         address _collateralAsset = creditLineConstants[_id].collateralAsset;                                                                                                                                    │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         ISavingsAccount _savingsAccount = ISavingsAccount(savingsAccount);                                                                                                                                      │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│         for (uint256 _index = 0; _index < _strategyList.length; _index++) {                                                                                                                                     │
│             address _strategy = _strategyList[_index];                                                                                                                                                          │
│             uint256 _liquidityShares = _savingsAccount.balanceInShares(_sender, _collateralAsset, _strategy);                                                                                                   │
│             if (_liquidityShares == 0 || _strategyList[_index] == address(0)) {                                                                                                                                 │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = _liquidityShares;                                                                                                                                                        │
│             _tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                                        │
│                                                                                                                                                                                                                 │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) >= _amount) {                                                                                                                                               │
│                 _tokensToTransfer = (_amount.sub(_activeAmount));                                                                                                                                               │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             _savingsAccount.transferFrom(_tokensToTransfer, _collateralAsset, _strategy, _sender, address(this));                                                                                               │
│                                                                                                                                                                                                                 │
│             collateralShareInStrategy[_id][_strategy] = collateralShareInStrategy[_id][_strategy].add(                                                                                                          │
│                 _liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy)                                                                                                                                   │
│             );                                                                                                                                                                                                  │
│                                                                                                                                                                                                                 │
│             if (_amount == _activeAmount) {                                                                                                                                                                     │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('CreditLine::_depositCollateralFromSavingsAccount - Insufficient balance');                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `_activeAmount = _activeAmount.add(_tokensToTransfer);`                                                                                                                                                         │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                                order_first_b                                                
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                          ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                                                             │
│ arg[1]   │ [_tokenInStrategy = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);] │
└──────────┴────────────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function borrow(uint256 _id, uint256 _amount) external payable nonReentrant onlyCreditLineBorrower(_id) {                                                                                                   │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         uint256 _borrowableAmount = calculateBorrowableAmount(_id);                                                                                                                                             │
│         require(_amount <= _borrowableAmount, "CreditLine::borrow - The current collateral ratio doesn't allow to withdraw the amount");                                                                        │
│         address _borrowAsset = creditLineConstants[_id].borrowAsset;                                                                                                                                            │
│         address _lender = creditLineConstants[_id].lender;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         updateinterestAccruedTillLastPrincipalUpdate(_id);                                                                                                                                                      │
│         creditLineVariables[_id].principal = creditLineVariables[_id].principal.add(_amount);                                                                                                                   │
│         creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 _tokenDiffBalance;                                                                                                                                                                              │
│         if (_borrowAsset != address(0)) {                                                                                                                                                                       │
│             uint256 _balanceBefore = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                             │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                              │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 _balanceBefore = address(this).balance;                                                                                                                                                     │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = address(this).balance;                                                                                                                                                      │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         uint256 _protocolFee = _tokenDiffBalance.mul(protocolFeeFraction).div(10**30);                                                                                                                          │
│         _tokenDiffBalance = _tokenDiffBalance.sub(_protocolFee);                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         if (_borrowAsset == address(0)) {                                                                                                                                                                       │
│             (bool feeSuccess, ) = protocolFeeCollector.call{value: _protocolFee}('');                                                                                                                           │
│             require(feeSuccess, 'Transfer fail');                                                                                                                                                               │
│             (bool success, ) = msg.sender.call{value: _tokenDiffBalance}('');                                                                                                                                   │
│             require(success, 'Transfer fail');                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             IERC20(_borrowAsset).safeTransfer(protocolFeeCollector, _protocolFee);                                                                                                                              │
│             IERC20(_borrowAsset).safeTransfer(msg.sender, _tokenDiffBalance);                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         emit BorrowedFromCreditLine(_id, _tokenDiffBalance);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `updateinterestAccruedTillLastPrincipalUpdate(_id)`                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function borrow(uint256 _id, uint256 _amount) external payable nonReentrant onlyCreditLineBorrower(_id) {                                                                                                   │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         uint256 _borrowableAmount = calculateBorrowableAmount(_id);                                                                                                                                             │
│         require(_amount <= _borrowableAmount, "CreditLine::borrow - The current collateral ratio doesn't allow to withdraw the amount");                                                                        │
│         address _borrowAsset = creditLineConstants[_id].borrowAsset;                                                                                                                                            │
│         address _lender = creditLineConstants[_id].lender;                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         updateinterestAccruedTillLastPrincipalUpdate(_id);                                                                                                                                                      │
│         creditLineVariables[_id].principal = creditLineVariables[_id].principal.add(_amount);                                                                                                                   │
│         creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                     │
│                                                                                                                                                                                                                 │
│         uint256 _tokenDiffBalance;                                                                                                                                                                              │
│         if (_borrowAsset != address(0)) {                                                                                                                                                                       │
│             uint256 _balanceBefore = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                             │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = IERC20(_borrowAsset).balanceOf(address(this));                                                                                                                              │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         } else {                                                                                                                                                                                                │
│             uint256 _balanceBefore = address(this).balance;                                                                                                                                                     │
│             _withdrawBorrowAmount(_borrowAsset, _amount, _lender);                                                                                                                                              │
│             uint256 _balanceAfter = address(this).balance;                                                                                                                                                      │
│             _tokenDiffBalance = _balanceAfter.sub(_balanceBefore);                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│         uint256 _protocolFee = _tokenDiffBalance.mul(protocolFeeFraction).div(10**30);                                                                                                                          │
│         _tokenDiffBalance = _tokenDiffBalance.sub(_protocolFee);                                                                                                                                                │
│                                                                                                                                                                                                                 │
│         if (_borrowAsset == address(0)) {                                                                                                                                                                       │
│             (bool feeSuccess, ) = protocolFeeCollector.call{value: _protocolFee}('');                                                                                                                           │
│             require(feeSuccess, 'Transfer fail');                                                                                                                                                               │
│             (bool success, ) = msg.sender.call{value: _tokenDiffBalance}('');                                                                                                                                   │
│             require(success, 'Transfer fail');                                                                                                                                                                  │
│         } else {                                                                                                                                                                                                │
│             IERC20(_borrowAsset).safeTransfer(protocolFeeCollector, _protocolFee);                                                                                                                              │
│             IERC20(_borrowAsset).safeTransfer(msg.sender, _tokenDiffBalance);                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         emit BorrowedFromCreditLine(_id, _tokenDiffBalance);                                                                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `creditLineVariables[_id].principal = creditLineVariables[_id].principal.add(_amount);`                                                                                                                         │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                          order_first_b                           
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                               ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                  │
│ arg[1]   │ [updateinterestAccruedTillLastPrincipalUpdate(_id)] │
└──────────┴─────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function repay(                                                                                                                                                                                             │
│         uint256 _id,                                                                                                                                                                                            │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _fromSavingsAccount                                                                                                                                                                                │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         require(creditLineVariables[_id].status == CreditLineStatus.ACTIVE, 'CreditLine: The credit line is not yet active.');                                                                                  │
│         require(creditLineConstants[_id].lender != msg.sender, 'Lender cant repay');                                                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _interestSincePrincipalUpdate = calculateInterestAccrued(_id);                                                                                                                                  │
│         uint256 _totalInterestAccrued = (creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate).add(                                                                                                  │
│             _interestSincePrincipalUpdate                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _interestToPay = _totalInterestAccrued.sub(creditLineVariables[_id].totalInterestRepaid);                                                                                                       │
│         uint256 _totalCurrentDebt = _interestToPay.add(creditLineVariables[_id].principal);                                                                                                                     │
│         uint256 _principalPaid = 0;                                                                                                                                                                             │
│                                                                                                                                                                                                                 │
│         if (_amount >= _totalCurrentDebt) {                                                                                                                                                                     │
│             _amount = _totalCurrentDebt;                                                                                                                                                                        │
│             emit CompleteCreditLineRepaid(_id, _amount);                                                                                                                                                        │
│         } else {                                                                                                                                                                                                │
│             emit PartialCreditLineRepaid(_id, _amount);                                                                                                                                                         │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         if (_amount > _interestToPay) {                                                                                                                                                                         │
│             creditLineVariables[_id].principal = _totalCurrentDebt.sub(_amount);                                                                                                                                │
│             creditLineVariables[_id].interestAccruedTillLastPrincipalUpdate = _totalInterestAccrued;                                                                                                            │
│             creditLineVariables[_id].lastPrincipalUpdateTime = block.timestamp;                                                                                                                                 │
│             creditLineVariables[_id].totalInterestRepaid = _totalInterestAccrued;                                                                                                                               │
│             _principalPaid = _amount.sub(_interestToPay);                                                                                                                                                       │
│         } else {                                                                                                                                                                                                │
│             creditLineVariables[_id].totalInterestRepaid = creditLineVariables[_id].totalInterestRepaid.add(_amount);                                                                                           │
│         }                                                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         _repay(_id, _amount, _fromSavingsAccount, _principalPaid);                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         if (creditLineVariables[_id].principal == 0) {                                                                                                                                                          │
│             _resetCreditLine(_id);                                                                                                                                                                              │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `One statement`                                                                                                                                                                                                 │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   order_first_b    
┏━━━━━━━━━━┳━━━━━━━┓
┃ Argument ┃ Value ┃
┡━━━━━━━━━━╇━━━━━━━┩
│ arg[0]   │ []    │
│ arg[1]   │ []    │
└──────────┴───────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function _transferCollateral(                                                                                                                                                                               │
│         uint256 _id,                                                                                                                                                                                            │
│         address _asset,                                                                                                                                                                                         │
│         uint256 _amountInTokens,                                                                                                                                                                                │
│         bool _toSavingsAccount                                                                                                                                                                                  │
│     ) internal {                                                                                                                                                                                                │
│         address[] memory _strategyList = IStrategyRegistry(strategyRegistry).getStrategies();                                                                                                                   │
│         uint256 _activeAmount;                                                                                                                                                                                  │
│         for (uint256 index = 0; index < _strategyList.length; index++) {                                                                                                                                        │
│             uint256 liquidityShares = collateralShareInStrategy[_id][_strategyList];                                                                                                                            │
│             if (liquidityShares == 0 || _strategyList == address(0)) {                                                                                                                                          │
│                 continue;                                                                                                                                                                                       │
│             }                                                                                                                                                                                                   │
│             uint256 _tokenInStrategy = liquidityShares;                                                                                                                                                         │
│             _tokenInStrategy = IYield(_strategyList).getTokensForShares(liquidityShares, _asset);                                                                                                               │
│             uint256 _tokensToTransfer = _tokenInStrategy;                                                                                                                                                       │
│             if (_activeAmount.add(_tokenInStrategy) > _amountInTokens) {                                                                                                                                        │
│                 _tokensToTransfer = _amountInTokens.sub(_activeAmount);                                                                                                                                         │
│                 liquidityShares = liquidityShares.mul(_tokensToTransfer).div(_tokenInStrategy);                                                                                                                 │
│             }                                                                                                                                                                                                   │
│             _activeAmount = _activeAmount.add(_tokensToTransfer);                                                                                                                                               │
│             collateralShareInStrategy[_id][_strategyList] = collateralShareInStrategy[_id][_strategyList].sub(                                                                                                  │
│                 liquidityShares                                                                                                                                                                                 │
│             );                                                                                                                                                                                                  │
│             if (_toSavingsAccount) {                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).transfer(_tokensToTransfer, _asset, _strategyList, msg.sender);                                                                                                 │
│             } else {                                                                                                                                                                                            │
│                 ISavingsAccount(savingsAccount).withdraw(_tokensToTransfer, _asset, _strategyList, msg.sender, false);                                                                                          │
│             }                                                                                                                                                                                                   │
│                                                                                                                                                                                                                 │
│             if (_activeAmount == _amountInTokens) {                                                                                                                                                             │
│                 return;                                                                                                                                                                                         │
│             }                                                                                                                                                                                                   │
│         }                                                                                                                                                                                                       │
│         revert('insufficient collateral');                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `1`                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   order_first_b    
┏━━━━━━━━━━┳━━━━━━━┓
┃ Argument ┃ Value ┃
┡━━━━━━━━━━╇━━━━━━━┩
│ arg[0]   │ []    │
│ arg[1]   │ []    │
└──────────┴───────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_totalSupply": "Holds the value of total minted share or amount"                                                                                                                                       │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_totalSupply": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                         │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:06] INFO     static_check: first_deposit_check: VariableA: _totalSupply; VariableB: _totalSupply; VariableC: amount                                                             static_check.py:128
    first_deposit_check    
┏━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃ Argument ┃ Value        ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ arg[0]   │ _totalSupply │
│ arg[1]   │ amount       │
│ arg[2]   │ _totalSupply │
└──────────┴──────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "totalSupply()": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                        │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:07] INFO     static_check: first_deposit_check: VariableA: _amount; VariableB: totalSupply(); VariableC: _amount                                                                static_check.py:128
    first_deposit_check     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value         ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ arg[0]   │ totalSupply() │
│ arg[1]   │ _amount       │
│ arg[2]   │ _amount       │
└──────────┴───────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_balances": "Holds the custom token balance of an account",                                                                                                                                            │
│         "_totalSupply": "Holds the total supply of the custom token"                                                                                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_totalSupply": "Holds the calculated value/price of LP token"                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   find_data_dependency    
┏━━━━━━━━━━┳━━━━━━━━━━━━━━┓
┃ Argument ┃ Value        ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━┩
│ arg[0]   │ _balances    │
│ arg[1]   │ _totalSupply │
└──────────┴──────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_lenderCollateralLPShare": "Variable holding the market reserves/AMM price/exchange rate or the custom token balance of the lender's collateral LP share calculation"                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_amountReceived": "Variable holding the calculated value/price of LP token"                                                                                                                            │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
         find_data_dependency          
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                    ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ _lenderCollateralLPShare │
│ arg[1]   │ _amountReceived          │
└──────────┴──────────────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "totalSupply()": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                        │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:10] INFO     static_check: first_deposit_check: VariableA: _amount; VariableB: totalSupply(); VariableC: _amount                                                                static_check.py:128
    first_deposit_check     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value         ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ arg[0]   │ totalSupply() │
│ arg[1]   │ _amount       │
│ arg[2]   │ _amount       │
└──────────┴───────────────┘
                    ERROR    falcon_adapter: Traceback (most recent call last):                                                                                                               falcon_adapter.py:176
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/falcon_adapter.py", line 171, in first_deposit_check                                                                     
                                 args_text = text[text.index("("):text.rindex(")")+1]                                                                                                                              
                             ValueError: substring not found                                                                                                                                                       
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "sharesReceived": "Holds the value of total minted share or amount"                                                                                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "aToken": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                               │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:11] INFO     static_check: first_deposit_check: VariableA: sharesReceived; VariableB: aToken; VariableC: amount                                                                 static_check.py:128
     first_deposit_check     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value          ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ arg[0]   │ aToken         │
│ arg[1]   │ amount         │
│ arg[2]   │ sharesReceived │
└──────────┴────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of total minted share or amount"                                                                                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_want": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                                │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:12] INFO     static_check: first_deposit_check: VariableA: _amount; VariableB: _want; VariableC: _amount                                                                        static_check.py:128
 first_deposit_check  
┏━━━━━━━━━━┳━━━━━━━━━┓
┃ Argument ┃ Value   ┃
┡━━━━━━━━━━╇━━━━━━━━━┩
│ arg[0]   │ _want   │
│ arg[1]   │ _amount │
│ arg[2]   │ _amount │
└──────────┴─────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "sharesReceived": "Holds the value of total minted share or amount"                                                                                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "sharesBefore": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                         │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                              │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:13] INFO     static_check: first_deposit_check: VariableA: sharesReceived; VariableB: sharesBefore; VariableC: amount                                                           static_check.py:128
     first_deposit_check     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value          ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ arg[0]   │ sharesBefore   │
│ arg[1]   │ amount         │
│ arg[2]   │ sharesReceived │
└──────────┴────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of total minted share or amount"                                                                                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_pool": "Holds the total supply/liquidity AND is used by the conditional branch to determine the supply/liquidity is 0"                                                                                │
│     },                                                                                                                                                                                                          │
│     "VariableC": {                                                                                                                                                                                              │
│         "_amount": "Holds the value of the deposit/mint/add amount"                                                                                                                                             │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:14] INFO     static_check: first_deposit_check: VariableA: _amount; VariableB: _pool; VariableC: _amount                                                                        static_check.py:128
 first_deposit_check  
┏━━━━━━━━━━┳━━━━━━━━━┓
┃ Argument ┃ Value   ┃
┡━━━━━━━━━━╇━━━━━━━━━┩
│ arg[0]   │ _pool   │
│ arg[1]   │ _amount │
│ arg[2]   │ _amount │
└──────────┴─────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidityIndex": "Holds the market reserves/AMM price/exchange rate calculation"                                                                                                                       │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amount": "Holds the calculated value/price of LP token"                                                                                                                                                │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    find_data_dependency     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value          ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ arg[0]   │ liquidityIndex │
│ arg[1]   │ amount         │
└──────────┴────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_activeAmount": "Variable to hold the calculated active amount of tokens"                                                                                                                              │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_tokensToTransfer": "Variable to hold the tokens to transfer"                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:17] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_activeAmount": "Variable holding the calculated active amount of tokens being withdrawn"                                                                                                              │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_tokensToTransfer": "Variable holding the tokens to be transferred during withdrawal"                                                                                                                  │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:18] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "_poolSavingsStrategy": "Variable holding the pool savings strategy address",                                                                                                                               │
│     "poolConstants.poolSavingsStrategy": "Variable holding the pool savings strategy address",                                                                                                                  │
│     "_lenderCollateralLPShare": "Variable holding the lender's collateral LP share",                                                                                                                            │
│     "_lenderBalance": "Variable holding the lender's balance",                                                                                                                                                  │
│     "poolConstants.collateralAsset": "Variable holding the collateral asset address"                                                                                                                            │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_amountReceived": "Variable holding the amount received after withdrawal"                                                                                                                                  │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:19] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_liquidityShares": "Variable holding the liquidity shares balance for a specific asset and strategy"                                                                                                   │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_tokensToTransfer": "Variable holding the calculated tokens to transfer based on conditions"                                                                                                           │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:20] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidityShares": "Variable holding the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation"                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_activeAmount": "Variable holding the calculated value/price of LP token"                                                                                                                              │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
     find_data_dependency     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value           ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ liquidityShares │
│ arg[1]   │ _activeAmount   │
└──────────┴─────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "poolVariables.penaltyLiquidityAmount": "Holds the penalty liquidity amount calculated"                                                                                                                     │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_liquidationTokens": "Holds the calculated value of LP token for penalty liquidity amount"                                                                                                                 │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
               find_data_dependency                
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ poolVariables.penaltyLiquidityAmount │
│ arg[1]   │ _liquidationTokens                   │
└──────────┴──────────────────────────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_liquidityShares": "Variable holding the liquidity shares in a strategy",                                                                                                                              │
│         "_tokenInStrategy": "Variable holding the token amount in a strategy"                                                                                                                                   │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_amount": "Variable holding the calculated total collateral tokens"                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:23] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "poolVariables": "Holds market reserves/AMM price/exchange rate or custom token balanceOf/totalSupply/amount/liquidity calculation"                                                                         │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_poolBorrowTokens": "Holds the calculated value/price of LP token"                                                                                                                                         │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
      find_data_dependency      
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value             ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ poolVariables     │
│ arg[1]   │ _poolBorrowTokens │
└──────────┴───────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalSupply()": "Function to get the total supply of tokens in circulation"                                                                                                                            │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_ratio": "Variable holding the calculated value/price of LP token"                                                                                                                                     │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    find_data_dependency    
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value         ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ arg[0]   │ totalSupply() │
│ arg[1]   │ _ratio        │
└──────────┴───────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "poolVariables.baseLiquidityShares": "Holds the base liquidity shares of the pool",                                                                                                                     │
│         "poolVariables.extraLiquidityShares": "Holds the extra liquidity shares of the pool",                                                                                                                   │
│         "_penalty": "Holds the penalty amount"                                                                                                                                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_sharesReceived": "Holds the calculated value/price of LP token"                                                                                                                                       │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
              find_data_dependency              
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                             ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ poolVariables.baseLiquidityShares │
│ arg[1]   │ _sharesReceived                   │
└──────────┴───────────────────────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "balanceInShares": "Holds the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation"                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_totalTokens": "Holds the calculated value/price of LP token"                                                                                                                                          │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
     find_data_dependency     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value           ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ balanceInShares │
│ arg[1]   │ _totalTokens    │
└──────────┴─────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "aTokensBefore": "Variable to hold the balance of aToken before depositing"                                                                                                                             │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "sharesReceived": "Variable to hold the calculated shares received after depositing"                                                                                                                    │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:27] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:258
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol, current       tasks.py:260
                             function: _depositERC20, current vul: price-manipulation                                                                                                                              
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:262
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 209, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the `validate_description` validation                                                                                             
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "amount": "Holds the amount of tokens being locked"                                                                                                                                                     │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "sharesReceived": "Holds the calculated value of LP tokens received"                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    find_data_dependency     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value          ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━┩
│ arg[0]   │ amount         │
│ arg[1]   │ sharesReceived │
└──────────┴────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "cToken": "Variable holding the market reserves/AMMprice/exchangeRate"                                                                                                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "amount": "Variable holding the calculated value/price of LP token"                                                                                                                                     │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
find_data_dependency 
┏━━━━━━━━━━┳━━━━━━━━┓
┃ Argument ┃ Value  ┃
┡━━━━━━━━━━╇━━━━━━━━┩
│ arg[0]   │ cToken │
│ arg[1]   │ amount │
└──────────┴────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "_poolSavingsStrategy": "Variable holding the pool savings strategy address",                                                                                                                               │
│     "_lenderCollateralLPShare": "Variable holding the lender's collateral LP share",                                                                                                                            │
│     "_lenderCollateralTokens": "Variable holding the lender's collateral tokens"                                                                                                                                │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_amountReceived": "Variable holding the amount received after withdrawal"                                                                                                                                  │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:30] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/CompoundYield.sol, current   tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "liquidityShares": "Variable holding the market reserves/AMMprice/exchangeRate OR the custom token balanceOf/totalSupply/amount/liquidity calculation"                                                  │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_activeAmount": "Variable holding the calculated value/price of LP token"                                                                                                                              │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
     find_data_dependency     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value           ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ liquidityShares │
│ arg[1]   │ _activeAmount   │
└──────────┴─────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "_liquidityShares": "Variable holding the liquidity shares in a strategy",                                                                                                                              │
│         "_tokenInStrategy": "Variable holding the token amount in a strategy"                                                                                                                                   │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_amount": "Variable holding the calculated total collateral tokens"                                                                                                                                    │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:32] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/CompoundYield.sol, current   tasks.py:359
                             function: getTokensForShares, current vul: price-manipulation                                                                                                                         
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "totalSupply()": "Function to get the total supply of tokens in the pool"                                                                                                                               │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "_ratio": "Variable holding the calculated value of LP token price"                                                                                                                                     │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
    find_data_dependency    
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value         ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ arg[0]   │ totalSupply() │
│ arg[1]   │ _ratio        │
└──────────┴───────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "poolVariables.baseLiquidityShares": "Holds the base liquidity shares of the pool",                                                                                                                         │
│     "poolVariables.extraLiquidityShares": "Holds the extra liquidity shares of the pool",                                                                                                                       │
│     "_penalty": "Holds the penalty amount"                                                                                                                                                                      │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_sharesReceived": "Holds the calculated value/price of LP token"                                                                                                                                           │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
              find_data_dependency              
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                             ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ poolVariables.baseLiquidityShares │
│ arg[1]   │ _sharesReceived                   │
└──────────┴───────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function switchStrategy(                                                                                                                                                                                    │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _token,                                                                                                                                                                                         │
│         address _currentStrategy,                                                                                                                                                                               │
│         address _newStrategy                                                                                                                                                                                    │
│     ) external override nonReentrant {                                                                                                                                                                          │
│         require(_currentStrategy != _newStrategy, 'SavingsAccount::switchStrategy Same strategy');                                                                                                              │
│         require(IStrategyRegistry(strategyRegistry).registry(_newStrategy), 'SavingsAccount::_newStrategy do not exist');                                                                                       │
│         require(_amount != 0, 'SavingsAccount::switchStrategy Amount must be greater than zero');                                                                                                               │
│                                                                                                                                                                                                                 │
│         _amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(                                                                                                              │
│             _amount,                                                                                                                                                                                            │
│             'SavingsAccount::switchStrategy Insufficient balance'                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 _tokensReceived = IYield(_currentStrategy).unlockTokens(_token, _amount);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _ethValue;                                                                                                                                                                                      │
│         if (_token != address(0)) {                                                                                                                                                                             │
│             IERC20(_token).safeApprove(_newStrategy, _tokensReceived);                                                                                                                                          │
│         } else {                                                                                                                                                                                                │
│             _ethValue = _tokensReceived;                                                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│         _amount = _tokensReceived;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = IYield(_newStrategy).lockTokens{value: _ethValue}(address(this), _token, _tokensReceived);                                                                                    │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_newStrategy] = balanceInShares[_token][_newStrategy].add(_sharesReceived);                                                                                                     │
│         emit StrategySwitched(msg.sender, _token, _amount, _sharesReceived, _currentStrategy, _newStrategy);                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(_amount, 'SavingsAccount::switchStrategy Insufficient │
│ balance')`.                                                                                                                                                                                                     │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function switchStrategy(                                                                                                                                                                                    │
│         uint256 _amount,                                                                                                                                                                                        │
│         address _token,                                                                                                                                                                                         │
│         address _currentStrategy,                                                                                                                                                                               │
│         address _newStrategy                                                                                                                                                                                    │
│     ) external override nonReentrant {                                                                                                                                                                          │
│         require(_currentStrategy != _newStrategy, 'SavingsAccount::switchStrategy Same strategy');                                                                                                              │
│         require(IStrategyRegistry(strategyRegistry).registry(_newStrategy), 'SavingsAccount::_newStrategy do not exist');                                                                                       │
│         require(_amount != 0, 'SavingsAccount::switchStrategy Amount must be greater than zero');                                                                                                               │
│                                                                                                                                                                                                                 │
│         _amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(                                                                                                              │
│             _amount,                                                                                                                                                                                            │
│             'SavingsAccount::switchStrategy Insufficient balance'                                                                                                                                               │
│         );                                                                                                                                                                                                      │
│                                                                                                                                                                                                                 │
│         uint256 _tokensReceived = IYield(_currentStrategy).unlockTokens(_token, _amount);                                                                                                                       │
│                                                                                                                                                                                                                 │
│         uint256 _ethValue;                                                                                                                                                                                      │
│         if (_token != address(0)) {                                                                                                                                                                             │
│             IERC20(_token).safeApprove(_newStrategy, _tokensReceived);                                                                                                                                          │
│         } else {                                                                                                                                                                                                │
│             _ethValue = _tokensReceived;                                                                                                                                                                        │
│         }                                                                                                                                                                                                       │
│         _amount = _tokensReceived;                                                                                                                                                                              │
│                                                                                                                                                                                                                 │
│         uint256 _sharesReceived = IYield(_newStrategy).lockTokens{value: _ethValue}(address(this), _token, _tokensReceived);                                                                                    │
│                                                                                                                                                                                                                 │
│         balanceInShares[_token][_newStrategy] = balanceInShares[_token][_newStrategy].add(_sharesReceived);                                                                                                     │
│         emit StrategySwitched(msg.sender, _token, _amount, _sharesReceived, _currentStrategy, _newStrategy);                                                                                                    │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `_amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);`                                                                                                                                       │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                                                              order_first_b                                                                               
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                                                                                       ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [_amount = IYield(_currentStrategy).getSharesForTokens(_amount, _token);]                                                                                   │
│ arg[1]   │ [balanceInShares[_token][_currentStrategy] = balanceInShares[_token][_currentStrategy].sub(_amount, 'SavingsAccount::switchStrategy Insufficient balance')] │
└──────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `uint256 _collateralTokens = poolVariables.baseLiquidityShares;`.                                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function liquidateCancelPenalty(bool _toSavingsAccount, bool _receiveLiquidityShare) external nonReentrant {                                                                                                │
│         require(poolVariables.loanStatus == LoanStatus.CANCELLED, 'LCP1');                                                                                                                                      │
│         require(poolVariables.penaltyLiquidityAmount == 0, 'LCP2');                                                                                                                                             │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         // note: extra liquidity shares are not applicable as the loan never reaches active state                                                                                                               │
│         uint256 _collateralTokens = poolVariables.baseLiquidityShares;                                                                                                                                          │
│         _collateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_collateralTokens, _collateralAsset);                                                                                               │
│                                                                                                                                                                                                                 │
│         uint256 _liquidationTokens = correspondingBorrowTokens(                                                                                                                                                 │
│             _collateralTokens,                                                                                                                                                                                  │
│             _poolFactory.priceOracle(),                                                                                                                                                                         │
│             _poolFactory.liquidatorRewardFraction()                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         poolVariables.penaltyLiquidityAmount = _liquidationTokens;                                                                                                                                              │
│         SavingsAccountUtil.transferTokens(poolConstants.borrowAsset, _liquidationTokens, msg.sender, address(this));                                                                                            │
│         _withdraw(                                                                                                                                                                                              │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _receiveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             poolConstants.poolSavingsStrategy,                                                                                                                                                                  │
│             _collateralTokens                                                                                                                                                                                   │
│         );                                                                                                                                                                                                      │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `uint256 _collateralTokens = poolVariables.baseLiquidityShares;`                                                                                                                                                │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                 order_first_b                                 
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                            ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [uint256 _collateralTokens = poolVariables.baseLiquidityShares;] │
│ arg[1]   │ [uint256 _collateralTokens = poolVariables.baseLiquidityShares;] │
└──────────┴──────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function interestToPay() public view returns (uint256) {                                                                                                                                                    │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         (uint256 _loanDurationCovered, uint256 _interestPerSecond) = IRepayment(_poolFactory.repaymentImpl()).getInterestCalculationVars(                                                                       │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _currentBlockTime = block.timestamp.mul(10**30);                                                                                                                                                │
│         uint256 _loanDurationTillNow = _currentBlockTime.sub(poolConstants.loanStartTime.mul(10**30));                                                                                                          │
│         if (_loanDurationTillNow <= _loanDurationCovered) {                                                                                                                                                     │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│         uint256 _interestAccrued = _interestPerSecond.mul(_loanDurationTillNow.sub(_loanDurationCovered)).div(10**60);                                                                                          │
│                                                                                                                                                                                                                 │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `uint256 _currentBlockTime = block.timestamp.mul(10**30);`.                                                                                      │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function interestToPay() public view returns (uint256) {                                                                                                                                                    │
│         IPoolFactory _poolFactory = IPoolFactory(poolFactory);                                                                                                                                                  │
│         (uint256 _loanDurationCovered, uint256 _interestPerSecond) = IRepayment(_poolFactory.repaymentImpl()).getInterestCalculationVars(                                                                       │
│             address(this)                                                                                                                                                                                       │
│         );                                                                                                                                                                                                      │
│         uint256 _currentBlockTime = block.timestamp.mul(10**30);                                                                                                                                                │
│         uint256 _loanDurationTillNow = _currentBlockTime.sub(poolConstants.loanStartTime.mul(10**30));                                                                                                          │
│         if (_loanDurationTillNow <= _loanDurationCovered) {                                                                                                                                                     │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│         uint256 _interestAccrued = _interestPerSecond.mul(_loanDurationTillNow.sub(_loanDurationCovered)).div(10**60);                                                                                          │
│                                                                                                                                                                                                                 │
│         return _interestAccrued;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward is `uint256 _currentBlockTime = block.timestamp.mul(10**30);`.                                                       │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                              order_first_b                              
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                      ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                         │
│ arg[1]   │ [uint256 _currentBlockTime = block.timestamp.mul(10**30);] │
└──────────┴────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `uint256 _interest = interestToPay().mul(_balance).div(totalSupply());`.                                                                         │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function calculateCollateralRatio(uint256 _balance, uint256 _liquidityShares) public returns (uint256 _ratio) {                                                                                             │
│         uint256 _interest = interestToPay().mul(_balance).div(totalSupply());                                                                                                                                   │
│         address _collateralAsset = poolConstants.collateralAsset;                                                                                                                                               │
│         address _strategy = poolConstants.poolSavingsStrategy;                                                                                                                                                  │
│         uint256 _currentCollateralTokens = IYield(_strategy).getTokensForShares(_liquidityShares, _collateralAsset);                                                                                            │
│                                                                                                                                                                                                                 │
│         uint256 _equivalentCollateral = getEquivalentTokens(_collateralAsset, poolConstants.borrowAsset, _currentCollateralTokens);                                                                             │
│         _ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `_ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));`                                                                                                                                      │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                      order_first_b                                      
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                      ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [_ratio = _equivalentCollateral.mul(10**30).div(_balance.add(_interest));] │
│ arg[1]   │ [uint256 _interest = interestToPay().mul(_balance).div(totalSupply());]    │
└──────────┴────────────────────────────────────────────────────────────────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│     "VariableA": {                                                                                                                                                                                              │
│         "balanceOf": "Function to get the balance of a specific address"                                                                                                                                        │
│     },                                                                                                                                                                                                          │
│     "VariableB": {                                                                                                                                                                                              │
│         "N/A": "No variable holds the calculated value/price of LP token in this function"                                                                                                                      │
│     }                                                                                                                                                                                                           │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "_poolSavingsStrategy": "Variable holding the pool savings strategy address",                                                                                                                               │
│     "_lenderCollateralLPShare": "Variable holding the lender's collateral LP share",                                                                                                                            │
│     "_lenderCollateralTokens": "Variable holding the lender's collateral tokens"                                                                                                                                │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_amountReceived": "Variable holding the amount received after withdrawal"                                                                                                                                  │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:40] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol, current function:   tasks.py:359
                             _canLenderBeLiquidated, current vul: price-manipulation                                                                                                                               
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "balanceOf": "Function to get the balance of a specific address"                                                                                                                                            │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_lenderCollateralLPShare": "Variable holding the calculated value/price of LP token"                                                                                                                       │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
         find_data_dependency          
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                    ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ balanceOf                │
│ arg[1]   │ _lenderCollateralLPShare │
└──────────┴──────────────────────────┘
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ {                                                                                                                                                                                                               │
│   "VariableA": {                                                                                                                                                                                                │
│     "_poolSavingsStrategy": "Variable holding the pool savings strategy address",                                                                                                                               │
│     "_lenderCollateralLPShare": "Variable holding the lender's collateral LP share",                                                                                                                            │
│     "_lenderCollateralTokens": "Variable holding the lender's collateral tokens"                                                                                                                                │
│   },                                                                                                                                                                                                            │
│   "VariableB": {                                                                                                                                                                                                │
│     "_amountReceived": "Variable holding the amount received after withdrawal"                                                                                                                                  │
│   }                                                                                                                                                                                                             │
│ }                                                                                                                                                                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
[12/08/24 19:28:42] ERROR    tasks: Static analysis failed: Invalid args                                                                                                                               tasks.py:357
                    ERROR    tasks: Current File: /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol, current function:   tasks.py:359
                             _updateLenderSharesDuringLiquidation, current vul: price-manipulation                                                                                                                 
                    ERROR    tasks: Traceback (most recent call last):                                                                                                                                 tasks.py:361
                               File "/home/owen/Documents/GitHub/GPTScan-Bigger-Model/src/tasks.py", line 310, in simple_cli                                                                                       
                                 raise Exception(                                                                                                                                                                  
                             Exception: The description of variable did not pass the validation                                                                                                                    
                                                                                                                                                                                                                   
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function liquidateForLender(                                                                                                                                                                                │
│         address _lender,                                                                                                                                                                                        │
│         bool _fromSavingsAccount,                                                                                                                                                                               │
│         bool _toSavingsAccount,                                                                                                                                                                                 │
│         bool _recieveLiquidityShare                                                                                                                                                                             │
│     ) external payable nonReentrant {                                                                                                                                                                           │
│         _canLenderBeLiquidated(_lender);                                                                                                                                                                        │
│                                                                                                                                                                                                                 │
│         address _poolSavingsStrategy = poolConstants.poolSavingsStrategy;                                                                                                                                       │
│         (uint256 _lenderCollateralLPShare, uint256 _lenderBalance) = _updateLenderSharesDuringLiquidation(_lender);                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _lenderCollateralTokens = _lenderCollateralLPShare;                                                                                                                                             │
│         _lenderCollateralTokens = IYield(_poolSavingsStrategy).getTokensForShares(_lenderCollateralLPShare, poolConstants.collateralAsset);                                                                     │
│                                                                                                                                                                                                                 │
│         _liquidateForLender(_fromSavingsAccount, _lender, _lenderCollateralTokens);                                                                                                                             │
│                                                                                                                                                                                                                 │
│         uint256 _amountReceived = _withdraw(                                                                                                                                                                    │
│             _toSavingsAccount,                                                                                                                                                                                  │
│             _recieveLiquidityShare,                                                                                                                                                                             │
│             poolConstants.collateralAsset,                                                                                                                                                                      │
│             _poolSavingsStrategy,                                                                                                                                                                               │
│             _lenderCollateralTokens                                                                                                                                                                             │
│         );                                                                                                                                                                                                      │
│         _burn(_lender, _lenderBalance);                                                                                                                                                                         │
│         delete lenders[_lender];                                                                                                                                                                                │
│         emit LenderLiquidated(msg.sender, _lender, _amountReceived);                                                                                                                                            │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `1`                                                                                                                                                                                                             │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
   order_first_b    
┏━━━━━━━━━━┳━━━━━━━┓
┃ Argument ┃ Value ┃
┡━━━━━━━━━━╇━━━━━━━┩
│ arg[0]   │ []    │
│ arg[1]   │ []    │
└──────────┴───────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `uint256 _interestPerSecond = getInterestPerSecond(_poolID);`.                                                                                   │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getInterestDueTillInstalmentDeadline(address _poolID) public view returns (uint256) {                                                                                                              │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _nextInstalmentDeadline = getNextInstalmentDeadline(_poolID);                                                                                                                                   │
│         uint256 _loanDurationCovered = repayVariables[_poolID].loanDurationCovered;                                                                                                                             │
│         uint256 _interestDueTillInstalmentDeadline = (                                                                                                                                                          │
│             _nextInstalmentDeadline.sub(repayConstants[_poolID].loanStartTime).sub(_loanDurationCovered)                                                                                                        │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestDueTillInstalmentDeadline;                                                                                                                                                              │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward is `uint256 _interestPerSecond = getInterestPerSecond(_poolID);`.                                                    │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                               order_first_b                                
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                         ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                            │
│ arg[1]   │ [uint256 _interestPerSecond = getInterestPerSecond(_poolID);] │
└──────────┴───────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');`.                                                                         │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function getInterestOverdue(address _poolID) public view returns (uint256) {                                                                                                                                │
│         require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');                                                                                                                                   │
│         uint256 _instalmentsCompleted = getInstalmentsCompleted(_poolID);                                                                                                                                       │
│         uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                             │
│         uint256 _interestOverdue = (                                                                                                                                                                            │
│             (                                                                                                                                                                                                   │
│                 (_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(                                                                                             │
│                     repayVariables[_poolID].loanDurationCovered                                                                                                                                                 │
│                 )                                                                                                                                                                                               │
│             )                                                                                                                                                                                                   │
│         ).mul(_interestPerSecond).div(10**30);                                                                                                                                                                  │
│         return _interestOverdue;                                                                                                                                                                                │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `(_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(repayVariables[_poolID].loanDurationCovered)`                                                               │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                                                         order_first_b                                                                          
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                                                                             ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [(_instalmentsCompleted.add(10**30)).mul(repayConstants[_poolID].repaymentInterval).div(10**30).sub(repayVariables[_poolID].loanDurationCovered)] │
│ arg[1]   │ [require(repayVariables[_poolID].isLoanExtensionActive, 'No overdue');]                                                                           │
└──────────┴───────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function _repayExtension(address _poolID) internal returns (uint256) {                                                                                                                                      │
│         if (repayVariables[_poolID].isLoanExtensionActive) {                                                                                                                                                    │
│             uint256 _interestOverdue = getInterestOverdue(_poolID);                                                                                                                                             │
│             repayVariables[_poolID].isLoanExtensionActive = false; // deactivate loan extension flag                                                                                                            │
│             repayVariables[_poolID].loanDurationCovered = (getInstalmentsCompleted(_poolID).add(10**30))                                                                                                        │
│                 .mul(repayConstants[_poolID].repaymentInterval)                                                                                                                                                 │
│                 .div(10**30);                                                                                                                                                                                   │
│             emit ExtensionRepaid(_poolID, _interestOverdue);                                                                                                                                                    │
│             return _interestOverdue;                                                                                                                                                                            │
│         } else {                                                                                                                                                                                                │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `repayVariables[_poolID].isLoanExtensionActive = false;`                                                                                                                                                        │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _repayExtension(address _poolID) internal returns (uint256) {                                                                                                                                      │
│         if (repayVariables[_poolID].isLoanExtensionActive) {                                                                                                                                                    │
│             uint256 _interestOverdue = getInterestOverdue(_poolID);                                                                                                                                             │
│             repayVariables[_poolID].isLoanExtensionActive = false; // deactivate loan extension flag                                                                                                            │
│             repayVariables[_poolID].loanDurationCovered = (getInstalmentsCompleted(_poolID).add(10**30))                                                                                                        │
│                 .mul(repayConstants[_poolID].repaymentInterval)                                                                                                                                                 │
│                 .div(10**30);                                                                                                                                                                                   │
│             emit ExtensionRepaid(_poolID, _interestOverdue);                                                                                                                                                    │
│             return _interestOverdue;                                                                                                                                                                            │
│         } else {                                                                                                                                                                                                │
│             return 0;                                                                                                                                                                                           │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `repayVariables[_poolID].isLoanExtensionActive = false;`                                                                                                                                                        │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                             order_first_b                             
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                    ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [repayVariables[_poolID].isLoanExtensionActive = false;] │
│ arg[1]   │ [repayVariables[_poolID].isLoanExtensionActive = false;] │
└──────────┴──────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function _repayInterest(                                                                                                                                                                                    │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         uint256 _interestLeft = getInterestLeft(_poolID);                                                                                                                                                       │
│         require((_amount < _interestLeft) != _isLastRepayment, 'Repayments::repay complete interest must be repaid along with principal');                                                                      │
│                                                                                                                                                                                                                 │
│         if (_amount < _interestLeft) {                                                                                                                                                                          │
│             uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                         │
│             uint256 _newDurationRepaid = _amount.mul(10**30).div(_interestPerSecond); // dividing exponents                                                                                                     │
│             repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);                                                                                  │
│             emit InterestRepaid(_poolID, _amount);                                                                                                                                                              │
│             return _amount;                                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             repayVariables[_poolID].loanDurationCovered = repayConstants[_poolID].loanDuration; // full interest repaid                                                                                         │
│             emit InterestRepaymentComplete(_poolID, _interestLeft);                                                                                                                                             │
│             return _interestLeft;                                                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to update/accrue interest/exchange rate is `repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);`.                            │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _repayInterest(                                                                                                                                                                                    │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         uint256 _interestLeft = getInterestLeft(_poolID);                                                                                                                                                       │
│         require((_amount < _interestLeft) != _isLastRepayment, 'Repayments::repay complete interest must be repaid along with principal');                                                                      │
│                                                                                                                                                                                                                 │
│         if (_amount < _interestLeft) {                                                                                                                                                                          │
│             uint256 _interestPerSecond = getInterestPerSecond(_poolID);                                                                                                                                         │
│             uint256 _newDurationRepaid = _amount.mul(10**30).div(_interestPerSecond); // dividing exponents                                                                                                     │
│             repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);                                                                                  │
│             emit InterestRepaid(_poolID, _amount);                                                                                                                                                              │
│             return _amount;                                                                                                                                                                                     │
│         } else {                                                                                                                                                                                                │
│             repayVariables[_poolID].loanDurationCovered = repayConstants[_poolID].loanDuration; // full interest repaid                                                                                         │
│             emit InterestRepaymentComplete(_poolID, _interestLeft);                                                                                                                                             │
│             return _interestLeft;                                                                                                                                                                               │
│         }                                                                                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);`                                                                                            │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                                           order_first_b                                                           
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                                                                ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ [repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);] │
│ arg[1]   │ [repayVariables[_poolID].loanDurationCovered = repayVariables[_poolID].loanDurationCovered.add(_newDurationRepaid);] │
└──────────┴──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to update/accrue interest/exchange rate? Answer only ZERO or ONE statement, cover the code with backquotes.                    │
│ Code:                                                                                                                                                                                                           │
│     function _repay(                                                                                                                                                                                            │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         IPool _pool = IPool(_poolID);                                                                                                                                                                           │
│         _amount = _amount * 10**30;                                                                                                                                                                             │
│         uint256 _loanStatus = _pool.getLoanStatus();                                                                                                                                                            │
│         require(_loanStatus == uint(LoanStatus.ACTIVE) , 'Repayments:repayInterest Pool should be active.');                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _initialAmount = _amount;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // pay off grace penality                                                                                                                                                                               │
│         uint256 _gracePenaltyDue = _repayGracePenalty(_poolID);                                                                                                                                                 │
│         _amount = _amount.sub(_gracePenaltyDue, 'doesnt cover grace penality');                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         // pay off the overdue                                                                                                                                                                                  │
│         uint256 _interestOverdue = _repayExtension(_poolID);                                                                                                                                                    │
│         _amount = _amount.sub(_interestOverdue, 'doesnt cover overdue interest');                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // pay interest                                                                                                                                                                                         │
│         uint256 _interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);                                                                                                                           │
│         _amount = _amount.sub(_interestRepaid);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _updateRepaidAmount(_poolID, _initialAmount.sub(_amount));                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ `_interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);`                                                                                                                                         │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭───────────────────────────────────────────────────────────────────────────────────────────────── Current Step ──────────────────────────────────────────────────────────────────────────────────────────────────╮
│ Knowledge: In the given code, which inside code statement is the first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward? Answer only ZERO or ONE statement, cover the code with │
│ backquotes.                                                                                                                                                                                                     │
│ Code:                                                                                                                                                                                                           │
│     function _repay(                                                                                                                                                                                            │
│         address _poolID,                                                                                                                                                                                        │
│         uint256 _amount,                                                                                                                                                                                        │
│         bool _isLastRepayment                                                                                                                                                                                   │
│     ) internal returns (uint256) {                                                                                                                                                                              │
│         IPool _pool = IPool(_poolID);                                                                                                                                                                           │
│         _amount = _amount * 10**30;                                                                                                                                                                             │
│         uint256 _loanStatus = _pool.getLoanStatus();                                                                                                                                                            │
│         require(_loanStatus == uint(LoanStatus.ACTIVE) , 'Repayments:repayInterest Pool should be active.');                                                                                                    │
│                                                                                                                                                                                                                 │
│         uint256 _initialAmount = _amount;                                                                                                                                                                       │
│                                                                                                                                                                                                                 │
│         // pay off grace penality                                                                                                                                                                               │
│         uint256 _gracePenaltyDue = _repayGracePenalty(_poolID);                                                                                                                                                 │
│         _amount = _amount.sub(_gracePenaltyDue, 'doesnt cover grace penality');                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         // pay off the overdue                                                                                                                                                                                  │
│         uint256 _interestOverdue = _repayExtension(_poolID);                                                                                                                                                    │
│         _amount = _amount.sub(_interestOverdue, 'doesnt cover overdue interest');                                                                                                                               │
│                                                                                                                                                                                                                 │
│         // pay interest                                                                                                                                                                                         │
│         uint256 _interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);                                                                                                                           │
│         _amount = _amount.sub(_interestRepaid);                                                                                                                                                                 │
│                                                                                                                                                                                                                 │
│         return _updateRepaidAmount(_poolID, _initialAmount.sub(_amount));                                                                                                                                       │
│     }                                                                                                                                                                                                           │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
╭─────────────────────────────────────────────────────────────────────────────────────────────────── Response ────────────────────────────────────────────────────────────────────────────────────────────────────╮
│ The first statement to calculate/assign/distribute the balance/share/stake/fee/loan/reward is `uint256 _amount = _amount * 10**30;`.                                                                            │
╰─────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────╯
                                    order_first_b                                     
┏━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Argument ┃ Value                                                                   ┃
┡━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ arg[0]   │ []                                                                      │
│ arg[1]   │ [_interestRepaid = _repayInterest(_poolID, _amount, _isLastRepayment);] │
└──────────┴─────────────────────────────────────────────────────────────────────────┘
[12/08/24 19:28:49] INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/CreditLine/CreditLine.sol!!!CreditLine!!!_depositCollater            
                             alFromSavingsAccount!!!price-manipulation                                                                                                                                             
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/CreditLine/CreditLine.sol!!!CreditLine!!!_withdrawBorrowA            
                             mount!!!price-manipulation                                                                                                                                                            
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol!!!Pool!!!liquidateForLender!!!price-manipul            
                             ation                                                                                                                                                                                 
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/CreditLine/CreditLine.sol!!!CreditLine!!!_repayFromSaving            
                             sAccount!!!price-manipulation                                                                                                                                                         
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/CreditLine/CreditLine.sol!!!CreditLine!!!_transferCollate            
                             ral!!!price-manipulation                                                                                                                                                              
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol!!!Pool!!!liquidateCancelPenalty!!!price-man            
                             ipulation                                                                                                                                                                             
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/CreditLine/CreditLine.sol!!!CreditLine!!!calculateTotalCo            
                             llateralTokens!!!price-manipulation                                                                                                                                                   
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol!!!Pool!!!liquidatePool!!!price-manipulation            
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol!!!Pool!!!calculateCollateralRatio!!!price-m            
                             anipulation                                                                                                                                                                           
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/Pool/Pool.sol!!!Pool!!!_withdrawAllCollateral!!!price-man            
                             ipulation                                                                                                                                                                             
                    INFO     utils: Remove the redundant result:                                                                                                                                        utils.py:65
                             /home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/yield/AaveYield.sol!!!AaveYield!!!getTokensForShares!!!/            
                             home/owen/Documents/GitHub/GPTScan-Bigger-Model/datasets/code-423n4-Web3Bugs-data/2021-12-sublime-main/contracts/SavingsAccount/SavingsAccount.sol!!!SavingsAccount!!!getT            
                             otalTokens!!!price-manipulation                                                                                                                                                       
                                                                                                   Scan Results                                                                                                    
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓
┃ Type                                ┃ Description                                            ┃ Affected Files                                         ┃ Analysis Report                                         ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩
│ Insecure LP Token Value Calculation │ Liquidity token value/price can be manipulated to      │ ┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓ │ ┏━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┓ │
│                                     │ cause flashloan attacks.                               │ ┃ File Path         ┃ Line Range ┃ Code              ┃ │ ┃ Secure   ┃          ┃          ┃          ┃         ┃ │
│                                     │                                                        │ ┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩ │ ┃ Code     ┃ Best     ┃ CVSS     ┃          ┃         ┃ │
│                                     │                                                        │ │ /home/owen/Docum… │ 256 - 265  │     function      │ │ ┃ Examples ┃ Practic… ┃ Score    ┃ Severity ┃ Recomm… ┃ │
│                                     │                                                        │ │                   │            │ getTokensForShar… │ │ ┡━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━┩ │
│                                     │                                                        │ │                   │            │ shares, address   │ │ │ To       │ To       │ 6.5      │ Medium   │ Ensure  │ │
│                                     │                                                        │ │                   │            │ asset) public     │ │ │ provide  │ mitigate │          │          │ proper  │ │
│                                     │                                                        │ │                   │            │ view override     │ │ │ a more   │ vulnera… │          │          │ input   │ │
│                                     │                                                        │ │                   │            │ returns (uint256  │ │ │ secure   │ in the   │          │          │ valida… │ │
│                                     │                                                        │ │                   │            │ amount) {         │ │ │ alterna… │ provided │          │          │ for the │ │
│                                     │                                                        │ │                   │            │                   │ │ │ for the  │ code,    │          │          │ 'share… │ │
│                                     │                                                        │ │                   │            │         if        │ │ │ vulnera… │ consider │          │          │ parame… │ │
│                                     │                                                        │ │                   │            │ (shares == 0)     │ │ │ code,    │ impleme… │          │          │ to      │ │
│                                     │                                                        │ │                   │            │ return 0;         │ │ │ you can  │ the      │          │          │ prevent │ │
│                                     │                                                        │ │                   │            │                   │ │ │ follow   │ followi… │          │          │ potent… │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ these    │ best     │          │          │ arithm… │ │
│                                     │                                                        │ │                   │            │ aToken =          │ │ │ steps:   │ practic… │          │          │ overfl… │ │
│                                     │                                                        │ │                   │            │ liquidityToken(a… │ │ │          │          │          │          │ or      │ │
│                                     │                                                        │ │                   │            │                   │ │ │ 1. Use   │ 1. Input │          │          │ underf… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ SafeMath │ Validat… │          │          │ issues. │ │
│                                     │                                                        │ │                   │            │                   │ │ │ library  │    -     │          │          │ Consid… │ │
│                                     │                                                        │ │                   │            │         (, , , ,  │ │ │ for      │ Validate │          │          │ valida… │ │
│                                     │                                                        │ │                   │            │ , , , uint256     │ │ │ arithme… │ the      │          │          │ the     │ │
│                                     │                                                        │ │                   │            │ liquidityIndex, , │ │ │ operati… │ input    │          │          │ 'share… │ │
│                                     │                                                        │ │                   │            │ ) =               │ │ │ to       │ paramet… │          │          │ input   │ │
│                                     │                                                        │ │                   │            │ IProtocolDataPro… │ │ │ prevent  │ `shares` │          │          │ against │ │
│                                     │                                                        │ │                   │            │                   │ │ │ overflo… │ and      │          │          │ possib… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ and      │ `asset`  │          │          │ negati… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ underfl… │ to       │          │          │ values, │ │
│                                     │                                                        │ │                   │            │         amount =  │ │ │ 2.       │ ensure   │          │          │ large   │ │
│                                     │                                                        │ │                   │            │ IScaledBalanceTo… │ │ │ Impleme… │ they are │          │          │ values, │ │
│                                     │                                                        │ │                   │            │                   │ │ │ proper   │ within   │          │          │ or      │ │
│                                     │                                                        │ │                   │            │             IERC… │ │ │ error    │ accepta… │          │          │ unexpe… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ handling │ ranges   │          │          │ data    │ │
│                                     │                                                        │ │                   │            │         );        │ │ │ to       │ and do   │          │          │ types.  │ │
│                                     │                                                        │ │                   │            │                   │ │ │ handle   │ not      │          │          │         │ │
│                                     │                                                        │ │                   │            │     }             │ │ │ edge     │ introdu… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ cases    │ any      │          │          │         │ │
│                                     │                                                        │ └───────────────────┴────────────┴───────────────────┘ │ │ and      │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │ unexpec… │ For      │          │          │         │ │
│                                     │                                                        │                                                        │ │ scenari… │ example, │          │          │         │ │
│                                     │                                                        │                                                        │ │ 3. Use   │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ interfa… │ `shares` │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ is a     │          │          │         │ │
│                                     │                                                        │                                                        │ │ abstrac… │ positive │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ integer  │          │          │         │ │
│                                     │                                                        │                                                        │ │ interact │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ with     │ `asset`  │          │          │         │ │
│                                     │                                                        │                                                        │ │ external │ is a     │          │          │         │ │
│                                     │                                                        │                                                        │ │ contrac… │ valid    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ address. │          │          │         │ │
│                                     │                                                        │                                                        │ │ Here's   │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ an       │ 2. Avoid │          │          │         │ │
│                                     │                                                        │                                                        │ │ updated  │ Division │          │          │         │ │
│                                     │                                                        │                                                        │ │ and more │ by Zero: │          │          │         │ │
│                                     │                                                        │                                                        │ │ secure   │    -     │          │          │         │ │
│                                     │                                                        │                                                        │ │ version  │ Check    │          │          │         │ │
│                                     │                                                        │                                                        │ │ of the   │ for      │          │          │         │ │
│                                     │                                                        │                                                        │ │ code     │ divide-… │          │          │         │ │
│                                     │                                                        │                                                        │ │ using    │ scenari… │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ especia… │          │          │         │ │
│                                     │                                                        │                                                        │ │ library: │ when     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ dealing  │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```soli… │ with     │          │          │         │ │
│                                     │                                                        │                                                        │ │ import   │ division │          │          │         │ │
│                                     │                                                        │                                                        │ │ "@openz… │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ contract │ that the │          │          │         │ │
│                                     │                                                        │                                                        │ │ YourCon… │ denomin… │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ are not  │          │          │         │ │
│                                     │                                                        │                                                        │ │     usi… │ zero     │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ before   │          │          │         │ │
│                                     │                                                        │                                                        │ │ for      │ perform… │          │          │         │ │
│                                     │                                                        │                                                        │ │ uint256; │ division │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │     fun… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ getToke… │ 3. Use   │          │          │         │ │
│                                     │                                                        │                                                        │ │ shares,  │ SafeMath │          │          │         │ │
│                                     │                                                        │                                                        │ │ address  │ Library: │          │          │         │ │
│                                     │                                                        │                                                        │ │ asset)   │    - Use │          │          │         │ │
│                                     │                                                        │                                                        │ │ public   │ a        │          │          │         │ │
│                                     │                                                        │                                                        │ │ view     │ SafeMath │          │          │         │ │
│                                     │                                                        │                                                        │ │ returns  │ library  │          │          │         │ │
│                                     │                                                        │                                                        │ │ (uint256 │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount)  │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ overflow │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ (shares  │ underfl… │          │          │         │ │
│                                     │                                                        │                                                        │ │ == 0) {  │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ when     │          │          │         │ │
│                                     │                                                        │                                                        │ │ 0;       │ perform… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ arithme… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ Replace  │          │          │         │ │
│                                     │                                                        │                                                        │ │ aToken = │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ liquidi… │ standard │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ arithme… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │ , , , ,  │ with     │          │          │         │ │
│                                     │                                                        │                                                        │ │ , ,      │ SafeMath │          │          │         │ │
│                                     │                                                        │                                                        │ │ uint256  │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ liquidi… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ , ) =    │ handle   │          │          │         │ │
│                                     │                                                        │                                                        │ │ IProtoc… │ large    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ numbers  │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ safely.  │          │          │         │ │
│                                     │                                                        │                                                        │ │ scaledB… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ 4.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ IScaled… │ Access   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ Control: │          │          │         │ │
│                                     │                                                        │                                                        │ │ aTokenB… │    -     │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ Ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ IERC20(… │ that     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ only     │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ authori… │          │          │         │ │
│                                     │                                                        │                                                        │ │ > 0,     │ users or │          │          │         │ │
│                                     │                                                        │                                                        │ │ "AToken  │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ balance  │ can call │          │          │         │ │
│                                     │                                                        │                                                        │ │ is       │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ zero");  │ `getTok… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ function │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ by       │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ scaledB… │ appropr… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ control  │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount;  │ mechani… │          │          │         │ │
│                                     │                                                        │                                                        │ │     }    │ such as  │          │          │         │ │
│                                     │                                                        │                                                        │ │ }        │ modifie… │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```      │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ permiss… │          │          │         │ │
│                                     │                                                        │                                                        │ │ In this  │ checks.  │          │          │         │ │
│                                     │                                                        │                                                        │ │ updated  │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ version: │ 5.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ -        │ Contract │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ Interac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ library  │    -     │          │          │         │ │
│                                     │                                                        │                                                        │ │ is used  │ Verify   │          │          │         │ │
│                                     │                                                        │                                                        │ │ for      │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ arithme… │ integri… │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │ prevent  │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ overflow │ external │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ underfl… │ (`liqui… │          │          │         │ │
│                                     │                                                        │                                                        │ │ issues.  │ `IProto… │          │          │         │ │
│                                     │                                                        │                                                        │ │ - The    │ `IScale… │          │          │         │ │
│                                     │                                                        │                                                        │ │ code     │ `IERC20… │          │          │         │ │
│                                     │                                                        │                                                        │ │ includes │ being    │          │          │         │ │
│                                     │                                                        │                                                        │ │ proper   │ called   │          │          │         │ │
│                                     │                                                        │                                                        │ │ error    │ within   │          │          │         │ │
│                                     │                                                        │                                                        │ │ handling │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ with a   │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ `requir… │ Ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ stateme… │ that     │          │          │         │ │
│                                     │                                                        │                                                        │ │ to check │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │ if the   │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ `aToken` │ are      │          │          │         │ │
│                                     │                                                        │                                                        │ │ balance  │ trusted  │          │          │         │ │
│                                     │                                                        │                                                        │ │ is       │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ greater  │ secure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ than     │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ zero     │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ before   │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ perform… │ attacks. │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ division │ 6. Error │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ Handlin… │          │          │         │ │
│                                     │                                                        │                                                        │ │ - Make   │    -     │          │          │         │ │
│                                     │                                                        │                                                        │ │ sure to  │ Impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ import   │ proper   │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ error    │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │ library  │ mechani… │          │          │         │ │
│                                     │                                                        │                                                        │ │ in your  │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ Solidity │ gracefu… │          │          │         │ │
│                                     │                                                        │                                                        │ │ contract │ handle   │          │          │         │ │
│                                     │                                                        │                                                        │ │ file.    │ excepti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ You can  │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ use      │ unexpec… │          │          │         │ │
│                                     │                                                        │                                                        │ │ OpenZep… │ behavio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ Use      │          │          │         │ │
│                                     │                                                        │                                                        │ │ library  │ require  │          │          │         │ │
│                                     │                                                        │                                                        │ │ or any   │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ other    │ revert   │          │          │         │ │
│                                     │                                                        │                                                        │ │ trusted  │ stateme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ library. │ validate │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ assumpt… │          │          │         │ │
│                                     │                                                        │                                                        │ │ By       │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ followi… │ revert   │          │          │         │ │
│                                     │                                                        │                                                        │ │ these    │ transac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ practic… │ if       │          │          │         │ │
│                                     │                                                        │                                                        │ │ you can  │ conditi… │          │          │         │ │
│                                     │                                                        │                                                        │ │ improve  │ are not  │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ met.     │          │          │         │ │
│                                     │                                                        │                                                        │ │ security │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ of your  │ 7. Code  │          │          │         │ │
│                                     │                                                        │                                                        │ │ smart    │ Readabi… │          │          │         │ │
│                                     │                                                        │                                                        │ │ contract │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ code and │ Documen… │          │          │         │ │
│                                     │                                                        │                                                        │ │ reduce   │    -     │          │          │         │ │
│                                     │                                                        │                                                        │ │ the risk │ Improve  │          │          │         │ │
│                                     │                                                        │                                                        │ │ of       │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │ vulnera… │ readabi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ by using │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ meaning… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ variable │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ names    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ adding   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ comments │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ explain  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ purpose  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of each  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ section  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of code. │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Document │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ behavio… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ input    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ paramet… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ return   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ values,  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and any  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ risks    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ associa… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ with its │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ executi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ By       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ followi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ best     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ you can  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ reliabi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ while    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ mitigat… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ └──────────┴──────────┴──────────┴──────────┴─────────┘ │
├─────────────────────────────────────┼────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────┤
│ Insecure LP Token Value Calculation │ Liquidity token value/price can be manipulated to      │ ┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓ │ ┏━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┓ │
│                                     │ cause flashloan attacks.                               │ ┃ File Path         ┃ Line Range ┃ Code              ┃ │ ┃ Secure   ┃          ┃          ┃          ┃         ┃ │
│                                     │                                                        │ ┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩ │ ┃ Code     ┃ Best     ┃ CVSS     ┃          ┃         ┃ │
│                                     │                                                        │ │ /home/owen/Docum… │ 290 - 304  │     function      │ │ ┃ Examples ┃ Practic… ┃ Score    ┃ Severity ┃ Recomm… ┃ │
│                                     │                                                        │ │                   │            │ _depositERC20(ad… │ │ ┡━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━┩ │
│                                     │                                                        │ │                   │            │ asset, uint256    │ │ │ To       │ To       │ 8.8      │ High     │ To      │ │
│                                     │                                                        │ │                   │            │ amount) internal  │ │ │ improve  │ mitigate │          │          │ address │ │
│                                     │                                                        │ │                   │            │ returns (address  │ │ │ the      │ vulnera… │          │          │ this    │ │
│                                     │                                                        │ │                   │            │ aToken, uint256   │ │ │ security │ in the   │          │          │ vulner… │ │
│                                     │                                                        │ │                   │            │ sharesReceived) { │ │ │ of the   │ provided │          │          │ ensure  │ │
│                                     │                                                        │ │                   │            │                   │ │ │ code     │ code,    │          │          │ proper  │ │
│                                     │                                                        │ │                   │            │         aToken =  │ │ │ provide… │ consider │          │          │ access  │ │
│                                     │                                                        │ │                   │            │ liquidityToken(a… │ │ │ you can  │ impleme… │          │          │ contro… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ make the │ the      │          │          │ are     │ │
│                                     │                                                        │ │                   │            │         uint256   │ │ │ followi… │ followi… │          │          │ implem… │ │
│                                     │                                                        │ │                   │            │ aTokensBefore =   │ │ │ changes: │ best     │          │          │ throug… │ │
│                                     │                                                        │ │                   │            │ IERC20(aToken).b… │ │ │          │ practic… │          │          │ the     │ │
│                                     │                                                        │ │                   │            │                   │ │ │ 1. Use   │          │          │          │ code,   │ │
│                                     │                                                        │ │                   │            │                   │ │ │ the      │ 1.       │          │          │ includ… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ latest   │ **Input  │          │          │ author… │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ Aave     │ Validat… │          │          │ checks  │ │
│                                     │                                                        │ │                   │            │ lendingPool =     │ │ │ protocol │ Ensure   │          │          │ to      │ │
│                                     │                                                        │ │                   │            │ ILendingPoolAddr… │ │ │ interfa… │ that     │          │          │ restri… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ and      │ proper   │          │          │ unauth… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ contrac… │ input    │          │          │ access  │ │
│                                     │                                                        │ │                   │            │                   │ │ │ for      │ validat… │          │          │ to      │ │
│                                     │                                                        │ │                   │            │         //approve │ │ │ interac… │ is in    │          │          │ functi… │ │
│                                     │                                                        │ │                   │            │ collateral to     │ │ │ with     │ place to │          │          │ and     │ │
│                                     │                                                        │ │                   │            │ vault             │ │ │ Aave:    │ prevent  │          │          │ data.   │ │
│                                     │                                                        │ │                   │            │                   │ │ │          │ unexpec… │          │          │ Additi… │ │
│                                     │                                                        │ │                   │            │         IERC20(a… │ │ │ ```soli… │ or       │          │          │ consid… │ │
│                                     │                                                        │ │                   │            │ 0);               │ │ │ import { │ malicio… │          │          │ input   │ │
│                                     │                                                        │ │                   │            │                   │ │ │ IERC20 } │ inputs.  │          │          │ valida… │ │
│                                     │                                                        │ │                   │            │         IERC20(a… │ │ │ from     │ Validate │          │          │ to      │ │
│                                     │                                                        │ │                   │            │ amount);          │ │ │ "@openz… │ the      │          │          │ prevent │ │
│                                     │                                                        │ │                   │            │                   │ │ │ import { │ `asset`  │          │          │ potent… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ ILendin… │ address  │          │          │ inject… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ } from   │ and      │          │          │ attacks │ │
│                                     │                                                        │ │                   │            │         //lock    │ │ │ "@aave/… │ `amount` │          │          │ and     │ │
│                                     │                                                        │ │                   │            │ collateral in     │ │ │ import { │ to       │          │          │ thorou… │ │
│                                     │                                                        │ │                   │            │ vault             │ │ │ ILendin… │ ensure   │          │          │ test    │ │
│                                     │                                                        │ │                   │            │                   │ │ │ } from   │ they are │          │          │ the     │ │
│                                     │                                                        │ │                   │            │         AaveLend… │ │ │ "@aave/… │ valid    │          │          │ code    │ │
│                                     │                                                        │ │                   │            │ amount,           │ │ │          │ and      │          │          │ for     │ │
│                                     │                                                        │ │                   │            │ address(this),    │ │ │ function │ within   │          │          │ securi… │ │
│                                     │                                                        │ │                   │            │ referralCode);    │ │ │ _deposi… │ appropr… │          │          │ vulner… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ asset,   │ ranges.  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ uint256  │          │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ amount)  │ 2.       │          │          │         │ │
│                                     │                                                        │ │                   │            │         sharesRe… │ │ │ internal │ **Access │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ returns  │ Control… │          │          │         │ │
│                                     │                                                        │ │                   │            │ IERC20(aToken).b… │ │ │ (address │ Impleme… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ aToken,  │ access   │          │          │         │ │
│                                     │                                                        │ │                   │            │     }             │ │ │ uint256  │ control  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ sharesR… │ mechani… │          │          │         │ │
│                                     │                                                        │ │ /home/owen/Docum… │ 115 - 130  │     function      │ │ │ {        │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │ lockTokens(       │ │ │     ILe… │ restrict │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ lending… │ who can  │          │          │         │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ =        │ call the │          │          │         │ │
│                                     │                                                        │ │                   │            │ user,             │ │ │ ILendin… │ `_depos… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │          │ functio… │          │          │         │ │
│                                     │                                                        │ │                   │            │         address   │ │ │     aTo… │ Consider │          │          │         │ │
│                                     │                                                        │ │                   │            │ asset,            │ │ │ =        │ adding   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ lending… │ modifie… │          │          │         │ │
│                                     │                                                        │ │                   │            │         uint256   │ │ │          │ or       │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount            │ │ │     //   │ permiss… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ Approve  │ checks   │          │          │         │ │
│                                     │                                                        │ │                   │            │     ) external    │ │ │ lending  │ to limit │          │          │         │ │
│                                     │                                                        │ │                   │            │ payable override  │ │ │ pool to  │ access   │          │          │         │ │
│                                     │                                                        │ │                   │            │ onlySavingsAccou… │ │ │ spend    │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │ nonReentrant      │ │ │ the      │ authori… │          │          │         │ │
│                                     │                                                        │ │                   │            │ returns (uint256  │ │ │ ERC20    │ entities │          │          │         │ │
│                                     │                                                        │ │                   │            │ sharesReceived) { │ │ │ asset    │ only.    │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │     IER… │          │          │          │         │ │
│                                     │                                                        │ │                   │            │         require(… │ │ │ amount); │ 3. **Use │          │          │         │ │
│                                     │                                                        │ │                   │            │ != 0, 'Invest:    │ │ │          │ Safe     │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount');         │ │ │     len… │ Math**:  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ amount,  │ Replace  │          │          │         │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ address… │ arithme… │          │          │         │ │
│                                     │                                                        │ │                   │            │ investedTo =      │ │ │ referra… │ operati… │          │          │         │ │
│                                     │                                                        │ │                   │            │ liquidityToken;   │ │ │          │ with     │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │     sha… │ SafeMath │          │          │         │ │
│                                     │                                                        │ │                   │            │         if (asset │ │ │ =        │ functio… │          │          │         │ │
│                                     │                                                        │ │                   │            │ == address(0)) {  │ │ │ IERC20(… │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ }        │ prevent  │          │          │         │ │
│                                     │                                                        │ │                   │            │             requ… │ │ │ ```      │ overflow │          │          │         │ │
│                                     │                                                        │ │                   │            │ == amount,        │ │ │          │ and      │          │          │         │ │
│                                     │                                                        │ │                   │            │ 'Invest: ETH      │ │ │ 2.       │ underfl… │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount');         │ │ │ Ensure   │ vulnera… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ that the │ Use      │          │          │         │ │
│                                     │                                                        │ │                   │            │             shar… │ │ │ `lendin… │ SafeMath │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ is set   │ librari… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _depositETH(inve… │ │ │ to the   │ for      │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount);          │ │ │ correct  │ operati… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ Aave     │ like     │          │          │         │ │
│                                     │                                                        │ │                   │            │         } else {  │ │ │ Lending… │ subtrac… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ contract │ in the   │          │          │         │ │
│                                     │                                                        │ │                   │            │             IERC… │ │ │ address. │ code.    │          │          │         │ │
│                                     │                                                        │ │                   │            │ address(this),    │ │ │          │          │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount);          │ │ │ 3. Use   │ 4.       │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ the      │ **Appro… │          │          │         │ │
│                                     │                                                        │ │                   │            │             shar… │ │ │ appropr… │ Exact    │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ OpenZep… │ Amount*… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _depositERC20(as… │ │ │ interfa… │ Instead  │          │          │         │ │
│                                     │                                                        │ │                   │            │ investedTo,       │ │ │ for      │ of       │          │          │         │ │
│                                     │                                                        │ │                   │            │ amount);          │ │ │ ERC20    │ calling  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ tokens   │ `approv… │          │          │         │ │
│                                     │                                                        │ │                   │            │         }         │ │ │ to       │ twice    │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ interact │ with     │          │          │         │ │
│                                     │                                                        │ │                   │            │         emit      │ │ │ with the │ amounts  │          │          │         │ │
│                                     │                                                        │ │                   │            │ LockedTokens(use… │ │ │ assets.  │ 0 and    │          │          │         │ │
│                                     │                                                        │ │                   │            │ investedTo,       │ │ │          │ `amount… │          │          │         │ │
│                                     │                                                        │ │                   │            │ sharesReceived);  │ │ │ 4. The   │ consider │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ code     │ using    │          │          │         │ │
│                                     │                                                        │ │                   │            │     }             │ │ │ above    │ the      │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ assumes  │ ERC20    │          │          │         │ │
│                                     │                                                        │ └───────────────────┴────────────┴───────────────────┘ │ │ that you │ `permit` │          │          │         │ │
│                                     │                                                        │                                                        │ │ have     │ function │          │          │         │ │
│                                     │                                                        │                                                        │ │ imported │ if       │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ support… │          │          │         │ │
│                                     │                                                        │                                                        │ │ necessa… │ by the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ Aave and │ token or │          │          │         │ │
│                                     │                                                        │                                                        │ │ OpenZep… │ approve  │          │          │         │ │
│                                     │                                                        │                                                        │ │ contrac… │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ Make     │ exact    │          │          │         │ │
│                                     │                                                        │                                                        │ │ sure to  │ required │          │          │         │ │
│                                     │                                                        │                                                        │ │ install  │ amount   │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ for the  │          │          │         │ │
│                                     │                                                        │                                                        │ │ required │ lending  │          │          │         │ │
│                                     │                                                        │                                                        │ │ depende… │ pool to  │          │          │         │ │
│                                     │                                                        │                                                        │ │ through  │ mitigate │          │          │         │ │
│                                     │                                                        │                                                        │ │ npm or   │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ yarn.    │ attack   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vectors. │          │          │         │ │
│                                     │                                                        │                                                        │ │ By       │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ followi… │ 5.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ these    │ **Error  │          │          │         │ │
│                                     │                                                        │                                                        │ │ recomme… │ Handlin… │          │          │         │ │
│                                     │                                                        │                                                        │ │ you can  │ Impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ enhance  │ robust   │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ error    │          │          │         │ │
│                                     │                                                        │                                                        │ │ security │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │ of your  │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ code     │ revert   │          │          │         │ │
│                                     │                                                        │                                                        │ │ when     │ conditi… │          │          │         │ │
│                                     │                                                        │                                                        │ │ interac… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ with the │ provide  │          │          │         │ │
│                                     │                                                        │                                                        │ │ Aave     │ clear    │          │          │         │ │
│                                     │                                                        │                                                        │ │ protoco… │ feedback │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ when     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ transac… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ fail.    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ require  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ stateme… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ validate │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ conditi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ revert   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ with     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ appropr… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ error    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ message… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 6.       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ **Avoid  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Hardcod… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Values*… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Avoid    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ hardcod… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ values   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ like     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `referr… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ in the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ passing  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ such     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ values   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ as       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ paramet… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ storing  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ them     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ securely │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ them as  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ needed.  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 7.       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ **Secur… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Audits*… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ conduct… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ audits   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ by       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ external │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ experts  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ identify │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ address  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ in the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code.    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 8.       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ **Latest │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Solidity │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Version… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Use the  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ latest   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ stable   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ version  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Solidity │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ leverage │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ latest   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ features │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ enhance… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ By       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ followi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ best     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ you can  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code and │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ reduce   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the risk │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │ Here is  │ Here are │ 6.5      │ Medium   │ Ensure  │ │
│                                     │                                                        │                                                        │ │ a more   │ some     │          │          │ proper  │ │
│                                     │                                                        │                                                        │ │ secure   │ best     │          │          │ input   │ │
│                                     │                                                        │                                                        │ │ alterna… │ practic… │          │          │ valida… │ │
│                                     │                                                        │                                                        │ │ for the  │ to       │          │          │ and     │ │
│                                     │                                                        │                                                        │ │ vulnera… │ mitigate │          │          │ handli… │ │
│                                     │                                                        │                                                        │ │ code:    │ vulnera… │          │          │ to      │ │
│                                     │                                                        │                                                        │ │          │ in the   │          │          │ prevent │ │
│                                     │                                                        │                                                        │ │ ```soli… │ provided │          │          │ unauth… │ │
│                                     │                                                        │                                                        │ │ function │ code:    │          │          │ access  │ │
│                                     │                                                        │                                                        │ │ lockTok… │          │          │          │ or      │ │
│                                     │                                                        │                                                        │ │        … │ 1.       │          │          │ asset   │ │
│                                     │                                                        │                                                        │ │ user,    │ **Input  │          │          │ manipu… │ │
│                                     │                                                        │                                                        │ │        … │ Validat… │          │          │ Implem… │ │
│                                     │                                                        │                                                        │ │ asset,   │ Ensure   │          │          │ additi… │ │
│                                     │                                                        │                                                        │ │        … │ that all │          │          │ securi… │ │
│                                     │                                                        │                                                        │ │ amount   │ input    │          │          │ measur… │ │
│                                     │                                                        │                                                        │ │     )    │ paramet… │          │          │ such as │ │
│                                     │                                                        │                                                        │ │ external │ are      │          │          │ input   │ │
│                                     │                                                        │                                                        │ │ override │ properly │          │          │ saniti… │ │
│                                     │                                                        │                                                        │ │ onlySav… │ validat… │          │          │ and     │ │
│                                     │                                                        │                                                        │ │ nonReen… │ to       │          │          │ access  │ │
│                                     │                                                        │                                                        │ │ returns  │ prevent  │          │          │ control │ │
│                                     │                                                        │                                                        │ │ (uint256 │ unexpec… │          │          │ checks. │ │
│                                     │                                                        │                                                        │ │ sharesR… │ behavior │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ attacks. │          │          │         │ │
│                                     │                                                        │                                                        │ │ != 0,    │ In this  │          │          │         │ │
│                                     │                                                        │                                                        │ │ 'Invest: │ code,    │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount'… │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `amount` │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ paramet… │          │          │         │ │
│                                     │                                                        │                                                        │ │ investe… │ is       │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ checked  │          │          │         │ │
│                                     │                                                        │                                                        │ │ liquidi… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ it is    │          │          │         │ │
│                                     │                                                        │                                                        │ │ (asset   │ not      │          │          │         │ │
│                                     │                                                        │                                                        │ │ ==       │ zero,    │          │          │         │ │
│                                     │                                                        │                                                        │ │ address… │ which is │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ a good   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │ ==       │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount,  │ adding   │          │          │         │ │
│                                     │                                                        │                                                        │ │ 'Invest: │ further  │          │          │         │ │
│                                     │                                                        │                                                        │ │ ETH      │ validat… │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount'… │ checks   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ based on │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ _deposi… │ require… │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount); │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ else {   │          │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ 2.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ address… │ **Access │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount); │ Control… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ The      │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount), │ `onlySa… │          │          │         │ │
│                                     │                                                        │                                                        │ │ "Invest: │ modifier │          │          │         │ │
│                                     │                                                        │                                                        │ │ approval │ is used  │          │          │         │ │
│                                     │                                                        │                                                        │ │ failed"… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ restrict │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ _deposi… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ investe… │ authori… │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount); │ account… │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ Make     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ sure     │          │          │         │ │
│                                     │                                                        │                                                        │ │        … │ this     │          │          │         │ │
│                                     │                                                        │                                                        │ │ LockedT… │ modifier │          │          │         │ │
│                                     │                                                        │                                                        │ │ investe… │ is       │          │          │         │ │
│                                     │                                                        │                                                        │ │ sharesR… │ properly │          │          │         │ │
│                                     │                                                        │                                                        │ │     }    │ impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```      │ and used │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ through… │          │          │         │ │
│                                     │                                                        │                                                        │ │ In this  │ your     │          │          │         │ │
│                                     │                                                        │                                                        │ │ secure   │ codebase │          │          │         │ │
│                                     │                                                        │                                                        │ │ alterna… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ we have  │ enforce  │          │          │         │ │
│                                     │                                                        │                                                        │ │ added an │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ additio… │ control. │          │          │         │ │
│                                     │                                                        │                                                        │ │ `requir… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ stateme… │ 3.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ **Reent… │          │          │         │ │
│                                     │                                                        │                                                        │ │ ensure   │ Guard**: │          │          │         │ │
│                                     │                                                        │                                                        │ │ that the │ The      │          │          │         │ │
│                                     │                                                        │                                                        │ │ user has │ `nonRee… │          │          │         │ │
│                                     │                                                        │                                                        │ │ approved │ modifier │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ is used  │          │          │         │ │
│                                     │                                                        │                                                        │ │ contract │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ to spend │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ reentra… │          │          │         │ │
│                                     │                                                        │                                                        │ │ ERC20    │ attacks. │          │          │         │ │
│                                     │                                                        │                                                        │ │ tokens   │ Ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ on their │ that     │          │          │         │ │
│                                     │                                                        │                                                        │ │ behalf   │ this     │          │          │         │ │
│                                     │                                                        │                                                        │ │ before   │ modifier │          │          │         │ │
│                                     │                                                        │                                                        │ │ transfe… │ effecti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ prevents │          │          │         │ │
│                                     │                                                        │                                                        │ │ tokens.  │ reentra… │          │          │         │ │
│                                     │                                                        │                                                        │ │ This     │ by using │          │          │         │ │
│                                     │                                                        │                                                        │ │ prevents │ proper   │          │          │         │ │
│                                     │                                                        │                                                        │ │ potenti… │ state    │          │          │         │ │
│                                     │                                                        │                                                        │ │ vulnera… │ managem… │          │          │         │ │
│                                     │                                                        │                                                        │ │ where    │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ function │          │          │         │ │
│                                     │                                                        │                                                        │ │ contract │ orderin… │          │          │         │ │
│                                     │                                                        │                                                        │ │ could    │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ lock     │ 4.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ tokens   │ **Handl… │          │          │         │ │
│                                     │                                                        │                                                        │ │ without  │ Ether    │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ user's   │ Tokens*… │          │          │         │ │
│                                     │                                                        │                                                        │ │ consent. │ When     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Ether    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ tokens,  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ make     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ sure to  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ use safe │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ secure   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ methods. │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ For      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Ether,   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ safe     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ transfer │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ For      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ ERC20    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ tokens,  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ utilize  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ safe     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ transfer │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ methods  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ like     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `safeTr… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ from     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ OpenZep… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ ERC20    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 5.       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ **Event  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Logging… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Emitting │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ events   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ like     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `Locked… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ can be   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ helpful  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ for      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ tracking │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ debuggi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ purpose… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ that the │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ event    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ data is  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ accurate │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ provides │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ relevant │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ informa… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ for      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ monitor… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ analysi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 6.       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ **Code   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Review   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Testing… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Conduct  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ thorough │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ reviews  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ testing  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ identify │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ address  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ any      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ or bugs. │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ tools    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ audits   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of your  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code.    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ By       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ followi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ best     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ continu… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ improvi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of your  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ codebas… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ you can  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ mitigate │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ overall  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of your  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ smart    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ └──────────┴──────────┴──────────┴──────────┴─────────┘ │
├─────────────────────────────────────┼────────────────────────────────────────────────────────┼────────────────────────────────────────────────────────┼─────────────────────────────────────────────────────────┤
│ Insecure LP Token Value Calculation │ Liquidity token value/price can be manipulated to      │ ┏━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓ │ ┏━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━┓ │
│                                     │ cause flashloan attacks.                               │ ┃ File Path         ┃ Line Range ┃ Code              ┃ │ ┃ Secure   ┃          ┃          ┃          ┃         ┃ │
│                                     │                                                        │ ┡━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩ │ ┃ Code     ┃ Best     ┃ CVSS     ┃          ┃         ┃ │
│                                     │                                                        │ │ /home/owen/Docum… │ 178 - 183  │     function      │ │ ┃ Examples ┃ Practic… ┃ Score    ┃ Severity ┃ Recomm… ┃ │
│                                     │                                                        │ │                   │            │ getTokensForShar… │ │ ┡━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━┩ │
│                                     │                                                        │ │                   │            │ shares, address   │ │ │ To       │ Here are │ 6.5      │ Medium   │ Ensure  │ │
│                                     │                                                        │ │                   │            │ asset) public     │ │ │ improve  │ some     │          │          │ input   │ │
│                                     │                                                        │ │                   │            │ override returns  │ │ │ the      │ best     │          │          │ valida… │ │
│                                     │                                                        │ │                   │            │ (uint256 amount)  │ │ │ security │ practic… │          │          │ for     │ │
│                                     │                                                        │ │                   │            │ {                 │ │ │ of the   │ to       │          │          │ 'share… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ provided │ mitigate │          │          │ parame… │ │
│                                     │                                                        │ │                   │            │         //balanc… │ │ │ code,    │ vulnera… │          │          │ to      │ │
│                                     │                                                        │ │                   │            │ returns           │ │ │ you can  │ in the   │          │          │ prevent │ │
│                                     │                                                        │ │                   │            │ underlying        │ │ │ impleme… │ provided │          │          │ potent… │ │
│                                     │                                                        │ │                   │            │ balance for total │ │ │ the      │ code:    │          │          │ divisi… │ │
│                                     │                                                        │ │                   │            │ shares            │ │ │ followi… │          │          │          │ by zero │ │
│                                     │                                                        │ │                   │            │                   │ │ │ changes: │ 1. Input │          │          │ and     │ │
│                                     │                                                        │ │                   │            │         if        │ │ │          │ Validat… │          │          │ other   │ │
│                                     │                                                        │ │                   │            │ (shares == 0)     │ │ │ 1. Use   │ Ensure   │          │          │ input-… │ │
│                                     │                                                        │ │                   │            │ return 0;         │ │ │ SafeMath │ proper   │          │          │ vulner… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ Library: │ input    │          │          │ Implem… │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ Replace  │ validat… │          │          │ proper  │ │
│                                     │                                                        │ │                   │            │ cToken =          │ │ │ arithme… │ to       │          │          │ error   │ │
│                                     │                                                        │ │                   │            │ liquidityToken;   │ │ │ operati… │ prevent  │          │          │ handli… │ │
│                                     │                                                        │ │                   │            │                   │ │ │ with     │ unexpec… │          │          │ to      │ │
│                                     │                                                        │ │                   │            │         amount =  │ │ │ SafeMath │ inputs   │          │          │ handle  │ │
│                                     │                                                        │ │                   │            │ ICToken(cToken).… │ │ │ library  │ that     │          │          │ edge    │ │
│                                     │                                                        │ │                   │            │                   │ │ │ functio… │ could    │          │          │ cases   │ │
│                                     │                                                        │ │                   │            │     }             │ │ │ to       │ lead to  │          │          │ where   │ │
│                                     │                                                        │ │                   │            │                   │ │ │ prevent  │ vulnera… │          │          │ 'share… │ │
│                                     │                                                        │ │ /home/owen/Docum… │ 864 - 890  │     function      │ │ │ overflow │ For      │          │          │ could   │ │
│                                     │                                                        │ │                   │            │ liquidateForLend… │ │ │ and      │ example, │          │          │ be      │ │
│                                     │                                                        │ │                   │            │                   │ │ │ underfl… │ you can  │          │          │ manipu… │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ vulnera… │ add a    │          │          │ malici… │ │
│                                     │                                                        │ │                   │            │ _lender,          │ │ │          │ check to │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ 2. Check │ verify   │          │          │         │ │
│                                     │                                                        │ │                   │            │         bool      │ │ │ for      │ that the │          │          │         │ │
│                                     │                                                        │ │                   │            │ _fromSavingsAcco… │ │ │ Division │ `asset`  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ by Zero: │ paramet… │          │          │         │ │
│                                     │                                                        │ │                   │            │         bool      │ │ │ Add a    │ is a     │          │          │         │ │
│                                     │                                                        │ │                   │            │ _toSavingsAccoun… │ │ │ check to │ valid    │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ prevent  │ asset    │          │          │         │ │
│                                     │                                                        │ │                   │            │         bool      │ │ │ division │ address  │          │          │         │ │
│                                     │                                                        │ │                   │            │ _recieveLiquidit… │ │ │ by zero  │ and that │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ error.   │ the      │          │          │         │ │
│                                     │                                                        │ │                   │            │     ) external    │ │ │          │ `shares` │          │          │         │ │
│                                     │                                                        │ │                   │            │ payable           │ │ │ 3.       │ paramet… │          │          │         │ │
│                                     │                                                        │ │                   │            │ nonReentrant {    │ │ │ Validate │ is not   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ Input:   │ negativ… │          │          │         │ │
│                                     │                                                        │ │                   │            │         _canLend… │ │ │ Ensure   │          │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ that     │ 2. Error │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ input    │ Handlin… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ values   │ Impleme… │          │          │         │ │
│                                     │                                                        │ │                   │            │         address   │ │ │ are      │ robust   │          │          │         │ │
│                                     │                                                        │ │                   │            │ _poolSavingsStra… │ │ │ within   │ error    │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ accepta… │ handling │          │          │         │ │
│                                     │                                                        │ │                   │            │ poolConstants.po… │ │ │ ranges   │ mechani… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ to       │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │         (uint256  │ │ │ prevent  │ handle   │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderCollatera… │ │ │ unexpec… │ excepti… │          │          │         │ │
│                                     │                                                        │ │                   │            │ uint256           │ │ │ behavio… │ cases    │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderBalance) = │ │ │          │ effecti… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _updateLenderSha… │ │ │ Here is  │ Consider │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ the      │ throwing │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ updated  │ an error │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ code     │ or       │          │          │         │ │
│                                     │                                                        │ │                   │            │         uint256   │ │ │ with     │ reverti… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderCollatera… │ │ │ these    │ the      │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ security │ transac… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderCollatera… │ │ │ improve… │ if any   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │          │ unexpec… │          │          │         │ │
│                                     │                                                        │ │                   │            │         _lenderC… │ │ │ ```soli… │ conditi… │          │          │         │ │
│                                     │                                                        │ │                   │            │ =                 │ │ │ import   │ occur.   │          │          │         │ │
│                                     │                                                        │ │                   │            │ IYield(_poolSavi… │ │ │ "@openz… │          │          │          │         │ │
│                                     │                                                        │ │                   │            │ poolConstants.co… │ │ │          │ 3.       │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ function │ External │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ getToke… │ Calls    │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ shares,  │ Safety:  │          │          │         │ │
│                                     │                                                        │ │                   │            │         _liquida… │ │ │ address  │ Be       │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lender,          │ │ │ asset)   │ cautious │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderCollatera… │ │ │ public   │ when     │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ override │ making   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ returns  │ external │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ (uint256 │ calls,   │          │          │         │ │
│                                     │                                                        │ │                   │            │         uint256   │ │ │ amount)  │ especia… │          │          │         │ │
│                                     │                                                        │ │                   │            │ _amountReceived = │ │ │ {        │ when     │          │          │         │ │
│                                     │                                                        │ │                   │            │ _withdraw(        │ │ │     req… │ interac… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ > 0,     │ with     │          │          │         │ │
│                                     │                                                        │ │                   │            │             _toS… │ │ │ "Shares  │ external │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ must be  │ contrac… │          │          │         │ │
│                                     │                                                        │ │                   │            │             _rec… │ │ │ greater  │ Ensure   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ than     │ that     │          │          │         │ │
│                                     │                                                        │ │                   │            │             pool… │ │ │ 0");     │ external │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │          │ calls    │          │          │         │ │
│                                     │                                                        │ │                   │            │             _poo… │ │ │     add… │ cannot   │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ cToken = │ be       │          │          │         │ │
│                                     │                                                        │ │                   │            │             _len… │ │ │ liquidi… │ manipul… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │     uin… │ by       │          │          │         │ │
│                                     │                                                        │ │                   │            │         );        │ │ │ underly… │ malicio… │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ =        │ actors   │          │          │         │ │
│                                     │                                                        │ │                   │            │         _burn(_l… │ │ │ ICToken… │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lenderBalance);  │ │ │     uin… │ exploit  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ cTokenB… │ the      │          │          │         │ │
│                                     │                                                        │ │                   │            │         delete    │ │ │ =        │ contrac… │          │          │         │ │
│                                     │                                                        │ │                   │            │ lenders[_lender]; │ │ │ IERC20(… │ Consider │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │          │ using    │          │          │         │ │
│                                     │                                                        │ │                   │            │         emit      │ │ │     req… │ checks-… │          │          │         │ │
│                                     │                                                        │ │                   │            │ LenderLiquidated… │ │ │ > 0,     │ pattern  │          │          │         │ │
│                                     │                                                        │ │                   │            │ _lender,          │ │ │ "cToken  │ to       │          │          │         │ │
│                                     │                                                        │ │                   │            │ _amountReceived); │ │ │ balance  │ prevent  │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ must be  │ reentra… │          │          │         │ │
│                                     │                                                        │ │                   │            │     }             │ │ │ greater  │ attacks. │          │          │         │ │
│                                     │                                                        │ │                   │            │                   │ │ │ than     │          │          │          │         │ │
│                                     │                                                        │ └───────────────────┴────────────┴───────────────────┘ │ │ 0");     │ 4. Safe  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Math     │          │          │         │ │
│                                     │                                                        │                                                        │ │     amo… │ Operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ Use safe │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMat… │ math     │          │          │         │ │
│                                     │                                                        │                                                        │ │ shares)  │ librari… │          │          │         │ │
│                                     │                                                        │                                                        │ │ /        │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ cTokenB… │ perform  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ arithme… │          │          │         │ │
│                                     │                                                        │                                                        │ │     ret… │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │ amount;  │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ }        │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```      │ overflo… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ underfl… │          │          │         │ │
│                                     │                                                        │                                                        │ │ By       │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ incorpo… │ other    │          │          │         │ │
│                                     │                                                        │                                                        │ │ these    │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │ changes, │ related  │          │          │         │ │
│                                     │                                                        │                                                        │ │ you can  │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ enhance  │ integer  │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ arithme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ security │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ of the   │ 5.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ function │ Access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ `getTok… │ Control: │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ Impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ mitigate │ proper   │          │          │         │ │
│                                     │                                                        │                                                        │ │ common   │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ vulnera… │ control  │          │          │         │ │
│                                     │                                                        │                                                        │ │ related  │ mechani… │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ arithme… │ restrict │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ certain  │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ input    │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ validat… │ authori… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ users    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ only.    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ modifie… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ like     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `onlyOw… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ `onlyAd… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ control  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ critical │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 6. Code  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Auditin… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Conduct  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ regular  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ audits   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ identify │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and fix  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ in the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ smart    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ contract │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code.    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ automat… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ tools or │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ services │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ for      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ assessm… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ By       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ followi… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ best     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ you can  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ improve  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ robustn… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ smart    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ contract │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ code and │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ mitigate │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │ To       │ To       │ 5.3      │ Medium   │ Ensure  │ │
│                                     │                                                        │                                                        │ │ improve  │ mitigate │          │          │ proper  │ │
│                                     │                                                        │                                                        │ │ the      │ vulnera… │          │          │ input   │ │
│                                     │                                                        │                                                        │ │ security │ in the   │          │          │ valida… │ │
│                                     │                                                        │                                                        │ │ of the   │ provided │          │          │ to      │ │
│                                     │                                                        │                                                        │ │ provided │ code,    │          │          │ prevent │ │
│                                     │                                                        │                                                        │ │ code,    │ consider │          │          │ potent… │ │
│                                     │                                                        │                                                        │ │ you can  │ impleme… │          │          │ vulner… │ │
│                                     │                                                        │                                                        │ │ follow   │ the      │          │          │ such as │ │
│                                     │                                                        │                                                        │ │ these    │ followi… │          │          │ input   │ │
│                                     │                                                        │                                                        │ │ secure   │ best     │          │          │ data    │ │
│                                     │                                                        │                                                        │ │ coding   │ practic… │          │          │ manipu… │ │
│                                     │                                                        │                                                        │ │ practic… │          │          │          │ or      │ │
│                                     │                                                        │                                                        │ │          │ 1.       │          │          │ inject… │ │
│                                     │                                                        │                                                        │ │ 1.       │ **Input  │          │          │ attack… │ │
│                                     │                                                        │                                                        │ │ **Access │ Validat… │          │          │ Use     │ │
│                                     │                                                        │                                                        │ │ Control… │     -    │          │          │ secure  │ │
│                                     │                                                        │                                                        │ │ Impleme… │ Ensure   │          │          │ coding  │ │
│                                     │                                                        │                                                        │ │ access   │ that all │          │          │ practi… │ │
│                                     │                                                        │                                                        │ │ control  │ input    │          │          │ input   │ │
│                                     │                                                        │                                                        │ │ mechani… │ paramet… │          │          │ saniti… │ │
│                                     │                                                        │                                                        │ │ to       │ are      │          │          │ and     │ │
│                                     │                                                        │                                                        │ │ ensure   │ properly │          │          │ valida… │ │
│                                     │                                                        │                                                        │ │ that     │ validat… │          │          │ techni… │ │
│                                     │                                                        │                                                        │ │ only     │ to       │          │          │ to      │ │
│                                     │                                                        │                                                        │ │ authori… │ prevent  │          │          │ mitiga… │ │
│                                     │                                                        │                                                        │ │ users    │ unexpec… │          │          │ risks.  │ │
│                                     │                                                        │                                                        │ │ can call │ behavior │          │          │         │ │
│                                     │                                                        │                                                        │ │ the      │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ `liquid… │ malicio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ functio… │ input.   │          │          │         │ │
│                                     │                                                        │                                                        │ │ This can │ Validate │          │          │         │ │
│                                     │                                                        │                                                        │ │ be       │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ achieved │ address… │          │          │         │ │
│                                     │                                                        │                                                        │ │ using    │ boolean  │          │          │         │ │
│                                     │                                                        │                                                        │ │ modifie… │ values,  │          │          │         │ │
│                                     │                                                        │                                                        │ │ like     │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ `onlyOw… │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ or       │ they are │          │          │         │ │
│                                     │                                                        │                                                        │ │ `onlyAd… │ within   │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ expected │          │          │         │ │
│                                     │                                                        │                                                        │ │ 2.       │ ranges.  │          │          │         │ │
│                                     │                                                        │                                                        │ │ **Input  │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ Validat… │ 2.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ Validate │ **Access │          │          │         │ │
│                                     │                                                        │                                                        │ │ all      │ Control… │          │          │         │ │
│                                     │                                                        │                                                        │ │ input    │     -    │          │          │         │ │
│                                     │                                                        │                                                        │ │ paramet… │ Impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ appropr… │          │          │         │ │
│                                     │                                                        │                                                        │ │ prevent  │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ unexpec… │ control  │          │          │         │ │
│                                     │                                                        │                                                        │ │ behavio… │ mechani… │          │          │         │ │
│                                     │                                                        │                                                        │ │ Ensure   │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ that the │ restrict │          │          │         │ │
│                                     │                                                        │                                                        │ │ input    │ who can  │          │          │         │ │
│                                     │                                                        │                                                        │ │ values   │ call the │          │          │         │ │
│                                     │                                                        │                                                        │ │ are      │ `liquid… │          │          │         │ │
│                                     │                                                        │                                                        │ │ within   │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ accepta… │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │ ranges   │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ modifie… │          │          │         │ │
│                                     │                                                        │                                                        │ │ conform  │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ to the   │ access   │          │          │         │ │
│                                     │                                                        │                                                        │ │ expected │ control  │          │          │         │ │
│                                     │                                                        │                                                        │ │ data     │ checks   │          │          │         │ │
│                                     │                                                        │                                                        │ │ types.   │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ 3. **Use │ only     │          │          │         │ │
│                                     │                                                        │                                                        │ │ of       │ authori… │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMat… │ users    │          │          │         │ │
│                                     │                                                        │                                                        │ │ Utilize  │ can      │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ trigger  │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ liquida… │          │          │         │ │
│                                     │                                                        │                                                        │ │ prevent  │ process. │          │          │         │ │
│                                     │                                                        │                                                        │ │ integer  │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ overflow │ 3.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ **Error  │          │          │         │ │
│                                     │                                                        │                                                        │ │ underfl… │ Handlin… │          │          │         │ │
│                                     │                                                        │                                                        │ │ vulnera… │     -    │          │          │         │ │
│                                     │                                                        │                                                        │ │ when     │ Impleme… │          │          │         │ │
│                                     │                                                        │                                                        │ │ dealing  │ robust   │          │          │         │ │
│                                     │                                                        │                                                        │ │ with     │ error    │          │          │         │ │
│                                     │                                                        │                                                        │ │ arithme… │ handling │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ mechani… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ to catch │          │          │         │ │
│                                     │                                                        │                                                        │ │ 4.       │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ **Separ… │ handle   │          │          │         │ │
│                                     │                                                        │                                                        │ │ of       │ excepti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ Concern… │ that may │          │          │         │ │
│                                     │                                                        │                                                        │ │ Consider │ occur    │          │          │         │ │
│                                     │                                                        │                                                        │ │ breaking │ during   │          │          │         │ │
│                                     │                                                        │                                                        │ │ down the │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ function │ executi… │          │          │         │ │
│                                     │                                                        │                                                        │ │ into     │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ smaller, │ functio… │          │          │         │ │
│                                     │                                                        │                                                        │ │ more     │ Use      │          │          │         │ │
│                                     │                                                        │                                                        │ │ managea… │ try-cat… │          │          │         │ │
│                                     │                                                        │                                                        │ │ functio… │ blocks   │          │          │         │ │
│                                     │                                                        │                                                        │ │ with     │ where    │          │          │         │ │
│                                     │                                                        │                                                        │ │ specific │ necessa… │          │          │         │ │
│                                     │                                                        │                                                        │ │ purpose… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ This can │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ help in  │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ improvi… │ entire   │          │          │         │ │
│                                     │                                                        │                                                        │ │ readabi… │ contract │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ from     │          │          │         │ │
│                                     │                                                        │                                                        │ │ maintai… │ becoming │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ unusable │          │          │         │ │
│                                     │                                                        │                                                        │ │ 5.       │ due to a │          │          │         │ │
│                                     │                                                        │                                                        │ │ **Event  │ single   │          │          │         │ │
│                                     │                                                        │                                                        │ │ Emittin… │ error.   │          │          │         │ │
│                                     │                                                        │                                                        │ │ Emit     │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ events   │ 4. **Gas │          │          │         │ │
│                                     │                                                        │                                                        │ │ after    │ Limitat… │          │          │         │ │
│                                     │                                                        │                                                        │ │ critical │     - Be │          │          │         │ │
│                                     │                                                        │                                                        │ │ state    │ mindful  │          │          │         │ │
│                                     │                                                        │                                                        │ │ changes  │ of gas   │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ limitat… │          │          │         │ │
│                                     │                                                        │                                                        │ │ provide  │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ transpa… │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │ gas      │          │          │         │ │
│                                     │                                                        │                                                        │ │ allow    │ costs    │          │          │         │ │
│                                     │                                                        │                                                        │ │ external │ associa… │          │          │         │ │
│                                     │                                                        │                                                        │ │ systems  │ with the │          │          │         │ │
│                                     │                                                        │                                                        │ │ to react │ function │          │          │         │ │
│                                     │                                                        │                                                        │ │ to these │ executi… │          │          │         │ │
│                                     │                                                        │                                                        │ │ events.  │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ optimiz… │          │          │         │ │
│                                     │                                                        │                                                        │ │ Here is  │ gas      │          │          │         │ │
│                                     │                                                        │                                                        │ │ an       │ usage by │          │          │         │ │
│                                     │                                                        │                                                        │ │ example  │ minimiz… │          │          │         │ │
│                                     │                                                        │                                                        │ │ of how   │ unneces… │          │          │         │ │
│                                     │                                                        │                                                        │ │ you can  │ computa… │          │          │         │ │
│                                     │                                                        │                                                        │ │ refactor │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ the code │ storage  │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │ operati… │          │          │         │ │
│                                     │                                                        │                                                        │ │ incorpo… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ these    │ 5.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ security │ **Secure │          │          │         │ │
│                                     │                                                        │                                                        │ │ measure… │ External │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ Calls**: │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```soli… │     -    │          │          │         │ │
│                                     │                                                        │                                                        │ │ //       │ When     │          │          │         │ │
│                                     │                                                        │                                                        │ │ Define   │ making   │          │          │         │ │
│                                     │                                                        │                                                        │ │ access   │ external │          │          │         │ │
│                                     │                                                        │                                                        │ │ control  │ calls to │          │          │         │ │
│                                     │                                                        │                                                        │ │ modifier │ other    │          │          │         │ │
│                                     │                                                        │                                                        │ │ modifier │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │ onlyOwn… │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ that you │          │          │         │ │
│                                     │                                                        │                                                        │ │     req… │ handle   │          │          │         │ │
│                                     │                                                        │                                                        │ │ ==       │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ owner,   │ return   │          │          │         │ │
│                                     │                                                        │                                                        │ │ "Only    │ values   │          │          │         │ │
│                                     │                                                        │                                                        │ │ owner    │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ can call │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ this     │ reentra… │          │          │         │ │
│                                     │                                                        │                                                        │ │ functio… │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │     _;   │ properl… │          │          │         │ │
│                                     │                                                        │                                                        │ │ }        │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │ // Input │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ validat… │ "Checks… │          │          │         │ │
│                                     │                                                        │                                                        │ │ require… │ pattern  │          │          │         │ │
│                                     │                                                        │                                                        │ │ !=       │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ address… │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ "Invalid │ reentra… │          │          │         │ │
│                                     │                                                        │                                                        │ │ lender   │ attacks. │          │          │         │ │
│                                     │                                                        │                                                        │ │ address… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ 6.       │          │          │         │ │
│                                     │                                                        │                                                        │ │ // Use   │ **Avoid  │          │          │         │ │
│                                     │                                                        │                                                        │ │ SafeMath │ State    │          │          │         │ │
│                                     │                                                        │                                                        │ │ for      │ Changes  │          │          │         │ │
│                                     │                                                        │                                                        │ │ arithme… │ Before   │          │          │         │ │
│                                     │                                                        │                                                        │ │ operati… │ External │          │          │         │ │
│                                     │                                                        │                                                        │ │ uint256  │ Calls**: │          │          │         │ │
│                                     │                                                        │                                                        │ │ newAmou… │     -    │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ Make     │          │          │         │ │
│                                     │                                                        │                                                        │ │ amountR… │ sure     │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ that     │          │          │         │ │
│                                     │                                                        │                                                        │ │ //       │ state    │          │          │         │ │
│                                     │                                                        │                                                        │ │ Separate │ changes  │          │          │         │ │
│                                     │                                                        │                                                        │ │ concerns │ are done │          │          │         │ │
│                                     │                                                        │                                                        │ │ into     │ after    │          │          │         │ │
│                                     │                                                        │                                                        │ │ smaller  │ any      │          │          │         │ │
│                                     │                                                        │                                                        │ │ functio… │ external │          │          │         │ │
│                                     │                                                        │                                                        │ │ function │ calls to │          │          │         │ │
│                                     │                                                        │                                                        │ │ updateL… │ prevent  │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender) │ potenti… │          │          │         │ │
│                                     │                                                        │                                                        │ │ internal │ reentra… │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ attacks  │          │          │         │ │
│                                     │                                                        │                                                        │ │     //   │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ Update   │ ensure   │          │          │         │ │
│                                     │                                                        │                                                        │ │ lender   │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ shares   │ integri… │          │          │         │ │
│                                     │                                                        │                                                        │ │ logic    │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ }        │ contrac… │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ state.   │          │          │         │ │
│                                     │                                                        │                                                        │ │ function │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ liquida… │ 7.       │          │          │         │ │
│                                     │                                                        │                                                        │ │     add… │ **Code   │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender, │ Review   │          │          │         │ │
│                                     │                                                        │                                                        │ │     bool │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ _fromSa… │ Testing… │          │          │         │ │
│                                     │                                                        │                                                        │ │     bool │     -    │          │          │         │ │
│                                     │                                                        │                                                        │ │ _toSavi… │ Conduct  │          │          │         │ │
│                                     │                                                        │                                                        │ │     bool │ thorough │          │          │         │ │
│                                     │                                                        │                                                        │ │ _receiv… │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │ )        │ reviews  │          │          │         │ │
│                                     │                                                        │                                                        │ │ external │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ payable  │ testing  │          │          │         │ │
│                                     │                                                        │                                                        │ │ onlyOwn… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ {        │ identify │          │          │         │ │
│                                     │                                                        │                                                        │ │     _ca… │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ address  │          │          │         │ │
│                                     │                                                        │                                                        │ │     upd… │ any      │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │     add… │ or       │          │          │         │ │
│                                     │                                                        │                                                        │ │ _poolSa… │ issues   │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ in the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ poolCon… │ code     │          │          │         │ │
│                                     │                                                        │                                                        │ │     uin… │ before   │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender… │ deploym… │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ Consider │          │          │         │ │
│                                     │                                                        │                                                        │ │ IYield(… │ using    │          │          │         │ │
│                                     │                                                        │                                                        │ │ poolCon… │ tools    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ like     │          │          │         │ │
│                                     │                                                        │                                                        │ │     _li… │ static   │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender, │ analysis │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender… │ tools    │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │     uin… │ automat… │          │          │         │ │
│                                     │                                                        │                                                        │ │ _amount… │ testing  │          │          │         │ │
│                                     │                                                        │                                                        │ │ =        │ framewo… │          │          │         │ │
│                                     │                                                        │                                                        │ │ _withdr… │ to       │          │          │         │ │
│                                     │                                                        │                                                        │ │ _receiv… │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │ poolCon… │ securit… │          │          │         │ │
│                                     │                                                        │                                                        │ │ _poolSa… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender… │ By       │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ followi… │          │          │         │ │
│                                     │                                                        │                                                        │ │     _bu… │ these    │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender… │ best     │          │          │         │ │
│                                     │                                                        │                                                        │ │     del… │ practic… │          │          │         │ │
│                                     │                                                        │                                                        │ │ lenders… │ you can  │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ help     │          │          │         │ │
│                                     │                                                        │                                                        │ │     emit │ mitigate │          │          │         │ │
│                                     │                                                        │                                                        │ │ LenderL… │ vulnera… │          │          │         │ │
│                                     │                                                        │                                                        │ │ _lender, │ and      │          │          │         │ │
│                                     │                                                        │                                                        │ │ _amount… │ enhance  │          │          │         │ │
│                                     │                                                        │                                                        │ │ }        │ the      │          │          │         │ │
│                                     │                                                        │                                                        │ │ ```      │ security │          │          │         │ │
│                                     │                                                        │                                                        │ │          │ of the   │          │          │         │ │
│                                     │                                                        │                                                        │ │ Please   │ `liquid… │          │          │         │ │
│                                     │                                                        │                                                        │ │ customi… │ function │          │          │         │ │
│                                     │                                                        │                                                        │ │ the code │ and the  │          │          │         │ │
│                                     │                                                        │                                                        │ │ accordi… │ overall  │          │          │         │ │
│                                     │                                                        │                                                        │ │ to your  │ smart    │          │          │         │ │
│                                     │                                                        │                                                        │ │ specific │ contract │          │          │         │ │
│                                     │                                                        │                                                        │ │ require… │ system.  │          │          │         │ │
│                                     │                                                        │                                                        │ │ and      │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ archite… │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ to       │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ ensure   │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ maximum  │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ security │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ for your │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ smart    │          │          │          │         │ │
│                                     │                                                        │                                                        │ │ contrac… │          │          │          │         │ │
│                                     │                                                        │                                                        │ └──────────┴──────────┴──────────┴──────────┴─────────┘ │
└─────────────────────────────────────┴────────────────────────────────────────────────────────┴────────────────────────────────────────────────────────┴─────────────────────────────────────────────────────────┘
                  Summary                  
┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓
┃ Key                  ┃ Value            ┃
┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩
│ Files                │ 44               │
│ Contracts            │ 51               │
│ Functions            │ 182              │
│ Lines of Code        │ 7693             │
│ Used Time            │ 235.364910364151 │
│ Estimated Cost (USD) │ 0.1828015        │
└──────────────────────┴──────────────────┘
